<!DOCTYPE html>
<html>
<head><title>Coverage</title>
<script>
    headings = [];

    onload = function () {
        headings = document.querySelectorAll('h2');
    };

    onscroll = function (e) {
        var heading = find(window.scrollY);
        if (!heading) return;
        var links = document.querySelectorAll('#menu a')
                , link;

        for (var i = 0, len = links.length; i < len; ++i) {
            link = links[i];
            link.className = link.getAttribute('href') == '#' + heading.id
                    ? 'active'
                    : '';
        }
    };

    function find (y) {
        var i = headings.length
                , heading;

        while (i--) {
            heading = headings[i];
            if (y > heading.offsetTop) {
                return heading;
            }
        }
    }
</script>
<style>
body {
    font: 14px/1.6 "Helvetica Neue", Helvetica, Arial, sans-serif;
    margin: 0;
    color: #2C2C2C;
    border-top: 2px solid #ddd;
}

#coverage {
    padding: 60px;
}

h1 a {
    color: inherit;
    font-weight: inherit;
}

h1 a:hover {
    text-decoration: none;
}

.onload h1 {
    opacity: 1;
}

h2 {
    width: 80%;
    margin-top: 80px;
    margin-bottom: 0;
    font-weight: 100;
    letter-spacing: 1px;
    border-bottom: 1px solid #eee;
}

a {
    color: #8A6343;
    font-weight: bold;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

ul {
    margin-top: 20px;
    padding: 0 15px;
    width: 100%;
}

ul li {
    float: left;
    width: 40%;
    margin-top: 5px;
    margin-right: 60px;
    list-style: none;
    border-bottom: 1px solid #eee;
    padding: 5px 0;
    font-size: 12px;
}

ul::after {
    content: '.';
    height: 0;
    display: block;
    visibility: hidden;
    clear: both;
}

code {
    font: 12px monaco, monospace;
}

pre {
    margin: 30px;
    padding: 30px;
    border: 1px solid #eee;
    border-bottom-color: #ddd;
    -webkit-border-radius: 2px;
    -moz-border-radius: 2px;
    -webkit-box-shadow: inset 0 0 10px #eee;
    -moz-box-shadow: inset 0 0 10px #eee;
    overflow-x: auto;
}

img {
    margin: 30px;
    padding: 1px;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
    -moz-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
    max-width: 100%;
}

footer {
    background: #eee;
    width: 100%;
    padding: 50px 0;
    text-align: right;
    border-top: 1px solid #ddd;
}

footer span {
    display: block;
    margin-right: 30px;
    color: #888;
    font-size: 12px;
}

#menu {
    position: fixed;
    font-size: 12px;
    overflow-y: auto;
    top: 0;
    right: 0;
    margin: 0;
    height: 100%;
    padding: 15px 0;
    text-align: right;
    border-left: 1px solid #eee;
    -moz-box-shadow: 0 0 2px #888, inset 5px 0 20px rgba(0, 0, 0, .5), inset 5px 0 3px rgba(0, 0, 0, .3);
    -webkit-box-shadow: 0 0 2px #888, inset 5px 0 20px rgba(0, 0, 0, .5), inset 5px 0 3px rgba(0, 0, 0, .3);
    -webkit-font-smoothing: antialiased;
    background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGYAAABmCAMAAAAOARRQAAABelBMVEUjJSU6OzshIyM5OjoqKy02NjgsLS01NTYjJCUzNTUgISMlJSc0NTUvMDA6PDwlJyg1NjYoKis2NjYrLS02ODkpKyw0NDYrLC04ODovLzA4Ojo0NDUtLy86OjwjIyU4OTosLS82ODgtLS8hIyQvMTEnKCooKSsrKy0qLCwkJSUnKCkrLCwpKiwwMjIxMzMqLC0tLS0pKissLC00NTYwMDIwMTQpKysoKSovMDEtLzA2OTkxMzUrKywvLy8qKyszNTY5OzsqKiw6OjswMDExNDUoKiozNDUvMDIyNDY1Njg2Njk5OTozMzU0NjY4ODkiIyUiIyQ4OTkuMDEmKCowMjQwMTErLS4qKywwMTMhIiMpKiopKy0tLjAkJScxNDQvLzExNDYyNDQmKCk5OTslJig5OjskJSYxMzQrLS8gISIwMTIoKCk1NTUlJSUnJygwMDA4ODgiIiMhISI8PDw6Ojo5OTkpKSojIyQ7OzsyMjIpKSssLCw6Ozw1NjlrfLakAAAg2UlEQVR42jR6i3ea6rYvPgANIAhVXh8WvkQlioUiFlFcBtAmoiRNdzxqu9p0J7vrdK29zuPeex77nnvO/35n1r1ndHRktI0jTOacv/l7lCBK5UqVpOha/YxmWK7BC4TQFKVXrbYsnimqxuuMVlOQ0XltWjUdCwRJ1M+tC1KudOs9q6+da2adUewG0SC0SwELfHtgDds93VEuydEbl3QMWeNoYkR7b/0x1ZRobGI3mLwzAhePqTAwhg6aogjNsGy7/jwQ4rkdqe7CWLxF8k9LfMVFyRS7VJqtkrW8Vt/bkR8FZJao16ipknbC3Yw2lM7laO6HBEOadEZ2tpf65c4v8e3u7FyU6qbiNNyCuzXZ6pawgnwgmrpTT/Q7w2EZmiIJ0dzWDI7mhQ80IfRnMu2kzA5r5r1pIFoia+/d93HRYp1GV8TbrkWoU/+jdI0Ff6yGwTjT1Hn8J+8m1rKpGiYPuNiHnMtNMIv+zpsk84MYTNW1/+DpwXLvckdOCMYowVNPREe0QlM8xRHXXFhcNDzupwsSmb5pH+0t0RP2Qk+QtI7F1Qm6JRC6ZPBtPq/dq/kH+jxtCljn9TIpW6rQIgmSVyj6lPICIw4N/taka41PFUInth0je9+jO6Kt1G4/a7V2LEgG02B0pHVuCZrgltSKMuIl5SyufUv9mYuQi+mFgzbBEtFo2g+Dh4sSTrLNu8JPh00sQydpb00tqXBvqRN7Q7kqzcnIxCGnvZt/WmJacoOEO6Dcn8Qre03pOCSQxbMOXUuDNx9SxuLz4W1I18gvjViQ67zV0rxdWL8Te/TQkuo8STS41DR48W7L6YP2uWIqiUV8rd6Gbf/rnegKZeG8TpAM6afhGze9JAOxbLjsnUXEbrZ9vLYd7MT32cPF5mKKxmjy7huaoD9n62GOxni3iIJwv0IzZAZjdZkUtolCNLVfYZNaquFjGszVVf+J0vrz4CawoKdHnOzb0NMH7CDBOybfYNJ4rfeMyFNjkFYVTzMFs87rnPGXLUOeNKRVc0LnU7/UIgelzsy3CMuth0YfvnY0wsD3vODUL3eJcKqHQpm8yM3XZQWJxO6Un9iYloyyLpOwN2obHy6W6gbpcb44XmyC+mg+itAcaprGcrwZCqMj/GmtKn0zPvpTz/Cv1dw21XwP3cRupg3H3MF/S71eTKj1YrdwKdc2Mw0fRmb2sFf8lW3aU6JbIZSEPqvXvjM7G/aApyXlXeqKfMq0g/Su3rUGJPSPrtGElgknrZM3xUXqsAP6zMCNVn5u8aJnSNpJv2uru7t2jfRziW2+GuhqfldUNbPk71olwo+46ePUo1U3WKk/e5YK07F/wGRgcpODmQnIlVeHCWBE4puBi2jq28UKpqiN1/4UOrGz59TNYrrQHtd+11sG40BGD+pXdelNqGOg4NXe8W4eacJV/NS9/2Umtym6WQqveqR9xdCMElpxnbkalM4Vf9uaEcWZaKdyibEIjWKxJZPN95niCL3GiaXyssIrHxoLkqkzLCXULN46/f2h3tQJgyip+Tk9EAjJ9aJshq7t8X45aowSKspMSvPf7r9R8yxNptIaHS5ozuEm6luPDApugyNP8OaqiQ4BjaequXA54SLC83eHIY2r+CZp4409Xqw8Aa2oI7XkCrQi+in0w5AqF/kLNrcUz+qkl/lAobY1jSnx5OJNhyXIz3qfNFlXc0TKaglNwdWkWYt9QQ1Kr6W8zue21iNrdJk+N5oCr2O9nEtWKC7IS5J/zdDEYrmnAYfg6agCy+qcgz7ZofeDc4PbUWSvkshWuAc7OjiUyLkj+RAtdlwXJcjxdpkTTHDhK8lBCi8+JtvDVL1W6elmOM++YS0LuSlaP1oUvAeiW3cFnvTr8EbTz1tsSMYdGeZe40sRWu5uAfj7q+ZoKv2FNQ0p5XY1lmlcigHZqTPpabufEVrNuNPi165w3uCVQJHyJqmSJ7ZHnguqwtCmwViIJijj04ba2JNYtB+yORf5gg1/9t9iw4vUpeqiunSAbf+IBdj/b+iG2qrHvuNP0Vd/+ThVZT/lrvHYjjgDbbyxaqgHNM2uhxa1GW3UedZYhMMwM4mQhltouK+IV4NdbIQNM+8Yv311RZk9kT4tiYR4LkyFcuPpdcjuhUuFqBAWRZa11lcZ3gEBlXywsNhrt+plISZP5DlsV9l4EgY6J3yZPTUcMrgaWAT3oI79eSbGEbcJpr6BD8kyDiVt+G0/hXosQN4NFXKlfWIfsIs0BHODVok1/IGnKFHJYIquh8Xo+2+bkQNTGgWmN/fZ0Y33LSj6lr1GyV7mWIKg7ZTRZPGuhF/zjRNcQ1UPtSYgnWQxSs0yrVhwNDcdGMNSNe2JT3WuzbAM3HykyAajS3Uphf6STKEqxLas9EnmnhA/lyj9Uj+JoY7SVgVmGLl46Rm2u98sbkap2lzAdKBG4r6LgulQOSSjQv1GWdQ0jtDUK/mAaqM1Uqjpu4k3Rvfvxv7YTxLSK+wN3E5jVIzmF23uZ7hiH/sVP49D7tvoKp4S8b1LuvRlivVB/algbhcFITYVXvDpLzpDfplR2uD5V4XJFxpjmIpLc9Y5sB2TpBRix7Bme6GZIq+06v3XzNeTcA4obQIKxrnT4C2JpOqD92dbmSX8MGazly5EsZVMvSU1f4RZwyu8iQXbVdeLlZrjuTT1jrY1uk5c7iZ7RsvhhluqAkq4JpVQAg7RJFtSu+xgJ8Pv6O1j5DkLxT8mkbfyRW5DrQmG7hiDIjCgBsADbjuof6YHLGeV6a5Q1Smx9joUXPpdaaDx97A/Wq00oJkdR7ZYuQRfS533JtxO1erduqWOYIt3wh0wpbLuCNIYkwxbswbikCUu2CDCS+Q+7rgVtfRcm+SOcdKPRlZ/rE7wNVUEE39KTS5uvUKN1PUnkloPkyzhyGQ8qkouEjJ3H/VXdqG6asSRiw3ecMlBvDDt8dDhBHXMwZ2Cajzjr7/76T+IavqPYvz6r7//E/3X3+N//h/0QozbjPgPiir69P/8X3/9F/yv8b/827/++98WItPu5/Hvwd8YPf5bp/2/lX/T/+Of/0MJ/lYTa+L/Ef+d9vN/3/2T6P/+jyTzu/evf6U7vxN7B6pJkRtAF6jUr8I+P8RsP/ptGhfqFk+pQ/DgAy6NJtRYJdXmp4gK7WLqLKJ+MaKhGjOojvL+SnIWrkpy0SLHDe4QuyNzaEA15mLMCcmE8Em+4HdOihW4/ZWuppJEmzeAwcDtv7MuLc9y2V5atvxXNe3S4DUMt5/Qy2LM9kSYKiVWBuKlfp4nxTntpuW03JbIlkiRvBXmT23g1I2OYe6IizUHPIq6zm6mbfsbteKmi/sg9J+ocQBMctGFO7iljo8TPN+z3jxw4do+ZwfqoR9dkNTKHyM305GpTkfhcHexVkPVGEbUOjuo9f0UMPHBFlGEx0SLvJvVRKTwW7PSew5oPme+E42+frJa9cGt2njS3dK5kIif2eYbhuSEQXEqMVfUjhGIuin0G0/W5ezJyJQy3SpMLai4M0JUWb5u1k9tny5bd1pPwYBpQuDCXZl62xg4CdVEAtflXHs6JKmP/pH6mOl796Lgopj0o8d5kKh00hxG3OSdEE/QBo9Hgr8JJqAeLDwJohG5j/DGh61Rc/+tf22/8kEnxHNCEjo0ElvvGfESZkqmz2BDcKV1H1buSkhkdg7p1IMGs2s17nYjpblrWuE2K9WEO/hcRp5e9oOF/QBmOaDtgil+oaU6szPrdwW65fOB0KUTsVUn7LFU7J8e6cxJIl9+FHw5MQMzuQJ+4oxMH3iW/5GK+hWuG0T+gTLs+fAjdtUd58TmIUq04EeyRCYCjkldow234aIgR5bqwrtZosZ+6YEqAmDqatJ9lWasz4IquKALPtd92hGI3Z2BdzzZue+REl1Om4DIWD+RrtUTOJLI+S0jHowXXdAxsGLSd40zYNuEUlOGhrwL6c7tcOtUOvpJCP7QBQS19H+GvZn05ewjlVLz+IGKoC9TyfQjLMBNmXCuqqtTdOSukZW48B0HqgSTCBrBnlFvF4CG2Su7yFzqmJFURK3UmTT3ru050r0ptUpMilYnBJWfl2Bv6kPlUuE1kxxpdzui9AubsR2N2boVSu81OulAwBqoSr1LZ0LLYOomyZHmjqnXlP72s8LnDouEJjtodBvdHaG1jMySYO7crWd90MpCRyCG14vb5IE7Arupw/y/RcCm/Tm3zK6zYj8PYNaGldiUfkB/LHWcmf2lVM+mwyU27a0qq2tscrQ/vzBjN26DnntIrOyGizzXK35yKQdYnUABkyN4saz3WD/viF+eCcsXnIajdWYJWaYHRstIis9CS+tqnFGmz2j5uzfr3Z4prqgK4XOT/PyftvjZqIm8lhkfxJ7Ol3CJF1piYBGAG8wtAk56Drw1YwmOpcz+NdfkSpSLplRXLXHL0Rquj6YW/gabqgK7Dgr6NwtH0B/AN7XrN+MVJ6AmXmUuqmQulrNNYPmH0RoDogydOKLo/QbfYNARSQQKISRCzRXU+q9WWJFL3LZW6u34CkeG97xC0NNGaJ0bvK6SnZS3zPskr5EtuCgjMWR5o2x5BqhKmDWJPRe7JMEOyRb5uUKlHaGVtq5ivSOaSliSXp9SQm2qk8MRJh10MAp9QQ2H5t59J8rjiwSZtoIfMGjlLPVNdYl/LBR0AO6WLGDmkLkIPRE45Y9MftdAK/yNu1Hn6tzOQTesgQ+8fSzB19wO91vCnO23vOWQdwJ63SJrYjdfKFW6W281PKs2k8iT9ai1cgJ4sa3xqdvmtxR8/+D1B8AKc2u+6JftryRhMWSQtoSBgIyyQGyxcnELuAasXN12oSriU4RMz1DD6RL0TSV+om7i1Yt+jEE/jnawM8cX/UhN4nkiv/w9eALrzNhXuQfOzFL0Fi6SjF7/4Qn8rLYBoa85cvgAnkCEBP+HPbEnquVXCZsMS/yzYw2Vru60P/+nJPYKkzZFjmbykzUoEqV836T5q3fP/L383dF82tx18/AZgZczMAgyeWYKmSZIqtHL+e+O4ZRcq9VI3g/qPeCoiK4pcgEqdbS0S/Be54sbVQOuJVPNBblIghzeasNu7h/g+Sz1IdhI5lCwq1nUb3Ji4OCIcqQZqtqJ5w7rXrg/DA9IgVmEGhDgGecEwnCTHffXcXs0V3OCEVzYDKS1vp/oX+ng+6XVU86UjA6FMO2RXOOOrqY1GgPvrAk9HV/BXtCu5RuwF8qgdGDLsBcui4E33ymdBip1X8uKyhIWT8qNRDsXz+gvO9UiEC0d8RG4Tf2x8H4slljgHtCBcxHLTWOYJm5H/fCPCzOgf9qgOUxTRZ0Pc6ha5yLuLVT9ntvIa6gacE99mCovdUumTQdRP4RPsS9129eEe2uSvvGh0bV4Y3QPPhPZMqhZWSMa5R0Hc1SGO4IVOQc0FrirlibTVfKRrYkD8kz3b+X65/QkUNaZdrdl3mCap0Hf3YcCw/LiouJYNbqz88UqeDYv93yO7vvXtgl4XCyAO4ODkY6W+83+LZU//p3/zXNGGrUKClCiOnL27iJZbNWDF02XXAOeFlB7IaADoMH1Yqr+UP9biyZDEa/iJt4MDeIz6GKTdLVBfWGVtRN4fdT2rgReX8UXwF2zOrradm4J0nyTgdPnai3RvzpZvCKDUqjOwD/QA6EDaMCLewX6QWYVnHY1sx1bd8ovYnPm1ZvPH+rE20lWjOCnZ66/xDt0QAl15FjfBcZp+i9OU0RNPQ0t3x2pSNWo8eiYudwsnuP1Hq6iH1LJCJynkYsfgJ0p3pF6SoQk2l+jqE8CPk+ziGJRSKjs+W5AO185umPdkYzlK4wl7TC9NxyyDP7ZoyYVoXiuS6SjnInlLWrwz1i8bGTKXX0AVQWkSfIlglW3zRJRJ8bg5VgE6ZEnqNu9B++0GNQvDQJvFize4ESNKBJP+8vA3LM4AX5SIBq08Mob+7QMTCZx4nwP/64+4BnlZC+8WtlP/CXw6t1PwMwkJ3jhP1FiXLhDF/3I6FGUzO2DSi9ABxKyyL9paZxSEz40ZCPQToDAJu1959k7QdbVxgB4icsu2s4zsTPJhcEDo+N1GX4zSk/wriRh8AqwL62972i9HJHd1ydaLXVzvKvOfGGw5RVcUVMiKXFH4APdkQU/dc5BX0YfKTNZYXCW9mb8bc8mufoQP6BbdQmT99ZjoYfr/go4TgQX9IDgztim7wyFeGMfbNaeqj8Dzs38pgcqwSv2hbqB3oSGKWKy+sesY7p57wAHldqE6NDudk/W7s/zjrK4rZFlFvaGxnSZdHbc1y47qDN6xkoK8O3bfr2j41dlJZ71rB4dlDqapPFa8N6xBrprUdtenUCHwxKNhw1uuTBh+9uU45k4REpQABN2bAO9DSLqoIL26gNroWgup5pUMxHUNSq4Gyz47vBPvilpo5f9OYI2ddAqTqmnxXERxQJ3UK8fHbVE9HagHi3+tqNRoNsArdmAxHA5LwtQo9ZAaNKUTljnokljo2x8scqVpEEIPc01fPCdHOCg0DeWBz8D5TVAAfx8aRH5X2ZYNI3ebKDZdeJ+oBDAxmRqJ30Eh2/DaeAy5diVNMpEDmXiPDsGTzBLXy8eVDdJoIafgx/gxMyQi454QrW56nCyeELgSuNNEmYkflF+t3CZQOVRWjKhIuCclmQSlAXT3+4JGG75B4t/5hQ+ldMP4LsAW6z3XmU6IJJwpnGVnsgUZhoY1fZlwTR8wSU7xRejf2uCx9Z5trVTRRJP9KnEb134dEieil6eCOGWgboI7xsqsqM99jfJLTePjygKlH2CVxxsse9QRzTBFjD/Kjqitr/CCTBt/SJ6nLxz7cKP9pFqBpp0lN5y+adKNsZjrPuroemZauH9aTTFD3EKHW8S55XBLFQAt1jgxTQCTwxmx/JyfsZDN1RroN3VaxpSenpIX7K+ZbL8VdlQDcI4Cbzg3QJLa9yVqNxUelu+EtxLVqeekaAvSJkO6sSVqbUajxqhKshNpvZqoeApF0k/0P0ikkwUcbdwc4A1ejN7Oo0O15kG7hTMoK3hZRBCX7YYeLW0wvcXx/18n/u37yLgzBYVBUvORGli+sfRcX/74uD6P4hq+7xu54TlWJLFzT63uwUDwuEDdOjJQqx7JV+ZjaEAPi7t0MMrR4Q8Rkf18uxD6RK0RKh0hL8YU+DeL97i4pa5ZSyAfXKwZRS/8gXcxdZXm62RBDj8U3sN8x95b5PpPs/mCBKYvpaA50pN5Ct/499AFTtwQ5vgeSh+NHrKIi4NVpwM/XzRaNfJD856lPE6M21zWPguFsH7jbLVyEDfRmt4VwrhCJ5VTYmcSPfGgO5clfN+vbaDZ7sakU5+2vZ2WCDY031NxJarVytfDDVtiafcTGO2rJ/taoL3zChN2qmjxofczTOYQPPVQPh0JVtYgdUQINcSiNEEy58UdYXX1MpWUCEBx7LbcGtAm8XWRQTVOaoV3ySri4RShhs/B/0m4jX6OAwXOvcA09bNSG4czEGv/Wey6V/jbTCNTW6awXdNTcA1GsPe1E9fZdGl7R0vyoVpIdJtfC6d32NNErrvq/R+d65VG+YOwRXppXxOCYyGNSf1K3x6VxAW/vtz4EC1SgCOSPdN62sLsoIzuDfg8GwZAbquVO8HIuFP/ToVoeUB7nnwMF35a1wK1tI6fkrqFKhQdeJpwyls0pIy8AZde3/6LUUbFaYJthyUJSU/kqDXTLQElnn0Jr4B2RVghNrmNmoEn7pXIeshPguXVsvwoTdmClq49JJU3LWhHyWTrJL9bRP6VKv3tZoA/th77p5Jw++OEENvyvWy/pNeExiDUVQaXIRGh8xySZTI36yueFaSXo1uJY0RnXYgEOoWWOJHeaVuX/bGNhHsh2yinznl/++NJcE9j6fBPRcBdq9hb8awNw8U7Bl6GM7x69EDOIIbX/npZ++amlHR9L/35mE/2Ss4gb0xCcY4VyTFLRE796vHysLAamqcyO+aFQyJIDBNslbH2/MrAvZiSEIedc/cqjmv4fbda2pXbv+F5a2szSsdkm9noiNURXt8edUhGUF6fSZWd1IJaXKFwD+49R6eCXD4Bkef7j9tRtNMVgW8BhRz/Qpy1TmeYk0doyjZoJSbePOReVHgkFsCFuQJ+Lgc4BxeAsK/cOiNDRmdNw0ctYhn/nQ498dYI5znzGLoJi1rav7Cn88rL3wLePVtDK5gl77Tki3gHEsIAQ2+IKgarj7Y8W1IQzV5V9N+0TjLqbg68WfKcOmBCOj3JkwJhVIkwDhc+JorXuZEPMEh0vvH3x7iqf+VAwXgd4diZiaJD1zHL9Snx6Wfg4IugreyhabQkcir+y5XgDtdx3Avs7lkeeCBwDvZoTUCXx5QrZkcEqWfYEiEYRs/EphmRALSNGR1Iclgdr5VFoELpzF4++f35w3/j0t5ucW3n2ch4PQCLuUXupsPRR7UA5FjSKrMtPcKAZJfagO4lGE7FH3YKMjorpK0ZxAv+i2JkJhtAMWWWFej4RhPR/cJ3DxwocCvXDi4SGZU4cu+K32XndiFWgopAl+0GApcwf1XvymJcFs39jExIBO4yUjU9MExBLQYc9H+W7+IgdESPRpciT+rKZPebVtaVq+1GYO/5xTAL3HASjNTGIgMvdjWbgc7JvdE1zIFpuC0U9ESiZyzBixzxWxj4Kwh8My34q+FK3KNLtmsA1qyrmKSNQOXCPUZd+ONelBTvFoUI/CYsqa/RhtKiyMf2CgSFqEPk59Y3uqnlZ8gFpswfSYyko23yVZYxzKGxGm49Zqxg1l8oz5Ra9XaRwHkuxepmgyhm0SoNy2KlbcEqK+9QqS9PNx9Ihm9U7gsR55SSJ1FBDNnkuWKxIZ0SDpXuOGwZdoUbOMDPHP4vBAgz2VlSEJAHZGJVbYIg7l/FO5KfIVvxC8pPPxMGcNMoevFDeStt2iqztE10n2TA4dgJH76YS9HDhKHD3iCx6ieFX84BAI3QQnngh76f5ruPQVbr5qZmck/5UjDc26lfrOvUBWy0Ogl8bCoOkMOns81TnC3cuUS9KW8+9A+fe3XYZOFUPG1u5epSSmDLw0s5s2F0W30ANeo+zJkJQz9SPZgzwYpEoktofhGVfmLOAB20boCbW1QWq/NpET/hnMecw/uSyAH4NJc3ECOU4nnkK1fj3S/i5dwb3R7k00AqQQUwt7Ie1qV0aY/VQX0J8hLPy7eBNXMHYZYDNxHZ2Qh6AuXJxq+AeRec/Q+JLhZV6hpXwQEzw7bf5v9uUf2vpq3qlhmy0IIGTkwYdCfSAFmqbdo+3XvDTDjFJde0mbeQLcn2n31xaAqJ0ixO/CLsT4I4G4DoncVTgRGNBtsCcjISWT+oeXZ4Iedw/8OsJI1aPnNKLX/60VvcZb94uasRxCkqlPQ11u1Sa2hHvB80WQENxVyzjns0/PiEByyil21Te6oisk3mNCEMrhouCFO3yEZTHHOCMy9eb/4Tmi8cVf3Lf7P53SY2hX3PSN033As3ETIMLHWumWEO9JXHA2y2SIBlIPpLGG2qvNsCIlIr+B1SWAqRKm2w6Blf7U+zCSBwJrfHG5i8J5Gax/cVonMlon7aHJX/gSvucIncRP93XCqkv7D8IFKFsLiBgHqUpXhE3pYjEcV1dk/JD9zFVCfEaQIVX8Jmfz7IIofcBKQ4OaG+C3xC2veX9CD+iAFXDNaGg9eTVxvkbJRJlW4Nk9Wk13kn696jWppRDe/8pDrYMO9ZyxZ98ReKSz9kWKLLyk2zCZgAniCkLJVX3n1M9DYbomyahWiv/KixRIV9hj/oFz87I+HLznbPTjpa+D+bZQnMuRsljTpv90vQUt/pK7jCFnA30B/jtroSF2/m/gpWn1aQs5WeA6ghzF8SdqWI20fghdSeDOCSCmLgTkfaGgGDmw7nHFkRzGtag57IHS2na06I+gzEphXo1w/Zx2BM/jKL2nZoFjHggtFQjYi8nSVRSXIE58RPbBObXk7uuIL9+rs/5Zo7suJInEUxgsiZZAWS25iBtpEiZeBgDtghEoAE0sjcayNq85M4tbu/LF5h51335PsGzQ09O875+vUS89lkWMyNOFoip2PuyWyMP/iU2XIZdfCCJNDjebDoBLQdpy7QQZC7s9c0wjHJervQNDu2jWzBW5MSAJMr7bP+Iv92BkS/GGgzjEn7MF1IRKFwwzbjbS4/slGOmhx9cZrFu7HSEefojNv3r0UaKfKOWzXsq1zEugbzlMDFsacRJJI/iJlK3vtkZ+PLZIVMFlKA32wbq2Kd5T0uCLZ1CPkAfCdzkz2EYscjDcZq2AWfziN2covN4kXE1lQXPPLTNM1xx3tbiepcO/t3SWm4w87qfh99SL0ZnY+LKFPLPeXVM2mIIoVWt+9Nk0I7nY4O79iGYqxZ8RVz289an6NVdJWnSKZvJQCAuHNiVaDxPAFoH392t9wot5t0/qmU95eEWNbU2udUW5sN9JVqcYlvAIfLeYC33oUzzxZgSktsv21mA7Uly1FA5VnoJFh6N244Wmv3YJGFv/TCPryaw+ZORlpZjQdq/2DYXr3EZskfed0G61P09ipTKmlTQ1067Rg5+PAk5FlQ9e0SWbGf2B/08kqymOTMVOznsALHHNFH4LFRKl2F/NOiYFl9khNHnSu9Ak5sq26Ynl/i2fdTle29Y1ugqmR5Yj4YT9pvslFyYCbw0mNFr5rVQm1LvkG27QMq9ph3t8fmn6r6SQ4oSbr5tz+J1kIawGzDxb6VYOvvWhobDTXfBeNv3b4aNm5XUinsCGqG2q/45m3+LoCOsddFceYhRx1Tsss9PLdPfJdErFMjYd3gddjiP0+XQjcRadZP6bwNLySvunFf20Czy6JqdEW2a96KxdYdOryBv1BjbuUq2yCHeh+6sk7fGmmPi50pe/1l5TyPe5oHW9oPnhPswLyf2TFDdCyYlhwBCstv5C1HwlW7xWoGT9XZt4qVj5WryLPLLD6h/5cMLEjWzgCeAIKNsLak92aBqBsHl4AJwl2N4jfvbSkBExGimv0nFvv09uDScQbjx+w4kPQjgjlW+g9ws9VEJvI2k8N6XxVu0uIwovgTFdunG24gBtaDi+y1YLQwZ8mwbip5fVlO3k0n0AEr/ETbtu8Vjkm+nNSiEb7X/3fMjBL5A8PdgG+/FnbexbFFExmEfetXAnisEKy5z44WVPpQZjSy/jzeGn4yDRsFGqhh87QPaDBWhlo37IFbe/C0xynS91d2tP/AJoJS0sVF6iwAAAAAElFTkSuQmCC");
}

#logo {
    position: fixed;
    bottom: 10px;
    right: 10px;
    background: rgba(255, 255, 255, .1);
    font-size: 11px;
    display: block;
    width: 20px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    -webkit-border-radius: 20px;
    -moz-border-radius: 20px;
    -webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .2);
    -moz-box-shadow: 0 0 3px rgba(0, 0, 0, .2);
    color: inherit;
}

#menu li a {
    display: block;
    color: white;
    padding: 0 35px 0 25px;
    -webkit-transition: background 300ms;
    -moz-transition: background 300ms;
}

#menu li {
    position: relative;
    list-style: none;
}

#menu a:hover,
#menu a.active {
    text-decoration: none;
    background: rgba(255, 255, 255, .1);
}

#menu li:hover .cov {
    opacity: 1;
}

#menu li .dirname {
    opacity: .60;
    padding-right: 2px;
}

#menu li .basename {
    opacity: 1;
}

#menu .cov {
    background: rgba(0, 0, 0, .4);
    position: absolute;
    top: 0;
    right: 8px;
    font-size: 9px;
    opacity: .6;
    text-align: left;
    width: 17px;
    -webkit-border-radius: 10px;
    -moz-border-radius: 10px;
    padding: 2px 3px;
    text-align: center;
}

#stats:nth-child(2n) {
    display: inline-block;
    margin-top: 15px;
    border: 1px solid #eee;
    padding: 10px;
    -webkit-box-shadow: inset 0 0 2px #eee;
    -moz-box-shadow: inset 0 0 2px #eee;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
}

#stats div {
    float: left;
    padding: 0 5px;
}

#stats::after {
    display: block;
    content: '';
    clear: both;
}

#stats .sloc::after {
    content: ' SLOC';
    color: #b6b6b6;
}

#stats .percentage::after {
    content: ' coverage';
    color: #b6b6b6;
}

#stats .hits,
#stats .misses {
    display: none;
}

.high {
    color: #00d4b4;
}

.medium {
    color: #e87d0d;
}

.low {
    color: #d4081a;
}

.terrible {
    color: #d4081a;
    font-weight: bold;
}

table {
    width: 80%;
    margin-top: 10px;
    border-collapse: collapse;
    border: 1px solid #cbcbcb;
    color: #363636;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
}

table thead {
    display: none;
}

table td.line,
table td.hits {
    width: 20px;
    background: #eaeaea;
    text-align: center;
    font-size: 11px;
    padding: 0 10px;
    color: #949494;
}

table td.hits {
    width: 10px;
    padding: 2px 5px;
    color: rgba(0, 0, 0, .2);
    background: #f0f0f0;
}

tr.miss td.line,
tr.miss td.hits {
    background: #e6c3c7;
}

tr.miss td {
    background: #f8d5d8;
}

td.source {
    padding-left: 15px;
    line-height: 15px;
    white-space: pre;
    font: 12px monaco, monospace;
}

code .comment {
    color: #ddd
}

code .init {
    color: #2F6FAD
}

code .string {
    color: #5890AD
}

code .keyword {
    color: #8A6343
}

code .number {
    color: #2F6FAD
}
</style>
</head>
<body>
<div id="coverage"><h1 id="overview">Coverage</h1>

<div id="menu">
    <li><a href="#overview">overview</a></li>
    <li><span class="cov high">77</span><a href="#client.js"><span class="basename">client.js</span></a></li>
    <li><span class="cov high">80</span><a href="#configServer.js"><span class="basename">configServer.js</span></a>
    </li>
    <li><span class="cov high">95</span><a href="#packet.js"><span class="basename">packet.js</span></a></li>
    <li><span class="cov high">100</span><a href="#const.js"><span class="basename">const.js</span></a></li>
    <li><span class="cov high">100</span><a href="#utils.js"><span class="basename">utils.js</span></a></li>
    <li><span class="cov high">81</span><a href="#transcoder.js"><span class="basename">transcoder.js</span></a>
    </li>
    <li><span class="cov high">93</span><a href="#comm.js"><span class="basename">comm.js</span></a></li>
    <a id="logo" href="http://visionmedia.github.com/mocha/">m</a></div>
<div id="stats" class="high">
    <div class="percentage">88%</div>
    <div class="sloc">829</div>
    <div class="hits">730</div>
    <div class="misses">99</div>
</div>
<div id="files">
<div class="file"><h2 id="client.js">client.js</h2>

<div id="stats" class="high">
    <div class="percentage">77%</div>
    <div class="sloc">205</div>
    <div class="hits">159</div>
    <div class="misses">46</div>
</div>
<table id="source">
<thead>
<tr>
    <th>Line</th>
    <th>Hits</th>
    <th>Source</th>
</tr>
</thead>
<tbody>
<tr>
    <td class="line">1</td>
    <td class="hits"></td>
    <td class="source">/*!</td>
</tr>
<tr>
    <td class="line">2</td>
    <td class="hits"></td>
    <td class="source"> * tair - lib/client.js</td>
</tr>
<tr>
    <td class="line">3</td>
    <td class="hits"></td>
    <td class="source"> * Copyright(c) 2012 Taobao.com</td>
</tr>
<tr>
    <td class="line">4</td>
    <td class="hits"></td>
    <td class="source"> * Author: kate.sf &lt;kate.sf@taobao.com&gt;</td>
</tr>
<tr>
    <td class="line">5</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">6</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">7</td>
    <td class="hits">1</td>
    <td class="source">var configServer = require('./configServer');</td>
</tr>
<tr class="hit">
    <td class="line">8</td>
    <td class="hits">1</td>
    <td class="source">var comm = require('./comm');</td>
</tr>
<tr class="hit">
    <td class="line">9</td>
    <td class="hits">1</td>
    <td class="source">var packet = require('./packet');</td>
</tr>
<tr class="hit">
    <td class="line">10</td>
    <td class="hits">1</td>
    <td class="source">var consts = require('./const');</td>
</tr>
<tr>
    <td class="line">11</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">12</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">13</td>
    <td class="hits"></td>
    <td class="source"> * initial clients. must be first called, all three params must be used</td>
</tr>
<tr>
    <td class="line">14</td>
    <td class="hits"></td>
    <td class="source"> * @type {Function}</td>
</tr>
<tr>
    <td class="line">15</td>
    <td class="hits"></td>
    <td class="source"> * @params groupnName&#239;&#188;&#154;group name of tair</td>
</tr>
<tr>
    <td class="line">16</td>
    <td class="hits"></td>
    <td class="source"> * @params hostList: config server list of tair, like [{host: '10.235.144.116',
        port: 5198}]
    </td>
</tr>
<tr>
    <td class="line">17</td>
    <td class="hits"></td>
    <td class="source"> * @params callback(err):</td>
</tr>
<tr>
    <td class="line">18</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr class="hit">
    <td class="line">19</td>
    <td class="hits">1</td>
    <td class="source">var Tair = module.exports = function (groupName, hostList, callback) {</td>
</tr>
<tr>
    <td class="line">20</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">21</td>
    <td class="hits">2</td>
    <td class="source"> if (!(this instanceof Tair)) {</td>
</tr>
<tr class="miss">
    <td class="line">22</td>
    <td class="hits">0</td>
    <td class="source"> return new Tair();</td>
</tr>
<tr>
    <td class="line">23</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">24</td>
    <td class="hits">2</td>
    <td class="source"> callback = callback || function () {</td>
</tr>
<tr>
    <td class="line">25</td>
    <td class="hits"></td>
    <td class="source"> };</td>
</tr>
<tr class="hit">
    <td class="line">26</td>
    <td class="hits">2</td>
    <td class="source"> if (!groupName || !hostList || !callback) {</td>
</tr>
<tr class="miss">
    <td class="line">27</td>
    <td class="hits">0</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">28</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">29</td>
    <td class="hits">2</td>
    <td class="source"> var that = this;</td>
</tr>
<tr class="hit">
    <td class="line">30</td>
    <td class="hits">2</td>
    <td class="source"> this.requestQueue = [];</td>
</tr>
<tr class="hit">
    <td class="line">31</td>
    <td class="hits">2</td>
    <td class="source"> this.retrieveConfigure(groupName, hostList, function (err) {</td>
</tr>
<tr class="hit">
    <td class="line">32</td>
    <td class="hits">3</td>
    <td class="source"> if (err) {</td>
</tr>
<tr class="miss">
    <td class="line">33</td>
    <td class="hits">0</td>
    <td class="source"> return callback(err);</td>
</tr>
<tr>
    <td class="line">34</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">35</td>
    <td class="hits">3</td>
    <td class="source"> callback(null);</td>
</tr>
<tr class="hit">
    <td class="line">36</td>
    <td class="hits">3</td>
    <td class="source"> if (that.requestQueue &amp;&amp; that.requestQueue.length &gt; 0) {</td>
</tr>
<tr class="hit">
    <td class="line">37</td>
    <td class="hits">2</td>
    <td class="source"> for (var i = 0; i &lt; that.requestQueue.length; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">38</td>
    <td class="hits">6</td>
    <td class="source"> var method = that.requestQueue[i].method;</td>
</tr>
<tr class="hit">
    <td class="line">39</td>
    <td class="hits">6</td>
    <td class="source"> that[method].apply(that.requestQueue[i].that, that.requestQueue[i].args);</td>
</tr>
<tr>
    <td class="line">40</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">41</td>
    <td class="hits">2</td>
    <td class="source"> delete this.requestQueue;</td>
</tr>
<tr>
    <td class="line">42</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">43</td>
    <td class="hits">3</td>
    <td class="source"> setInterval(function () {</td>
</tr>
<tr class="miss">
    <td class="line">44</td>
    <td class="hits">0</td>
    <td class="source"> var now = new Date().getTime();</td>
</tr>
<tr class="miss">
    <td class="line">45</td>
    <td class="hits">0</td>
    <td class="source"> if (that.inited &amp;&amp; (now - that.lastSyncConfig &gt; 120 * 1000)) {</td>
</tr>
<tr class="miss">
    <td class="line">46</td>
    <td class="hits">0</td>
    <td class="source"> that.retrieveConfigure(that._groupName, that._hostList, function () {</td>
</tr>
<tr>
    <td class="line">47</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr>
    <td class="line">48</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">49</td>
    <td class="hits"></td>
    <td class="source"> }, 60 * 1000);</td>
</tr>
<tr>
    <td class="line">50</td>
    <td class="hits"></td>
    <td class="source"> })</td>
</tr>
<tr>
    <td class="line">51</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">52</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">53</td>
    <td class="hits">1</td>
    <td class="source">Tair.prototype.retrieveConfigure = function (groupName, hostList, callback) {
    </td>
</tr>
<tr class="hit">
    <td class="line">54</td>
    <td class="hits">2</td>
    <td class="source"> var that = this;</td>
</tr>
<tr class="hit">
    <td class="line">55</td>
    <td class="hits">2</td>
    <td class="source"> configServer.retrieveConfigure.apply(this, [groupName, 0, hostList, function
        (err) {
    </td>
</tr>
<tr class="hit">
    <td class="line">56</td>
    <td class="hits">3</td>
    <td class="source"> if (err) {</td>
</tr>
<tr class="miss">
    <td class="line">57</td>
    <td class="hits">0</td>
    <td class="source"> return callback(err);</td>
</tr>
<tr>
    <td class="line">58</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">59</td>
    <td class="hits">3</td>
    <td class="source"> that._groupName = groupName;</td>
</tr>
<tr class="hit">
    <td class="line">60</td>
    <td class="hits">3</td>
    <td class="source"> that._hostList = hostList;</td>
</tr>
<tr class="hit">
    <td class="line">61</td>
    <td class="hits">3</td>
    <td class="source"> that.inited = true;</td>
</tr>
<tr class="hit">
    <td class="line">62</td>
    <td class="hits">3</td>
    <td class="source"> that.lastSyncConfig = new Date().getTime();</td>
</tr>
<tr class="hit">
    <td class="line">63</td>
    <td class="hits">3</td>
    <td class="source"> callback(null);</td>
</tr>
<tr>
    <td class="line">64</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">65</td>
    <td class="hits"></td>
    <td class="source"> }]);</td>
</tr>
<tr>
    <td class="line">66</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">67</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">68</td>
    <td class="hits">1</td>
    <td class="source">Tair.prototype.getDataNode = function () {</td>
</tr>
<tr class="hit">
    <td class="line">69</td>
    <td class="hits">25</td>
    <td class="source"> return configServer.getDataNode.apply(this,
        Array.prototype.slice.apply(arguments));
    </td>
</tr>
<tr>
    <td class="line">70</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">71</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">72</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">73</td>
    <td class="hits"></td>
    <td class="source"> * set / setEx method</td>
</tr>
<tr>
    <td class="line">74</td>
    <td class="hits"></td>
    <td class="source"> * @type {Function}</td>
</tr>
<tr>
    <td class="line">75</td>
    <td class="hits"></td>
    <td class="source"> * @params key&#239;&#188;&#154;must be string, the key to set</td>
</tr>
<tr>
    <td class="line">76</td>
    <td class="hits"></td>
    <td class="source"> * @params value: usually string, the value to set</td>
</tr>
<tr>
    <td class="line">77</td>
    <td class="hits"></td>
    <td class="source"> * @params expire: seconds to expire, number, optional, default is 0 (not
        expired)
    </td>
</tr>
<tr>
    <td class="line">78</td>
    <td class="hits"></td>
    <td class="source"> * @params namespace: the area(namespace) of data, number 0~1023, optional,
        default is 0
    </td>
</tr>
<tr>
    <td class="line">79</td>
    <td class="hits"></td>
    <td class="source"> * @params version: the version of data, using to solve concurrency conflicts,
        not commonly used in cache, optional, default is 0
    </td>
</tr>
<tr>
    <td class="line">80</td>
    <td class="hits"></td>
    <td class="source"> * @params callback(err, success):</td>
</tr>
<tr>
    <td class="line">81</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr class="hit">
    <td class="line">82</td>
    <td class="hits">1</td>
    <td class="source">Tair.prototype.set = Tair.prototype.setEx = function (key, value, expire,
        namespace, version, callback) {
    </td>
</tr>
<tr class="hit">
    <td class="line">83</td>
    <td class="hits">10</td>
    <td class="source"> var _expire = typeof expire === 'number' ? expire : 0;</td>
</tr>
<tr class="hit">
    <td class="line">84</td>
    <td class="hits">10</td>
    <td class="source"> var _namespace = typeof namespace === 'number' ? namespace : 0;</td>
</tr>
<tr class="hit">
    <td class="line">85</td>
    <td class="hits">10</td>
    <td class="source"> var _version = typeof version === 'number' ? version : 0;</td>
</tr>
<tr class="hit">
    <td class="line">86</td>
    <td class="hits">10</td>
    <td class="source"> if (typeof expire === 'function') {</td>
</tr>
<tr class="hit">
    <td class="line">87</td>
    <td class="hits">10</td>
    <td class="source"> callback = expire;</td>
</tr>
<tr>
    <td class="line">88</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">89</td>
    <td class="hits">10</td>
    <td class="source"> if (typeof namespace === 'function') {</td>
</tr>
<tr class="miss">
    <td class="line">90</td>
    <td class="hits">0</td>
    <td class="source"> callback = namespace;</td>
</tr>
<tr>
    <td class="line">91</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">92</td>
    <td class="hits">10</td>
    <td class="source"> if (typeof version === 'function') {</td>
</tr>
<tr class="miss">
    <td class="line">93</td>
    <td class="hits">0</td>
    <td class="source"> callback = version;</td>
</tr>
<tr>
    <td class="line">94</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">95</td>
    <td class="hits">10</td>
    <td class="source"> if (!key || key.length === 0 || typeof key !== 'string') {</td>
</tr>
<tr class="miss">
    <td class="line">96</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: params lack.'), false);</td>
</tr>
<tr>
    <td class="line">97</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">98</td>
    <td class="hits">10</td>
    <td class="source"> if (!value || value.length === 0) {</td>
</tr>
<tr class="miss">
    <td class="line">99</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: params lack.'), false);</td>
</tr>
<tr>
    <td class="line">100</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">101</td>
    <td class="hits">10</td>
    <td class="source"> if (!this.inited) {</td>
</tr>
<tr>
    <td class="line">102</td>
    <td class="hits"></td>
    <td class="source"> //console.warn('Tair: client not init');</td>
</tr>
<tr class="hit">
    <td class="line">103</td>
    <td class="hits">1</td>
    <td class="source"> this.requestQueue.push({method: 'set', args:
        Array.prototype.slice.apply(arguments), that: this});
    </td>
</tr>
<tr class="hit">
    <td class="line">104</td>
    <td class="hits">1</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">105</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">106</td>
    <td class="hits">9</td>
    <td class="source"> var _packet = packet.requestPutPacket(_namespace, _version, key, value,
        _expire);
    </td>
</tr>
<tr class="hit">
    <td class="line">107</td>
    <td class="hits">9</td>
    <td class="source"> var _addr = this.getDataNode(key);</td>
</tr>
<tr class="hit">
    <td class="line">108</td>
    <td class="hits">9</td>
    <td class="source"> if (!_addr.success) {</td>
</tr>
<tr class="miss">
    <td class="line">109</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: find datanode error'), false);</td>
</tr>
<tr>
    <td class="line">110</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">111</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">112</td>
    <td class="hits">9</td>
    <td class="source"> if (key.length &gt;= consts.NAMESPACE_MAX) {</td>
</tr>
<tr class="miss">
    <td class="line">113</td>
    <td class="hits">0</td>
    <td class="source"> return callback(null, false);</td>
</tr>
<tr>
    <td class="line">114</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">115</td>
    <td class="hits">9</td>
    <td class="source"> if (value.length &gt;= consts.TAIR_MALLOC_MAX - 1) {</td>
</tr>
<tr class="miss">
    <td class="line">116</td>
    <td class="hits">0</td>
    <td class="source"> return callback(null, false);</td>
</tr>
<tr>
    <td class="line">117</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">118</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">119</td>
    <td class="hits">9</td>
    <td class="source"> comm.getData(_addr, _packet, function (err, data, len) {</td>
</tr>
<tr class="hit">
    <td class="line">120</td>
    <td class="hits">9</td>
    <td class="source"> if (err) {</td>
</tr>
<tr class="miss">
    <td class="line">121</td>
    <td class="hits">0</td>
    <td class="source"> if (!callback.called) {</td>
</tr>
<tr class="miss">
    <td class="line">122</td>
    <td class="hits">0</td>
    <td class="source"> callback.called = true;</td>
</tr>
<tr class="miss">
    <td class="line">123</td>
    <td class="hits">0</td>
    <td class="source"> return callback(err, false);</td>
</tr>
<tr>
    <td class="line">124</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">125</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">126</td>
    <td class="hits">9</td>
    <td class="source"> var returned = packet.returnPacket(data);</td>
</tr>
<tr class="hit">
    <td class="line">127</td>
    <td class="hits">9</td>
    <td class="source"> if (returned.code !== 0) {</td>
</tr>
<tr class="miss">
    <td class="line">128</td>
    <td class="hits">0</td>
    <td class="source"> if (!callback.called) {</td>
</tr>
<tr class="miss">
    <td class="line">129</td>
    <td class="hits">0</td>
    <td class="source"> callback.called = true;</td>
</tr>
<tr class="miss">
    <td class="line">130</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair Error: Code ' + returned.code));</td>
</tr>
<tr>
    <td class="line">131</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">132</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">133</td>
    <td class="hits">9</td>
    <td class="source"> if (!callback.called) {</td>
</tr>
<tr class="hit">
    <td class="line">134</td>
    <td class="hits">8</td>
    <td class="source"> callback.called = true;</td>
</tr>
<tr class="hit">
    <td class="line">135</td>
    <td class="hits">8</td>
    <td class="source"> return callback(null, true);</td>
</tr>
<tr>
    <td class="line">136</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">137</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr>
    <td class="line">138</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">139</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">140</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">141</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">142</td>
    <td class="hits"></td>
    <td class="source"> * get method</td>
</tr>
<tr>
    <td class="line">143</td>
    <td class="hits"></td>
    <td class="source"> * @type {Function}</td>
</tr>
<tr>
    <td class="line">144</td>
    <td class="hits"></td>
    <td class="source"> * @params key&#239;&#188;&#154;must be string, the key to get</td>
</tr>
<tr>
    <td class="line">145</td>
    <td class="hits"></td>
    <td class="source"> * @params namespace: the area(namespace) of data, number 0~1023, optional,
        default is 0
    </td>
</tr>
<tr>
    <td class="line">146</td>
    <td class="hits"></td>
    <td class="source"> * @params callback(err, data):</td>
</tr>
<tr>
    <td class="line">147</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr class="hit">
    <td class="line">148</td>
    <td class="hits">1</td>
    <td class="source">Tair.prototype.get = function (key, namespace, callback) {</td>
</tr>
<tr class="hit">
    <td class="line">149</td>
    <td class="hits">7</td>
    <td class="source"> var _namespace = typeof namespace === 'number' ? namespace : 0;</td>
</tr>
<tr class="hit">
    <td class="line">150</td>
    <td class="hits">7</td>
    <td class="source"> if (typeof namespace === 'function') {</td>
</tr>
<tr class="hit">
    <td class="line">151</td>
    <td class="hits">4</td>
    <td class="source"> callback = namespace;</td>
</tr>
<tr>
    <td class="line">152</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">153</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">154</td>
    <td class="hits">7</td>
    <td class="source"> if (!key || key.length === 0 || typeof key !== 'string') {</td>
</tr>
<tr class="miss">
    <td class="line">155</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: params lack.'), false);</td>
</tr>
<tr>
    <td class="line">156</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">157</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">158</td>
    <td class="hits">7</td>
    <td class="source"> if (!this.inited) {</td>
</tr>
<tr>
    <td class="line">159</td>
    <td class="hits"></td>
    <td class="source"> //console.warn('Tair: client not init');</td>
</tr>
<tr class="hit">
    <td class="line">160</td>
    <td class="hits">1</td>
    <td class="source"> this.requestQueue.push({method: 'get', args:
        Array.prototype.slice.apply(arguments), that: this});
    </td>
</tr>
<tr class="hit">
    <td class="line">161</td>
    <td class="hits">1</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">162</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">163</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">164</td>
    <td class="hits">6</td>
    <td class="source"> var _packet = packet.requestGetOrRemovePacket(_namespace, key);</td>
</tr>
<tr>
    <td class="line">165</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">166</td>
    <td class="hits">6</td>
    <td class="source"> var _addr = this.getDataNode(key);</td>
</tr>
<tr class="hit">
    <td class="line">167</td>
    <td class="hits">6</td>
    <td class="source"> if (!_addr.success) {</td>
</tr>
<tr class="miss">
    <td class="line">168</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: find datanode error'), null);</td>
</tr>
<tr>
    <td class="line">169</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">170</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">171</td>
    <td class="hits">6</td>
    <td class="source"> if (key.length &gt;= consts.NAMESPACE_MAX) {</td>
</tr>
<tr class="miss">
    <td class="line">172</td>
    <td class="hits">0</td>
    <td class="source"> return callback(null, null);</td>
</tr>
<tr>
    <td class="line">173</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">174</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">175</td>
    <td class="hits">6</td>
    <td class="source"> comm.getData(_addr, _packet, function (err, data, len) {</td>
</tr>
<tr class="hit">
    <td class="line">176</td>
    <td class="hits">6</td>
    <td class="source"> if (err) {</td>
</tr>
<tr class="miss">
    <td class="line">177</td>
    <td class="hits">0</td>
    <td class="source"> if (!callback.called) {</td>
</tr>
<tr class="miss">
    <td class="line">178</td>
    <td class="hits">0</td>
    <td class="source"> callback.called = true;</td>
</tr>
<tr class="miss">
    <td class="line">179</td>
    <td class="hits">0</td>
    <td class="source"> return callback(err, false);</td>
</tr>
<tr>
    <td class="line">180</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">181</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">182</td>
    <td class="hits">6</td>
    <td class="source"> var res = packet.responseGetPacket(data);</td>
</tr>
<tr class="hit">
    <td class="line">183</td>
    <td class="hits">6</td>
    <td class="source"> if (!res || !res.key || res.key !== key) {</td>
</tr>
<tr class="hit">
    <td class="line">184</td>
    <td class="hits">4</td>
    <td class="source"> if (!callback.called) {</td>
</tr>
<tr class="hit">
    <td class="line">185</td>
    <td class="hits">3</td>
    <td class="source"> callback.called = true;</td>
</tr>
<tr class="hit">
    <td class="line">186</td>
    <td class="hits">3</td>
    <td class="source"> return callback(null, null);</td>
</tr>
<tr>
    <td class="line">187</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">188</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">189</td>
    <td class="hits">3</td>
    <td class="source"> if (!callback.called) {</td>
</tr>
<tr class="hit">
    <td class="line">190</td>
    <td class="hits">2</td>
    <td class="source"> callback.called = true;</td>
</tr>
<tr class="hit">
    <td class="line">191</td>
    <td class="hits">2</td>
    <td class="source"> return callback(null, res.value);</td>
</tr>
<tr>
    <td class="line">192</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">193</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr>
    <td class="line">194</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">195</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">196</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">197</td>
    <td class="hits"></td>
    <td class="source"> * get method</td>
</tr>
<tr>
    <td class="line">198</td>
    <td class="hits"></td>
    <td class="source"> * @type {Function}</td>
</tr>
<tr>
    <td class="line">199</td>
    <td class="hits"></td>
    <td class="source"> * @params keys&#239;&#188;&#154;must be an array of string, the key to get</td>
</tr>
<tr>
    <td class="line">200</td>
    <td class="hits"></td>
    <td class="source"> * @params namespace: the area(namespace) of data, number 0~1023, optional,
        default is 0
    </td>
</tr>
<tr>
    <td class="line">201</td>
    <td class="hits"></td>
    <td class="source"> * @params callback(err, data):</td>
</tr>
<tr>
    <td class="line">202</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr class="hit">
    <td class="line">203</td>
    <td class="hits">1</td>
    <td class="source">Tair.prototype.mget = function (keys, namespace, callback) {</td>
</tr>
<tr class="hit">
    <td class="line">204</td>
    <td class="hits">1</td>
    <td class="source"> var _namespace = typeof namespace === 'number' ? namespace : 0;</td>
</tr>
<tr class="hit">
    <td class="line">205</td>
    <td class="hits">1</td>
    <td class="source"> if (typeof namespace === 'function') {</td>
</tr>
<tr class="hit">
    <td class="line">206</td>
    <td class="hits">1</td>
    <td class="source"> callback = namespace;</td>
</tr>
<tr>
    <td class="line">207</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">208</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">209</td>
    <td class="hits">1</td>
    <td class="source"> if (!keys || keys.length === 0 || !Array.isArray(keys)) {</td>
</tr>
<tr class="miss">
    <td class="line">210</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: params lack.'), false);</td>
</tr>
<tr>
    <td class="line">211</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">212</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">213</td>
    <td class="hits">1</td>
    <td class="source"> if (!this.inited) {</td>
</tr>
<tr>
    <td class="line">214</td>
    <td class="hits"></td>
    <td class="source"> //console.warn('Tair: client not init');</td>
</tr>
<tr class="miss">
    <td class="line">215</td>
    <td class="hits">0</td>
    <td class="source"> this.requestQueue.push({method: 'mget', args:
        Array.prototype.slice.apply(arguments), that: this});
    </td>
</tr>
<tr class="miss">
    <td class="line">216</td>
    <td class="hits">0</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">217</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">218</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">219</td>
    <td class="hits">1</td>
    <td class="source"> var _keys = [];</td>
</tr>
<tr class="hit">
    <td class="line">220</td>
    <td class="hits">1</td>
    <td class="source"> var _packets = {};</td>
</tr>
<tr class="hit">
    <td class="line">221</td>
    <td class="hits">1</td>
    <td class="source"> for (var i = 0, l = keys.length; i &lt; l; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">222</td>
    <td class="hits">4</td>
    <td class="source"> if (typeof keys[i] === 'string' &amp;&amp; keys[i].length &gt; 0 &amp;&amp;
        keys[i].length &lt; consts.NAMESPACE_MAX) {
    </td>
</tr>
<tr class="hit">
    <td class="line">223</td>
    <td class="hits">4</td>
    <td class="source"> var _addr = this.getDataNode(keys[i]);</td>
</tr>
<tr class="hit">
    <td class="line">224</td>
    <td class="hits">4</td>
    <td class="source"> var _addrKey = _addr.host + _addr.port;</td>
</tr>
<tr class="hit">
    <td class="line">225</td>
    <td class="hits">4</td>
    <td class="source"> if (!_packets[_addrKey]) {</td>
</tr>
<tr class="hit">
    <td class="line">226</td>
    <td class="hits">1</td>
    <td class="source"> _packets.length = (_packets.length || 0) + 1;</td>
</tr>
<tr class="hit">
    <td class="line">227</td>
    <td class="hits">1</td>
    <td class="source"> _packets[_addrKey] = [];</td>
</tr>
<tr class="hit">
    <td class="line">228</td>
    <td class="hits">1</td>
    <td class="source"> _packets[_addrKey].addr = _addr;</td>
</tr>
<tr>
    <td class="line">229</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">230</td>
    <td class="hits"></td>
    <td class="source"> // &#232;&#174;&#176;&#229;&#189;&#149;&#228;&#184;&#139;&#230;&#175;&#143;&#228;&#184;&#170;&#230;&#156;&#141;&#229;&#138;&#161;&#229;&#153;&#168;&#228;&#184;&#173;&#229;&#143;&#145;&#229;&#147;&#170;&#228;&#186;&#155;&#229;&#140;&#133;</td>
</tr>
<tr class="hit">
    <td class="line">231</td>
    <td class="hits">4</td>
    <td class="source"> _packets[_addrKey].push(keys[i]);</td>
</tr>
<tr>
    <td class="line">232</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">233</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">234</td>
    <td class="hits"></td>
    <td class="source"> // &#230;&#158;&#132;&#229;&#187;&#186;&#229;&#140;&#133;</td>
</tr>
<tr>
    <td class="line">235</td>
    <td class="hits"></td>
    <td class="source"> // addr&#228;&#184;&#141;&#228;&#188;&#154;&#229;&#190;&#136;&#229;&#164;&#154;&#239;&#188;&#140;&#231;&#148;&#168;for..in..&#228;&#184;&#141;&#228;&#188;&#154;&#230;&#156;&#137;&#230;&#128;&#167;&#232;&#131;&#189;&#233;&#151;&#174;&#233;&#162;&#152;</td>
</tr>
<tr class="hit">
    <td class="line">236</td>
    <td class="hits">1</td>
    <td class="source"> var retCount = 0;</td>
</tr>
<tr class="hit">
    <td class="line">237</td>
    <td class="hits">1</td>
    <td class="source"> var returned = {};</td>
</tr>
<tr class="hit">
    <td class="line">238</td>
    <td class="hits">1</td>
    <td class="source"> var itemCount = 0;</td>
</tr>
<tr class="hit">
    <td class="line">239</td>
    <td class="hits">1</td>
    <td class="source"> for (var k in _packets) {</td>
</tr>
<tr class="hit">
    <td class="line">240</td>
    <td class="hits">2</td>
    <td class="source"> if (k === 'addr' || k === 'length') {</td>
</tr>
<tr class="hit">
    <td class="line">241</td>
    <td class="hits">1</td>
    <td class="source"> continue;</td>
</tr>
<tr>
    <td class="line">242</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">243</td>
    <td class="hits">1</td>
    <td class="source"> var realkeys = [];</td>
</tr>
<tr class="hit">
    <td class="line">244</td>
    <td class="hits">1</td>
    <td class="source"> for (var i = 0; i &lt; _packets[k].length; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">245</td>
    <td class="hits">4</td>
    <td class="source"> realkeys.push(_packets[k][i]);</td>
</tr>
<tr>
    <td class="line">246</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">247</td>
    <td class="hits">1</td>
    <td class="source"> var _buf = packet.requestMGetPacket(_namespace, realkeys);</td>
</tr>
<tr class="hit">
    <td class="line">248</td>
    <td class="hits">1</td>
    <td class="source"> comm.getData(_packets[k].addr, _buf, function (err, data, len) {</td>
</tr>
<tr class="hit">
    <td class="line">249</td>
    <td class="hits">1</td>
    <td class="source"> if (err) {</td>
</tr>
<tr class="miss">
    <td class="line">250</td>
    <td class="hits">0</td>
    <td class="source"> retCount++;</td>
</tr>
<tr class="miss">
    <td class="line">251</td>
    <td class="hits">0</td>
    <td class="source"> if (retCount === _packets.length) {</td>
</tr>
<tr class="miss">
    <td class="line">252</td>
    <td class="hits">0</td>
    <td class="source"> return callback(null, returned);</td>
</tr>
<tr>
    <td class="line">253</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="miss">
    <td class="line">254</td>
    <td class="hits">0</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">255</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">256</td>
    <td class="hits">1</td>
    <td class="source"> var ret = packet.responseMGetPacket(data) || {};</td>
</tr>
<tr class="hit">
    <td class="line">257</td>
    <td class="hits">1</td>
    <td class="source"> ret.count = ret.count || 0;</td>
</tr>
<tr class="hit">
    <td class="line">258</td>
    <td class="hits">1</td>
    <td class="source"> for (var j = 0; j &lt; ret.count; j++) {</td>
</tr>
<tr class="hit">
    <td class="line">259</td>
    <td class="hits">3</td>
    <td class="source"> returned[ret.keys[j]] = ret.values[j];</td>
</tr>
<tr class="hit">
    <td class="line">260</td>
    <td class="hits">3</td>
    <td class="source"> itemCount++;</td>
</tr>
<tr>
    <td class="line">261</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">262</td>
    <td class="hits">1</td>
    <td class="source"> retCount++;</td>
</tr>
<tr class="hit">
    <td class="line">263</td>
    <td class="hits">1</td>
    <td class="source"> if (retCount === _packets.length) {</td>
</tr>
<tr class="hit">
    <td class="line">264</td>
    <td class="hits">1</td>
    <td class="source"> returned.length = itemCount;</td>
</tr>
<tr class="hit">
    <td class="line">265</td>
    <td class="hits">1</td>
    <td class="source"> return callback(null, returned);</td>
</tr>
<tr>
    <td class="line">266</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">267</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr>
    <td class="line">268</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">269</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">270</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">271</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">272</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">273</td>
    <td class="hits"></td>
    <td class="source"> * remove method</td>
</tr>
<tr>
    <td class="line">274</td>
    <td class="hits"></td>
    <td class="source"> * @type {Function}</td>
</tr>
<tr>
    <td class="line">275</td>
    <td class="hits"></td>
    <td class="source"> * @params key&#239;&#188;&#154;must be string, the key to remove</td>
</tr>
<tr>
    <td class="line">276</td>
    <td class="hits"></td>
    <td class="source"> * @params namespace: the area(namespace) of data, number 0~1023, optional,
        default is 0
    </td>
</tr>
<tr>
    <td class="line">277</td>
    <td class="hits"></td>
    <td class="source"> * @params callback(err):</td>
</tr>
<tr>
    <td class="line">278</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr class="hit">
    <td class="line">279</td>
    <td class="hits">1</td>
    <td class="source">Tair.prototype.remove = Tair.prototype.delete = function (key, namespace,
        callback) {
    </td>
</tr>
<tr>
    <td class="line">280</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">281</td>
    <td class="hits">4</td>
    <td class="source"> var _namespace = typeof namespace === 'number' ? namespace : 0;</td>
</tr>
<tr class="hit">
    <td class="line">282</td>
    <td class="hits">4</td>
    <td class="source"> if (typeof namespace === 'function') {</td>
</tr>
<tr class="hit">
    <td class="line">283</td>
    <td class="hits">4</td>
    <td class="source"> callback = namespace;</td>
</tr>
<tr>
    <td class="line">284</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">285</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">286</td>
    <td class="hits">4</td>
    <td class="source"> if (!key || key.length === 0 || typeof key !== 'string') {</td>
</tr>
<tr class="miss">
    <td class="line">287</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: params lack.'), false);</td>
</tr>
<tr>
    <td class="line">288</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">289</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">290</td>
    <td class="hits">4</td>
    <td class="source"> if (!this.inited) {</td>
</tr>
<tr>
    <td class="line">291</td>
    <td class="hits"></td>
    <td class="source"> //console.warn('Tair: client not init');</td>
</tr>
<tr class="hit">
    <td class="line">292</td>
    <td class="hits">1</td>
    <td class="source"> this.requestQueue.push({method: 'remove', args:
        Array.prototype.slice.apply(arguments), that: this});
    </td>
</tr>
<tr class="hit">
    <td class="line">293</td>
    <td class="hits">1</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">294</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">295</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">296</td>
    <td class="hits">3</td>
    <td class="source"> var _packet = packet.requestGetOrRemovePacket(_namespace, key, true);</td>
</tr>
<tr>
    <td class="line">297</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">298</td>
    <td class="hits">3</td>
    <td class="source"> var _addr = this.getDataNode(key);</td>
</tr>
<tr class="hit">
    <td class="line">299</td>
    <td class="hits">3</td>
    <td class="source"> if (!_addr.success) {</td>
</tr>
<tr class="miss">
    <td class="line">300</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: find datanode error'), false);</td>
</tr>
<tr>
    <td class="line">301</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">302</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">303</td>
    <td class="hits">3</td>
    <td class="source"> comm.getData(_addr, _packet, function (err, data, len) {</td>
</tr>
<tr class="hit">
    <td class="line">304</td>
    <td class="hits">4</td>
    <td class="source"> if (err) {</td>
</tr>
<tr class="hit">
    <td class="line">305</td>
    <td class="hits">1</td>
    <td class="source"> return callback(err, false);</td>
</tr>
<tr>
    <td class="line">306</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">307</td>
    <td class="hits">3</td>
    <td class="source"> var returned = packet.returnPacket(data);</td>
</tr>
<tr class="hit">
    <td class="line">308</td>
    <td class="hits">3</td>
    <td class="source"> if (returned.code !== 0) {</td>
</tr>
<tr class="miss">
    <td class="line">309</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair Error: Code ' + returned.code));</td>
</tr>
<tr>
    <td class="line">310</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">311</td>
    <td class="hits">3</td>
    <td class="source"> return callback(null);</td>
</tr>
<tr>
    <td class="line">312</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr>
    <td class="line">313</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">314</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">315</td>
    <td class="hits">1</td>
    <td class="source">function incDec (key, count, namespace, initValue, expire, callback) {</td>
</tr>
<tr class="hit">
    <td class="line">316</td>
    <td class="hits">3</td>
    <td class="source"> if (!key || key.length === 0) {</td>
</tr>
<tr class="miss">
    <td class="line">317</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: params lack.'));</td>
</tr>
<tr>
    <td class="line">318</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">319</td>
    <td class="hits">3</td>
    <td class="source"> if (!this.inited) {</td>
</tr>
<tr>
    <td class="line">320</td>
    <td class="hits"></td>
    <td class="source"> //console.warn('Tair: client not init');</td>
</tr>
<tr class="miss">
    <td class="line">321</td>
    <td class="hits">0</td>
    <td class="source"> this.requestQueue.push({method: 'incDec', args:
        Array.prototype.slice.apply(arguments), that: this});
    </td>
</tr>
<tr class="miss">
    <td class="line">322</td>
    <td class="hits">0</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">323</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">324</td>
    <td class="hits">3</td>
    <td class="source"> if (key.length &gt;= consts.NAMESPACE_MAX) {</td>
</tr>
<tr class="miss">
    <td class="line">325</td>
    <td class="hits">0</td>
    <td class="source"> return callback(null, null);</td>
</tr>
<tr>
    <td class="line">326</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">327</td>
    <td class="hits">3</td>
    <td class="source"> var _namespace = typeof namespace === 'number' ? namespace : 0;</td>
</tr>
<tr class="hit">
    <td class="line">328</td>
    <td class="hits">3</td>
    <td class="source"> var _count = typeof count === 'number' ? count : 0;</td>
</tr>
<tr class="hit">
    <td class="line">329</td>
    <td class="hits">3</td>
    <td class="source"> var _initValue = typeof initValue === 'number' ? initValue : 0;</td>
</tr>
<tr class="hit">
    <td class="line">330</td>
    <td class="hits">3</td>
    <td class="source"> var _expire = typeof expire === 'number' ? expire : 0;</td>
</tr>
<tr class="hit">
    <td class="line">331</td>
    <td class="hits">3</td>
    <td class="source"> if (typeof count === 'function') {</td>
</tr>
<tr class="miss">
    <td class="line">332</td>
    <td class="hits">0</td>
    <td class="source"> callback = count;</td>
</tr>
<tr>
    <td class="line">333</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">334</td>
    <td class="hits">3</td>
    <td class="source"> if (typeof namespace === 'function') {</td>
</tr>
<tr class="hit">
    <td class="line">335</td>
    <td class="hits">3</td>
    <td class="source"> callback = namespace;</td>
</tr>
<tr>
    <td class="line">336</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">337</td>
    <td class="hits">3</td>
    <td class="source"> if (typeof initValue === 'function') {</td>
</tr>
<tr class="miss">
    <td class="line">338</td>
    <td class="hits">0</td>
    <td class="source"> callback = initValue;</td>
</tr>
<tr>
    <td class="line">339</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">340</td>
    <td class="hits">3</td>
    <td class="source"> if (typeof expire === 'function') {</td>
</tr>
<tr class="miss">
    <td class="line">341</td>
    <td class="hits">0</td>
    <td class="source"> callback = expire;</td>
</tr>
<tr>
    <td class="line">342</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">343</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">344</td>
    <td class="hits">3</td>
    <td class="source"> var _packet = packet.requestIncDecPacket(_namespace, key, _count, _initValue,
        _expire);
    </td>
</tr>
<tr class="hit">
    <td class="line">345</td>
    <td class="hits">3</td>
    <td class="source"> var _addr = this.getDataNode(key);</td>
</tr>
<tr class="hit">
    <td class="line">346</td>
    <td class="hits">3</td>
    <td class="source"> if (!_addr.success) {</td>
</tr>
<tr class="miss">
    <td class="line">347</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: find datanode error'), false);</td>
</tr>
<tr>
    <td class="line">348</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">349</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">350</td>
    <td class="hits">3</td>
    <td class="source"> comm.getData(_addr, _packet, function (err, data, len) {</td>
</tr>
<tr class="hit">
    <td class="line">351</td>
    <td class="hits">3</td>
    <td class="source"> if (err) {</td>
</tr>
<tr class="miss">
    <td class="line">352</td>
    <td class="hits">0</td>
    <td class="source"> return callback(err, false);</td>
</tr>
<tr>
    <td class="line">353</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">354</td>
    <td class="hits">3</td>
    <td class="source"> var returned = packet.returnPacket(data);</td>
</tr>
<tr class="hit">
    <td class="line">355</td>
    <td class="hits">3</td>
    <td class="source"> if (returned.code &lt; 0) {</td>
</tr>
<tr class="miss">
    <td class="line">356</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair Error: Code ' + returned.code));</td>
</tr>
<tr>
    <td class="line">357</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">358</td>
    <td class="hits">3</td>
    <td class="source"> return callback(null, returned.code);</td>
</tr>
<tr>
    <td class="line">359</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr>
    <td class="line">360</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">361</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">362</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">363</td>
    <td class="hits"></td>
    <td class="source"> * incr / decr method</td>
</tr>
<tr>
    <td class="line">364</td>
    <td class="hits"></td>
    <td class="source"> * @type {Function}</td>
</tr>
<tr>
    <td class="line">365</td>
    <td class="hits"></td>
    <td class="source"> * @params key&#239;&#188;&#154;must be string, the key to remove</td>
</tr>
<tr>
    <td class="line">366</td>
    <td class="hits"></td>
    <td class="source"> * @params count: amount to plus or minus, usually be positive number</td>
</tr>
<tr>
    <td class="line">367</td>
    <td class="hits"></td>
    <td class="source"> * @params namespace: the area(namespace) of data, number 0~1023, optional,
        default is 0
    </td>
</tr>
<tr>
    <td class="line">368</td>
    <td class="hits"></td>
    <td class="source"> * @params initValue: if key is not exist, give it a value</td>
</tr>
<tr>
    <td class="line">369</td>
    <td class="hits"></td>
    <td class="source"> * @params expire: if key is not exist, the new value`s expire(seconds)</td>
</tr>
<tr>
    <td class="line">370</td>
    <td class="hits"></td>
    <td class="source"> * @params callback(err, data):</td>
</tr>
<tr>
    <td class="line">371</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr class="hit">
    <td class="line">372</td>
    <td class="hits">1</td>
    <td class="source">Tair.prototype.incr = function (key, count, namespace, initValue, expire,
        callback) {
    </td>
</tr>
<tr class="hit">
    <td class="line">373</td>
    <td class="hits">2</td>
    <td class="source"> count = count || 0;</td>
</tr>
<tr class="hit">
    <td class="line">374</td>
    <td class="hits">2</td>
    <td class="source"> return incDec.apply(this, [key, count, namespace, initValue, expire,
        callback]);
    </td>
</tr>
<tr>
    <td class="line">375</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr class="hit">
    <td class="line">376</td>
    <td class="hits">1</td>
    <td class="source">Tair.prototype.decr = function (key, count, namespace, initValue, expire,
        callback) {
    </td>
</tr>
<tr class="hit">
    <td class="line">377</td>
    <td class="hits">1</td>
    <td class="source"> count = count || 0;</td>
</tr>
<tr class="hit">
    <td class="line">378</td>
    <td class="hits">1</td>
    <td class="source"> return incDec.apply(this, [key, -count, namespace, initValue, expire,
        callback]);
    </td>
</tr>
<tr>
    <td class="line">379</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
</tbody>
</table>
</div>
<div class="file"><h2 id="configServer.js">configServer.js</h2>

<div id="stats" class="high">
    <div class="percentage">80%</div>
    <div class="sloc">97</div>
    <div class="hits">78</div>
    <div class="misses">19</div>
</div>
<table id="source">
<thead>
<tr>
    <th>Line</th>
    <th>Hits</th>
    <th>Source</th>
</tr>
</thead>
<tbody>
<tr>
    <td class="line">1</td>
    <td class="hits"></td>
    <td class="source">/*!</td>
</tr>
<tr>
    <td class="line">2</td>
    <td class="hits"></td>
    <td class="source"> * tair - lib/configServer.js</td>
</tr>
<tr>
    <td class="line">3</td>
    <td class="hits"></td>
    <td class="source"> * Copyright(c) 2012 Taobao.com</td>
</tr>
<tr>
    <td class="line">4</td>
    <td class="hits"></td>
    <td class="source"> * Author: kate.sf &lt;kate.sf@taobao.com&gt;</td>
</tr>
<tr>
    <td class="line">5</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">6</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">7</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">8</td>
    <td class="hits"></td>
    <td class="source"> * configServer module</td>
</tr>
<tr>
    <td class="line">9</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">10</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">11</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">12</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">13</td>
    <td class="hits">1</td>
    <td class="source">var packet = require('./packet');</td>
</tr>
<tr class="hit">
    <td class="line">14</td>
    <td class="hits">1</td>
    <td class="source">var utils = require('./utils');</td>
</tr>
<tr class="hit">
    <td class="line">15</td>
    <td class="hits">1</td>
    <td class="source">var encode = require('./transcoder').encode;</td>
</tr>
<tr class="hit">
    <td class="line">16</td>
    <td class="hits">1</td>
    <td class="source">var getData = require('./comm').getData;</td>
</tr>
<tr>
    <td class="line">17</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">18</td>
    <td class="hits">1</td>
    <td class="source">var MURMURHASH_M = 0x5bd1e995;</td>
</tr>
<tr class="hit">
    <td class="line">19</td>
    <td class="hits">1</td>
    <td class="source">var debug = false;</td>
</tr>
<tr>
    <td class="line">20</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">21</td>
    <td class="hits">1</td>
    <td class="source">exports.retrieveConfigure = function (groupName, configVersion, configServerList,
        callback, configServerIndex) {
    </td>
</tr>
<tr>
    <td class="line">22</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">23</td>
    <td class="hits">7</td>
    <td class="source"> configServerIndex = configServerIndex || 0;</td>
</tr>
<tr class="hit">
    <td class="line">24</td>
    <td class="hits">7</td>
    <td class="source"> if (configServerIndex &gt; configServerList.length - 1) {</td>
</tr>
<tr class="hit">
    <td class="line">25</td>
    <td class="hits">1</td>
    <td class="source"> configServerIndex = configServerList.length - 1;</td>
</tr>
<tr>
    <td class="line">26</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">27</td>
    <td class="hits">7</td>
    <td class="source"> this.bucketCount = 0;</td>
</tr>
<tr class="hit">
    <td class="line">28</td>
    <td class="hits">7</td>
    <td class="source"> this.copyCount = 0;</td>
</tr>
<tr class="hit">
    <td class="line">29</td>
    <td class="hits">7</td>
    <td class="source"> this.aliveNodes = [];</td>
</tr>
<tr class="hit">
    <td class="line">30</td>
    <td class="hits">7</td>
    <td class="source"> this.serverList = [];</td>
</tr>
<tr class="hit">
    <td class="line">31</td>
    <td class="hits">7</td>
    <td class="source"> this.configVersion = 0;</td>
</tr>
<tr>
    <td class="line">32</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">33</td>
    <td class="hits">7</td>
    <td class="source"> var addr = configServerList[configServerIndex];</td>
</tr>
<tr>
    <td class="line">34</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">35</td>
    <td class="hits">7</td>
    <td class="source"> var reqGetGroup = packet.requestGetGroupPacket(groupName, configVersion);</td>
</tr>
<tr class="hit">
    <td class="line">36</td>
    <td class="hits">7</td>
    <td class="source"> var that = this;</td>
</tr>
<tr class="hit">
    <td class="line">37</td>
    <td class="hits">7</td>
    <td class="source"> getData(addr, reqGetGroup, function (err, data) {</td>
</tr>
<tr class="hit">
    <td class="line">38</td>
    <td class="hits">8</td>
    <td class="source"> if (err || !data) {</td>
</tr>
<tr class="hit">
    <td class="line">39</td>
    <td class="hits">3</td>
    <td class="source"> if (configServerIndex &gt; configServerList.length - 1) {</td>
</tr>
<tr class="miss">
    <td class="line">40</td>
    <td class="hits">0</td>
    <td class="source"> return callback(err);</td>
</tr>
<tr>
    <td class="line">41</td>
    <td class="hits"></td>
    <td class="source"> } else {</td>
</tr>
<tr class="hit">
    <td class="line">42</td>
    <td class="hits">3</td>
    <td class="source"> configServerIndex++;</td>
</tr>
<tr class="hit">
    <td class="line">43</td>
    <td class="hits">3</td>
    <td class="source"> return exports.retrieveConfigure.apply(that, [groupName, configVersion,
        configServerList, callback, configServerIndex]);
    </td>
</tr>
<tr>
    <td class="line">44</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">45</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">46</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">47</td>
    <td class="hits">5</td>
    <td class="source"> packet.responseGetGroupPacket(data, function (err, res) {</td>
</tr>
<tr class="hit">
    <td class="line">48</td>
    <td class="hits">5</td>
    <td class="source"> if (err) {</td>
</tr>
<tr class="miss">
    <td class="line">49</td>
    <td class="hits">0</td>
    <td class="source"> if (configServerIndex &gt;= configServerList.length - 1) {</td>
</tr>
<tr class="miss">
    <td class="line">50</td>
    <td class="hits">0</td>
    <td class="source"> return callback(err);</td>
</tr>
<tr>
    <td class="line">51</td>
    <td class="hits"></td>
    <td class="source"> } else {</td>
</tr>
<tr class="miss">
    <td class="line">52</td>
    <td class="hits">0</td>
    <td class="source"> configServerIndex++;</td>
</tr>
<tr class="miss">
    <td class="line">53</td>
    <td class="hits">0</td>
    <td class="source"> return exports.retrieveConfigure.apply(that, [groupName, configVersion,
        configServerList, callback, configServerIndex]);
    </td>
</tr>
<tr>
    <td class="line">54</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">55</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">56</td>
    <td class="hits">5</td>
    <td class="source"> that.configVersion = res.configVersion;</td>
</tr>
<tr class="hit">
    <td class="line">57</td>
    <td class="hits">5</td>
    <td class="source"> that.bucketCount = res.bucketCount;</td>
</tr>
<tr class="hit">
    <td class="line">58</td>
    <td class="hits">5</td>
    <td class="source"> that.copyCount = res.copyCount;</td>
</tr>
<tr class="hit">
    <td class="line">59</td>
    <td class="hits">5</td>
    <td class="source"> that.aliveNodes = res.aliveNode;</td>
</tr>
<tr class="hit">
    <td class="line">60</td>
    <td class="hits">5</td>
    <td class="source"> that.serverList = res.serverList;</td>
</tr>
<tr>
    <td class="line">61</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">62</td>
    <td class="hits">5</td>
    <td class="source"> if (!that.aliveNodes || that.aliveNodes.length === 0) {</td>
</tr>
<tr class="miss">
    <td class="line">63</td>
    <td class="hits">0</td>
    <td class="source"> if (configServerIndex &gt;= configServerList.length - 1) {</td>
</tr>
<tr class="miss">
    <td class="line">64</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: fatal error, no datanode is alive'));</td>
</tr>
<tr>
    <td class="line">65</td>
    <td class="hits"></td>
    <td class="source"> } else {</td>
</tr>
<tr class="miss">
    <td class="line">66</td>
    <td class="hits">0</td>
    <td class="source"> configServerIndex++;</td>
</tr>
<tr class="miss">
    <td class="line">67</td>
    <td class="hits">0</td>
    <td class="source"> return exports.retrieveConfigure.apply(that, [groupName, configVersion,
        configServerList, callback, configServerIndex]);
    </td>
</tr>
<tr>
    <td class="line">68</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">69</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">70</td>
    <td class="hits">5</td>
    <td class="source"> if (that.bucketCount &lt;= 0 || that.copyCount &lt;= 0) {</td>
</tr>
<tr class="miss">
    <td class="line">71</td>
    <td class="hits">0</td>
    <td class="source"> if (configServerIndex &gt;= configServerList.length - 1) {</td>
</tr>
<tr class="miss">
    <td class="line">72</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: bucket count or copy count can not be 0'));
    </td>
</tr>
<tr>
    <td class="line">73</td>
    <td class="hits"></td>
    <td class="source"> } else {</td>
</tr>
<tr class="miss">
    <td class="line">74</td>
    <td class="hits">0</td>
    <td class="source"> configServerIndex++;</td>
</tr>
<tr class="miss">
    <td class="line">75</td>
    <td class="hits">0</td>
    <td class="source"> return exports.retrieveConfigure.apply(that, [groupName, configVersion,
        configServerList, callback, configServerIndex]);
    </td>
</tr>
<tr>
    <td class="line">76</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">77</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">78</td>
    <td class="hits"></td>
    <td class="source">// if (debug) {</td>
</tr>
<tr>
    <td class="line">79</td>
    <td class="hits"></td>
    <td class="source">// console.log('configversion: ' + exports.configVersion);</td>
</tr>
<tr>
    <td class="line">80</td>
    <td class="hits"></td>
    <td class="source">// console.log(res.configMap);</td>
</tr>
<tr>
    <td class="line">81</td>
    <td class="hits"></td>
    <td class="source">// console.log('bucketCount: ' + exports.bucketCount);</td>
</tr>
<tr>
    <td class="line">82</td>
    <td class="hits"></td>
    <td class="source">// console.log('copyCount: ' + exports.copyCount);</td>
</tr>
<tr>
    <td class="line">83</td>
    <td class="hits"></td>
    <td class="source">// for (var ai in res.aliveNode)</td>
</tr>
<tr>
    <td class="line">84</td>
    <td class="hits"></td>
    <td class="source">// console.log('aliveNode: ' + ai);</td>
</tr>
<tr>
    <td class="line">85</td>
    <td class="hits"></td>
    <td class="source">// console.log('first in serverList: ' + exports.serverList[0][0].host + ':' +
        exports.serverList[0][0].port);
    </td>
</tr>
<tr>
    <td class="line">86</td>
    <td class="hits"></td>
    <td class="source">// }</td>
</tr>
<tr>
    <td class="line">87</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">88</td>
    <td class="hits">5</td>
    <td class="source"> return callback(null, res);</td>
</tr>
<tr>
    <td class="line">89</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr>
    <td class="line">90</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr>
    <td class="line">91</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">92</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">93</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">94</td>
    <td class="hits">1</td>
    <td class="source">exports.getDataNode = function (key, isRead) {</td>
</tr>
<tr class="hit">
    <td class="line">95</td>
    <td class="hits">27</td>
    <td class="source"> if (this.serverList == null || this.serverList.length === 0) {</td>
</tr>
<tr class="hit">
    <td class="line">96</td>
    <td class="hits">1</td>
    <td class="source"> console.error(&quot;Tair: DataNode Server list is empty!&quot;);</td>
</tr>
<tr class="hit">
    <td class="line">97</td>
    <td class="hits">1</td>
    <td class="source"> return 0;</td>
</tr>
<tr>
    <td class="line">98</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">99</td>
    <td class="hits">26</td>
    <td class="source"> var serverIdx = findServerIdx.apply(this, [encode(key, 'utf-8', false)]);</td>
</tr>
<tr class="hit">
    <td class="line">100</td>
    <td class="hits">26</td>
    <td class="source"> var serverIp = 0;</td>
</tr>
<tr class="hit">
    <td class="line">101</td>
    <td class="hits">26</td>
    <td class="source"> var i = 0;</td>
</tr>
<tr class="hit">
    <td class="line">102</td>
    <td class="hits">26</td>
    <td class="source"> serverIp = this.serverList[i][serverIdx] ? this.serverList[i][serverIdx].host :
        0;
    </td>
</tr>
<tr class="hit">
    <td class="line">103</td>
    <td class="hits">26</td>
    <td class="source"> serverIp &gt;&gt;&gt;= 0;</td>
</tr>
<tr class="hit">
    <td class="line">104</td>
    <td class="hits">26</td>
    <td class="source"> if (!this.aliveNodes[serverIp]) {</td>
</tr>
<tr class="hit">
    <td class="line">105</td>
    <td class="hits">1</td>
    <td class="source"> serverIp = 0;</td>
</tr>
<tr class="hit">
    <td class="line">106</td>
    <td class="hits">1</td>
    <td class="source"> console.log(&quot;Tair: master server &quot; + utils.longToIP(serverIp) + &quot;
        had down&quot;);
    </td>
</tr>
<tr>
    <td class="line">107</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">108</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">109</td>
    <td class="hits">26</td>
    <td class="source"> if (serverIp == 0 &amp;&amp; isRead) {</td>
</tr>
<tr class="hit">
    <td class="line">110</td>
    <td class="hits">1</td>
    <td class="source"> for (i = 1; i &lt; this.copyCount; ++i) {</td>
</tr>
<tr class="miss">
    <td class="line">111</td>
    <td class="hits">0</td>
    <td class="source"> serverIp = this.serverList[i][serverIdx] ? this.serverList[i][serverIdx].host :
        0;
    </td>
</tr>
<tr class="miss">
    <td class="line">112</td>
    <td class="hits">0</td>
    <td class="source"> console.log(&quot;Tair: read operation try: &quot; +
        utils.longToIP(serverIp));
    </td>
</tr>
<tr class="miss">
    <td class="line">113</td>
    <td class="hits">0</td>
    <td class="source"> if (this.aliveNodes[serverIp]) {</td>
</tr>
<tr class="miss">
    <td class="line">114</td>
    <td class="hits">0</td>
    <td class="source"> break;</td>
</tr>
<tr>
    <td class="line">115</td>
    <td class="hits"></td>
    <td class="source"> } else {</td>
</tr>
<tr class="miss">
    <td class="line">116</td>
    <td class="hits">0</td>
    <td class="source"> serverIp = 0;</td>
</tr>
<tr>
    <td class="line">117</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">118</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">119</td>
    <td class="hits">1</td>
    <td class="source"> if (serverIp == 0) {</td>
</tr>
<tr class="hit">
    <td class="line">120</td>
    <td class="hits">1</td>
    <td class="source"> console.error(&quot;Tair Error: slave servers also&quot; + &quot; had down&quot;);</td>
</tr>
<tr>
    <td class="line">121</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">122</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">123</td>
    <td class="hits">26</td>
    <td class="source"> if (serverIp == 0) {</td>
</tr>
<tr class="hit">
    <td class="line">124</td>
    <td class="hits">1</td>
    <td class="source"> return 0;</td>
</tr>
<tr>
    <td class="line">125</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">126</td>
    <td class="hits">25</td>
    <td class="source"> return {host: utils.longToIP(serverIp), port:
        this.serverList[i][serverIdx].port, success: (serverIp !== 0)};
    </td>
</tr>
<tr>
    <td class="line">127</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">128</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">129</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">130</td>
    <td class="hits">1</td>
    <td class="source">function findServerIdx (keyByte) {</td>
</tr>
<tr class="hit">
    <td class="line">131</td>
    <td class="hits">26</td>
    <td class="source"> var hash = murmurhash2(keyByte); // cast to int is safe</td>
</tr>
<tr>
    <td class="line">132</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">133</td>
    <td class="hits">26</td>
    <td class="source"> if ((this.serverList) &amp;&amp; (this.serverList.length &gt; 0)) {</td>
</tr>
<tr class="hit">
    <td class="line">134</td>
    <td class="hits">26</td>
    <td class="source"> return parseInt(hash %= this.bucketCount, 10);</td>
</tr>
<tr>
    <td class="line">135</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="miss">
    <td class="line">136</td>
    <td class="hits">0</td>
    <td class="source"> return 0;</td>
</tr>
<tr>
    <td class="line">137</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">138</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">139</td>
    <td class="hits">1</td>
    <td class="source">function murmurhash2 (_str) {</td>
</tr>
<tr class="hit">
    <td class="line">140</td>
    <td class="hits">26</td>
    <td class="source"> var l = _str.length + 1,</td>
</tr>
<tr>
    <td class="line">141</td>
    <td class="hits"></td>
    <td class="source"> h = 97 ^ l,</td>
</tr>
<tr>
    <td class="line">142</td>
    <td class="hits"></td>
    <td class="source"> i = 0,</td>
</tr>
<tr>
    <td class="line">143</td>
    <td class="hits"></td>
    <td class="source"> k;</td>
</tr>
<tr>
    <td class="line">144</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">145</td>
    <td class="hits">26</td>
    <td class="source"> var str = new Buffer(l);</td>
</tr>
<tr class="hit">
    <td class="line">146</td>
    <td class="hits">26</td>
    <td class="source"> _str.copy(str);</td>
</tr>
<tr class="hit">
    <td class="line">147</td>
    <td class="hits">26</td>
    <td class="source"> str[l - 1] = 0;</td>
</tr>
<tr>
    <td class="line">148</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">149</td>
    <td class="hits">26</td>
    <td class="source"> while (l &gt;= 4) {</td>
</tr>
<tr class="hit">
    <td class="line">150</td>
    <td class="hits">61</td>
    <td class="source"> k =</td>
</tr>
<tr>
    <td class="line">151</td>
    <td class="hits"></td>
    <td class="source"> ((str[i] &amp; 0xff)) |</td>
</tr>
<tr>
    <td class="line">152</td>
    <td class="hits"></td>
    <td class="source"> ((str[++i] &amp; 0xff) &lt;&lt; 8) |</td>
</tr>
<tr>
    <td class="line">153</td>
    <td class="hits"></td>
    <td class="source"> ((str[++i] &amp; 0xff) &lt;&lt; 16) |</td>
</tr>
<tr>
    <td class="line">154</td>
    <td class="hits"></td>
    <td class="source"> ((str[++i] &amp; 0xff) &lt;&lt; 24);</td>
</tr>
<tr>
    <td class="line">155</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">156</td>
    <td class="hits">61</td>
    <td class="source"> k = (((k &amp; 0xffff) * MURMURHASH_M) + ((((k &gt;&gt;&gt; 16) * MURMURHASH_M)
        &amp; 0xffff) &lt;&lt; 16));
    </td>
</tr>
<tr class="hit">
    <td class="line">157</td>
    <td class="hits">61</td>
    <td class="source"> k ^= k &gt;&gt;&gt; 24;</td>
</tr>
<tr class="hit">
    <td class="line">158</td>
    <td class="hits">61</td>
    <td class="source"> k = (((k &amp; 0xffff) * MURMURHASH_M) + ((((k &gt;&gt;&gt; 16) * MURMURHASH_M)
        &amp; 0xffff) &lt;&lt; 16));
    </td>
</tr>
<tr>
    <td class="line">159</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">160</td>
    <td class="hits">61</td>
    <td class="source"> h = (((h &amp; 0xffff) * MURMURHASH_M) + ((((h &gt;&gt;&gt; 16) * MURMURHASH_M)
        &amp; 0xffff) &lt;&lt; 16)) ^ k;
    </td>
</tr>
<tr>
    <td class="line">161</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">162</td>
    <td class="hits">61</td>
    <td class="source"> l -= 4;</td>
</tr>
<tr class="hit">
    <td class="line">163</td>
    <td class="hits">61</td>
    <td class="source"> ++i;</td>
</tr>
<tr>
    <td class="line">164</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">165</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">166</td>
    <td class="hits">26</td>
    <td class="source"> switch (l) {</td>
</tr>
<tr>
    <td class="line">167</td>
    <td class="hits"></td>
    <td class="source"> case 3:</td>
</tr>
<tr class="hit">
    <td class="line">168</td>
    <td class="hits">13</td>
    <td class="source"> h ^= (str[i + 2] &amp; 0xff) &lt;&lt; 16;</td>
</tr>
<tr>
    <td class="line">169</td>
    <td class="hits"></td>
    <td class="source"> case 2:</td>
</tr>
<tr class="hit">
    <td class="line">170</td>
    <td class="hits">16</td>
    <td class="source"> h ^= (str[i + 1] &amp; 0xff) &lt;&lt; 8;</td>
</tr>
<tr>
    <td class="line">171</td>
    <td class="hits"></td>
    <td class="source"> case 1:</td>
</tr>
<tr class="hit">
    <td class="line">172</td>
    <td class="hits">23</td>
    <td class="source"> h ^= (str[i] &amp; 0xff);</td>
</tr>
<tr class="hit">
    <td class="line">173</td>
    <td class="hits">23</td>
    <td class="source"> h = (((h &amp; 0xffff) * MURMURHASH_M) + ((((h &gt;&gt;&gt; 16) * MURMURHASH_M)
        &amp; 0xffff) &lt;&lt; 16));
    </td>
</tr>
<tr>
    <td class="line">174</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">175</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">176</td>
    <td class="hits">26</td>
    <td class="source"> h ^= h &gt;&gt;&gt; 13;</td>
</tr>
<tr class="hit">
    <td class="line">177</td>
    <td class="hits">26</td>
    <td class="source"> h = (((h &amp; 0xffff) * MURMURHASH_M) + ((((h &gt;&gt;&gt; 16) * MURMURHASH_M)
        &amp; 0xffff) &lt;&lt; 16));
    </td>
</tr>
<tr class="hit">
    <td class="line">178</td>
    <td class="hits">26</td>
    <td class="source"> h ^= h &gt;&gt;&gt; 15;</td>
</tr>
<tr>
    <td class="line">179</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">180</td>
    <td class="hits">26</td>
    <td class="source"> return h &gt;&gt;&gt; 0;</td>
</tr>
<tr>
    <td class="line">181</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
</tbody>
</table>
</div>
<div class="file"><h2 id="packet.js">packet.js</h2>

<div id="stats" class="high">
    <div class="percentage">95%</div>
    <div class="sloc">272</div>
    <div class="hits">261</div>
    <div class="misses">11</div>
</div>
<table id="source">
<thead>
<tr>
    <th>Line</th>
    <th>Hits</th>
    <th>Source</th>
</tr>
</thead>
<tbody>
<tr>
    <td class="line">1</td>
    <td class="hits"></td>
    <td class="source">/*!</td>
</tr>
<tr>
    <td class="line">2</td>
    <td class="hits"></td>
    <td class="source"> * tair - lib/packet.js</td>
</tr>
<tr>
    <td class="line">3</td>
    <td class="hits"></td>
    <td class="source"> * Copyright(c) 2012 Taobao.com</td>
</tr>
<tr>
    <td class="line">4</td>
    <td class="hits"></td>
    <td class="source"> * Author: kate.sf &lt;kate.sf@taobao.com&gt;</td>
</tr>
<tr>
    <td class="line">5</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">6</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">7</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">8</td>
    <td class="hits"></td>
    <td class="source"> * network packet structure</td>
</tr>
<tr>
    <td class="line">9</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">10</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">11</td>
    <td class="hits">1</td>
    <td class="source">var consts = require('./const');</td>
</tr>
<tr class="hit">
    <td class="line">12</td>
    <td class="hits">1</td>
    <td class="source">var zlib = require('zlib');</td>
</tr>
<tr class="hit">
    <td class="line">13</td>
    <td class="hits">1</td>
    <td class="source">var utils = require('./utils');</td>
</tr>
<tr class="hit">
    <td class="line">14</td>
    <td class="hits">1</td>
    <td class="source">var transcoder = require('./transcoder');</td>
</tr>
<tr class="hit">
    <td class="line">15</td>
    <td class="hits">1</td>
    <td class="source">var printbuf = require('./comm').printBuffer;</td>
</tr>
<tr>
    <td class="line">16</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">17</td>
    <td class="hits">1</td>
    <td class="source">var chid = 1; //global channel id</td>
</tr>
<tr>
    <td class="line">18</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">19</td>
    <td class="hits">1</td>
    <td class="source">exports.writePacketBegin = function (pcode, capacity) {</td>
</tr>
<tr>
    <td class="line">20</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">21</td>
    <td class="hits">30</td>
    <td class="source"> capacity = capacity || 0;</td>
</tr>
<tr class="hit">
    <td class="line">22</td>
    <td class="hits">30</td>
    <td class="source"> chid++;</td>
</tr>
<tr>
    <td class="line">23</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">24</td>
    <td class="hits"></td>
    <td class="source"> // packet header</td>
</tr>
<tr class="hit">
    <td class="line">25</td>
    <td class="hits">30</td>
    <td class="source"> var byteBuffer = new Buffer(capacity + 16);</td>
</tr>
<tr class="hit">
    <td class="line">26</td>
    <td class="hits">30</td>
    <td class="source"> byteBuffer.fill();</td>
</tr>
<tr class="hit">
    <td class="line">27</td>
    <td class="hits">30</td>
    <td class="source"> byteBuffer.writeInt32BE(consts.TAIR_PACKET_FLAG, 0); // packet flag</td>
</tr>
<tr class="hit">
    <td class="line">28</td>
    <td class="hits">30</td>
    <td class="source"> byteBuffer.writeInt32BE(chid, 4); // channel id</td>
</tr>
<tr class="hit">
    <td class="line">29</td>
    <td class="hits">30</td>
    <td class="source"> byteBuffer.writeInt32BE(pcode, 8); // packet code</td>
</tr>
<tr class="hit">
    <td class="line">30</td>
    <td class="hits">30</td>
    <td class="source"> byteBuffer.writeInt32BE(capacity, 12); // body len</td>
</tr>
<tr class="hit">
    <td class="line">31</td>
    <td class="hits">30</td>
    <td class="source"> return [byteBuffer, 16];</td>
</tr>
<tr>
    <td class="line">32</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">33</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">34</td>
    <td class="hits">1</td>
    <td class="source">exports.writePacketEnd = function (byteBuffer, pos) {</td>
</tr>
<tr class="hit">
    <td class="line">35</td>
    <td class="hits">1</td>
    <td class="source"> byteBuffer.writeInt8(consts.TAIR_PACKET_HEADER_BLPOS, pos);</td>
</tr>
<tr>
    <td class="line">36</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">37</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">38</td>
    <td class="hits">1</td>
    <td class="source">exports.requestGetGroupPacket = function (groupName, configVersion) {</td>
</tr>
<tr class="hit">
    <td class="line">39</td>
    <td class="hits">8</td>
    <td class="source"> configVersion = configVersion || 0;</td>
</tr>
<tr class="hit">
    <td class="line">40</td>
    <td class="hits">8</td>
    <td class="source"> var ret = exports.writePacketBegin(consts.TAIR_REQ_GET_GROUP_NEW_PACKET, 9 +
        groupName.length);
    </td>
</tr>
<tr class="hit">
    <td class="line">41</td>
    <td class="hits">8</td>
    <td class="source"> var buf = ret[0], pos = ret[1];</td>
</tr>
<tr class="hit">
    <td class="line">42</td>
    <td class="hits">8</td>
    <td class="source"> buf.writeInt32BE(configVersion, pos);</td>
</tr>
<tr class="hit">
    <td class="line">43</td>
    <td class="hits">8</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">44</td>
    <td class="hits">8</td>
    <td class="source"> pos += writeString(buf, pos, groupName);</td>
</tr>
<tr class="hit">
    <td class="line">45</td>
    <td class="hits">8</td>
    <td class="source"> return buf;</td>
</tr>
<tr>
    <td class="line">46</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">47</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">48</td>
    <td class="hits">1</td>
    <td class="source">exports.responseGetGroupPacket = function (data, callback) {</td>
</tr>
<tr>
    <td class="line">49</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">50</td>
    <td class="hits">6</td>
    <td class="source"> if (!data) {</td>
</tr>
<tr class="hit">
    <td class="line">51</td>
    <td class="hits">1</td>
    <td class="source"> return callback(new Error('Tair: Config Server return Empty Data'));</td>
</tr>
<tr>
    <td class="line">52</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">53</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">54</td>
    <td class="hits">5</td>
    <td class="source"> var pos = 16;</td>
</tr>
<tr class="hit">
    <td class="line">55</td>
    <td class="hits">5</td>
    <td class="source"> var bucketCount = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">56</td>
    <td class="hits">5</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">57</td>
    <td class="hits">5</td>
    <td class="source"> var copyCount = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">58</td>
    <td class="hits">5</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">59</td>
    <td class="hits">5</td>
    <td class="source"> var configVersion = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">60</td>
    <td class="hits">5</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">61</td>
    <td class="hits">5</td>
    <td class="source"> var configCount = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">62</td>
    <td class="hits">5</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">63</td>
    <td class="hits">5</td>
    <td class="source"> var configMap = {};</td>
</tr>
<tr>
    <td class="line">64</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">65</td>
    <td class="hits">5</td>
    <td class="source"> for (var i = 0; i &lt; configCount; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">66</td>
    <td class="hits">5</td>
    <td class="source"> var name = readString(data, pos);</td>
</tr>
<tr class="hit">
    <td class="line">67</td>
    <td class="hits">5</td>
    <td class="source"> pos += name[1];</td>
</tr>
<tr>
    <td class="line">68</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">69</td>
    <td class="hits">5</td>
    <td class="source"> var value = readString(data, pos);</td>
</tr>
<tr class="hit">
    <td class="line">70</td>
    <td class="hits">5</td>
    <td class="source"> pos += value[1];</td>
</tr>
<tr class="hit">
    <td class="line">71</td>
    <td class="hits">5</td>
    <td class="source"> configMap[name[0]] = value[0];</td>
</tr>
<tr>
    <td class="line">72</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">73</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">74</td>
    <td class="hits">5</td>
    <td class="source"> var serverList = [];</td>
</tr>
<tr class="hit">
    <td class="line">75</td>
    <td class="hits">5</td>
    <td class="source"> var serverCountFlate = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">76</td>
    <td class="hits">5</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">77</td>
    <td class="hits">5</td>
    <td class="source"> if (serverCountFlate &gt; 0) {</td>
</tr>
<tr class="hit">
    <td class="line">78</td>
    <td class="hits">5</td>
    <td class="source"> var _buff = new Buffer(serverCountFlate);</td>
</tr>
<tr class="hit">
    <td class="line">79</td>
    <td class="hits">5</td>
    <td class="source"> data.copy(_buff, 0, pos, pos + serverCountFlate);</td>
</tr>
<tr class="hit">
    <td class="line">80</td>
    <td class="hits">5</td>
    <td class="source"> zlib.inflate(_buff, function (err, buffer) {</td>
</tr>
<tr class="hit">
    <td class="line">81</td>
    <td class="hits">5</td>
    <td class="source"> if (err) {</td>
</tr>
<tr class="miss">
    <td class="line">82</td>
    <td class="hits">0</td>
    <td class="source"> return callback(err);</td>
</tr>
<tr>
    <td class="line">83</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">84</td>
    <td class="hits">5</td>
    <td class="source"> pos += serverCountFlate;</td>
</tr>
<tr class="hit">
    <td class="line">85</td>
    <td class="hits">5</td>
    <td class="source"> var posTemp = 0;</td>
</tr>
<tr class="hit">
    <td class="line">86</td>
    <td class="hits">5</td>
    <td class="source"> var countTemp = 0;</td>
</tr>
<tr class="hit">
    <td class="line">87</td>
    <td class="hits">5</td>
    <td class="source"> var copyTemp = 0;</td>
</tr>
<tr class="hit">
    <td class="line">88</td>
    <td class="hits">5</td>
    <td class="source"> while (posTemp &lt; buffer.length) {</td>
</tr>
<tr class="hit">
    <td class="line">89</td>
    <td class="hits">5115</td>
    <td class="source"> if (countTemp === 0) {</td>
</tr>
<tr class="hit">
    <td class="line">90</td>
    <td class="hits">5</td>
    <td class="source"> serverList[copyTemp] = [];</td>
</tr>
<tr>
    <td class="line">91</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">92</td>
    <td class="hits">5115</td>
    <td class="source"> serverList[copyTemp].push({host: buffer.readInt32LE(posTemp) &gt;&gt;&gt; 0,
        port: buffer.readInt32LE(posTemp + 4)});
    </td>
</tr>
<tr class="hit">
    <td class="line">93</td>
    <td class="hits">5115</td>
    <td class="source"> posTemp += 8;</td>
</tr>
<tr class="hit">
    <td class="line">94</td>
    <td class="hits">5115</td>
    <td class="source"> countTemp++;</td>
</tr>
<tr class="hit">
    <td class="line">95</td>
    <td class="hits">5115</td>
    <td class="source"> if (countTemp === bucketCount) {</td>
</tr>
<tr class="hit">
    <td class="line">96</td>
    <td class="hits">5</td>
    <td class="source"> countTemp = 0;</td>
</tr>
<tr class="hit">
    <td class="line">97</td>
    <td class="hits">5</td>
    <td class="source"> copyTemp++;</td>
</tr>
<tr>
    <td class="line">98</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">99</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">100</td>
    <td class="hits">5</td>
    <td class="source"> var aNodeCount = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">101</td>
    <td class="hits">5</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">102</td>
    <td class="hits">5</td>
    <td class="source"> var aliveNode = {};</td>
</tr>
<tr class="hit">
    <td class="line">103</td>
    <td class="hits">5</td>
    <td class="source"> for (var i = 0; i &lt; aNodeCount; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">104</td>
    <td class="hits">10</td>
    <td class="source"> aliveNode[readLong(data, pos)] = true;</td>
</tr>
<tr class="hit">
    <td class="line">105</td>
    <td class="hits">10</td>
    <td class="source"> pos += 8;</td>
</tr>
<tr>
    <td class="line">106</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">107</td>
    <td class="hits">5</td>
    <td class="source"> var configServerRes = {</td>
</tr>
<tr>
    <td class="line">108</td>
    <td class="hits"></td>
    <td class="source"> configVersion: configVersion,</td>
</tr>
<tr>
    <td class="line">109</td>
    <td class="hits"></td>
    <td class="source"> bucketCount: bucketCount,</td>
</tr>
<tr>
    <td class="line">110</td>
    <td class="hits"></td>
    <td class="source"> copyCount: copyCount,</td>
</tr>
<tr>
    <td class="line">111</td>
    <td class="hits"></td>
    <td class="source"> configMap: configMap,</td>
</tr>
<tr>
    <td class="line">112</td>
    <td class="hits"></td>
    <td class="source"> serverList: serverList,</td>
</tr>
<tr>
    <td class="line">113</td>
    <td class="hits"></td>
    <td class="source"> aliveNode: aliveNode</td>
</tr>
<tr>
    <td class="line">114</td>
    <td class="hits"></td>
    <td class="source"> };</td>
</tr>
<tr>
    <td class="line">115</td>
    <td class="hits"></td>
    <td class="source"> //console.log(configServerRes);</td>
</tr>
<tr class="hit">
    <td class="line">116</td>
    <td class="hits">5</td>
    <td class="source"> return callback(null, configServerRes);</td>
</tr>
<tr>
    <td class="line">117</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr>
    <td class="line">118</td>
    <td class="hits"></td>
    <td class="source"> } else {</td>
</tr>
<tr class="miss">
    <td class="line">119</td>
    <td class="hits">0</td>
    <td class="source"> return callback(new Error('Tair: No Server'));</td>
</tr>
<tr>
    <td class="line">120</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">121</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">122</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">123</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">124</td>
    <td class="hits">1</td>
    <td class="source">exports.requestPutPacket = function (namespace, version, key, value, expire) {
    </td>
</tr>
<tr class="hit">
    <td class="line">125</td>
    <td class="hits">9</td>
    <td class="source"> var keyBuffer = transcoder.encode(key);</td>
</tr>
<tr class="hit">
    <td class="line">126</td>
    <td class="hits">9</td>
    <td class="source"> var valueBuffer = transcoder.encode(value);</td>
</tr>
<tr class="hit">
    <td class="line">127</td>
    <td class="hits">9</td>
    <td class="source"> var ret = exports.writePacketBegin(consts.TAIR_REQ_PUT_PACKET, 90 +
        keyBuffer.length + valueBuffer.length);
    </td>
</tr>
<tr class="hit">
    <td class="line">128</td>
    <td class="hits">9</td>
    <td class="source"> var pos = ret[1], packet = ret[0];</td>
</tr>
<tr>
    <td class="line">129</td>
    <td class="hits"></td>
    <td class="source"> //packet body begin</td>
</tr>
<tr class="hit">
    <td class="line">130</td>
    <td class="hits">9</td>
    <td class="source"> packet[pos] = 0;</td>
</tr>
<tr class="hit">
    <td class="line">131</td>
    <td class="hits">9</td>
    <td class="source"> pos++;</td>
</tr>
<tr class="hit">
    <td class="line">132</td>
    <td class="hits">9</td>
    <td class="source"> packet.writeInt16BE(namespace, pos);</td>
</tr>
<tr class="hit">
    <td class="line">133</td>
    <td class="hits">9</td>
    <td class="source"> pos += 2;</td>
</tr>
<tr class="hit">
    <td class="line">134</td>
    <td class="hits">9</td>
    <td class="source"> packet.writeInt16BE(version, pos);</td>
</tr>
<tr class="hit">
    <td class="line">135</td>
    <td class="hits">9</td>
    <td class="source"> pos += 2;</td>
</tr>
<tr class="hit">
    <td class="line">136</td>
    <td class="hits">9</td>
    <td class="source"> packet.writeInt32BE(expire, pos);</td>
</tr>
<tr class="hit">
    <td class="line">137</td>
    <td class="hits">9</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr>
    <td class="line">138</td>
    <td class="hits"></td>
    <td class="source"> //key</td>
</tr>
<tr class="hit">
    <td class="line">139</td>
    <td class="hits">9</td>
    <td class="source"> pos += fillMeta(packet, pos);</td>
</tr>
<tr class="hit">
    <td class="line">140</td>
    <td class="hits">9</td>
    <td class="source"> pos += encodeMeta(packet, pos, 0);</td>
</tr>
<tr class="hit">
    <td class="line">141</td>
    <td class="hits">9</td>
    <td class="source"> packet.writeInt32BE(keyBuffer.length + 1, pos);</td>
</tr>
<tr class="hit">
    <td class="line">142</td>
    <td class="hits">9</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">143</td>
    <td class="hits">9</td>
    <td class="source"> keyBuffer.copy(packet, pos, 0, keyBuffer.length);</td>
</tr>
<tr class="hit">
    <td class="line">144</td>
    <td class="hits">9</td>
    <td class="source"> pos += keyBuffer.length + 1;</td>
</tr>
<tr>
    <td class="line">145</td>
    <td class="hits"></td>
    <td class="source"> //value</td>
</tr>
<tr class="hit">
    <td class="line">146</td>
    <td class="hits">9</td>
    <td class="source"> pos += fillMeta(packet, pos);</td>
</tr>
<tr class="hit">
    <td class="line">147</td>
    <td class="hits">9</td>
    <td class="source"> pos += encodeMeta(packet, pos, 0);</td>
</tr>
<tr class="hit">
    <td class="line">148</td>
    <td class="hits">9</td>
    <td class="source"> packet.writeInt32BE(valueBuffer.length, pos);</td>
</tr>
<tr class="hit">
    <td class="line">149</td>
    <td class="hits">9</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">150</td>
    <td class="hits">9</td>
    <td class="source"> valueBuffer.copy(packet, pos, 0, valueBuffer.length);</td>
</tr>
<tr class="hit">
    <td class="line">151</td>
    <td class="hits">9</td>
    <td class="source"> pos += valueBuffer.length + 1;</td>
</tr>
<tr>
    <td class="line">152</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">153</td>
    <td class="hits">9</td>
    <td class="source"> return packet;</td>
</tr>
<tr>
    <td class="line">154</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">155</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">156</td>
    <td class="hits">1</td>
    <td class="source">exports.requestGetOrRemovePacket = function (namespace, key, remove) {</td>
</tr>
<tr class="hit">
    <td class="line">157</td>
    <td class="hits">9</td>
    <td class="source"> var keyBuffer = transcoder.encode(key);</td>
</tr>
<tr class="hit">
    <td class="line">158</td>
    <td class="hits">9</td>
    <td class="source"> if (!remove) {</td>
</tr>
<tr class="hit">
    <td class="line">159</td>
    <td class="hits">6</td>
    <td class="source"> var ret = exports.writePacketBegin(consts.TAIR_REQ_GET_PACKET, 48 +
        keyBuffer.length);
    </td>
</tr>
<tr>
    <td class="line">160</td>
    <td class="hits"></td>
    <td class="source"> } else {</td>
</tr>
<tr class="hit">
    <td class="line">161</td>
    <td class="hits">3</td>
    <td class="source"> var ret = exports.writePacketBegin(consts.TAIR_REQ_REMOVE_PACKET, 48 +
        keyBuffer.length);
    </td>
</tr>
<tr>
    <td class="line">162</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">163</td>
    <td class="hits">9</td>
    <td class="source"> var pos = ret[1], packet = ret[0];</td>
</tr>
<tr>
    <td class="line">164</td>
    <td class="hits"></td>
    <td class="source"> //packet body begin</td>
</tr>
<tr class="hit">
    <td class="line">165</td>
    <td class="hits">9</td>
    <td class="source"> packet[pos] = 0;</td>
</tr>
<tr class="hit">
    <td class="line">166</td>
    <td class="hits">9</td>
    <td class="source"> pos++;</td>
</tr>
<tr class="hit">
    <td class="line">167</td>
    <td class="hits">9</td>
    <td class="source"> packet.writeInt16BE(namespace, pos);</td>
</tr>
<tr class="hit">
    <td class="line">168</td>
    <td class="hits">9</td>
    <td class="source"> pos += 2;</td>
</tr>
<tr class="hit">
    <td class="line">169</td>
    <td class="hits">9</td>
    <td class="source"> packet.writeInt32BE(1, pos); // key list size</td>
</tr>
<tr class="hit">
    <td class="line">170</td>
    <td class="hits">9</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr>
    <td class="line">171</td>
    <td class="hits"></td>
    <td class="source"> //key</td>
</tr>
<tr class="hit">
    <td class="line">172</td>
    <td class="hits">9</td>
    <td class="source"> pos += fillMeta(packet, pos);</td>
</tr>
<tr class="hit">
    <td class="line">173</td>
    <td class="hits">9</td>
    <td class="source"> pos += encodeMeta(packet, pos, 0);</td>
</tr>
<tr class="hit">
    <td class="line">174</td>
    <td class="hits">9</td>
    <td class="source"> packet.writeInt32BE(keyBuffer.length + 1, pos);</td>
</tr>
<tr class="hit">
    <td class="line">175</td>
    <td class="hits">9</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">176</td>
    <td class="hits">9</td>
    <td class="source"> keyBuffer.copy(packet, pos, 0, keyBuffer.length);</td>
</tr>
<tr class="hit">
    <td class="line">177</td>
    <td class="hits">9</td>
    <td class="source"> pos += keyBuffer.length + 1;</td>
</tr>
<tr>
    <td class="line">178</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">179</td>
    <td class="hits">9</td>
    <td class="source"> return packet;</td>
</tr>
<tr>
    <td class="line">180</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">181</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">182</td>
    <td class="hits">1</td>
    <td class="source">exports.requestMGetPacket = function (namespace, keys) {</td>
</tr>
<tr class="hit">
    <td class="line">183</td>
    <td class="hits">1</td>
    <td class="source"> var kCount = keys.length;</td>
</tr>
<tr class="hit">
    <td class="line">184</td>
    <td class="hits">1</td>
    <td class="source"> var kSize = 0;</td>
</tr>
<tr class="hit">
    <td class="line">185</td>
    <td class="hits">1</td>
    <td class="source"> var bufList = [];</td>
</tr>
<tr class="hit">
    <td class="line">186</td>
    <td class="hits">1</td>
    <td class="source"> for (var i = 0; i &lt; kCount; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">187</td>
    <td class="hits">4</td>
    <td class="source"> bufList[i] = transcoder.encode(keys[i]);</td>
</tr>
<tr class="hit">
    <td class="line">188</td>
    <td class="hits">4</td>
    <td class="source"> kSize += bufList[i].length;</td>
</tr>
<tr>
    <td class="line">189</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">190</td>
    <td class="hits">1</td>
    <td class="source"> var ret = exports.writePacketBegin(consts.TAIR_REQ_GET_PACKET, 8 + kSize +
        kCount * 40);
    </td>
</tr>
<tr class="hit">
    <td class="line">191</td>
    <td class="hits">1</td>
    <td class="source"> var pos = ret[1], packet = ret[0];</td>
</tr>
<tr>
    <td class="line">192</td>
    <td class="hits"></td>
    <td class="source"> //packet body begin</td>
</tr>
<tr class="hit">
    <td class="line">193</td>
    <td class="hits">1</td>
    <td class="source"> packet[pos] = 0;</td>
</tr>
<tr class="hit">
    <td class="line">194</td>
    <td class="hits">1</td>
    <td class="source"> pos++;</td>
</tr>
<tr class="hit">
    <td class="line">195</td>
    <td class="hits">1</td>
    <td class="source"> packet.writeInt16BE(namespace, pos);</td>
</tr>
<tr class="hit">
    <td class="line">196</td>
    <td class="hits">1</td>
    <td class="source"> pos += 2;</td>
</tr>
<tr class="hit">
    <td class="line">197</td>
    <td class="hits">1</td>
    <td class="source"> packet.writeInt32BE(kCount, pos); // key list size</td>
</tr>
<tr class="hit">
    <td class="line">198</td>
    <td class="hits">1</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">199</td>
    <td class="hits">1</td>
    <td class="source"> for (var i = 0; i &lt; kCount; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">200</td>
    <td class="hits">4</td>
    <td class="source"> pos += fillMeta(packet, pos);</td>
</tr>
<tr class="hit">
    <td class="line">201</td>
    <td class="hits">4</td>
    <td class="source"> pos += encodeMeta(packet, pos, 0);</td>
</tr>
<tr class="hit">
    <td class="line">202</td>
    <td class="hits">4</td>
    <td class="source"> packet.writeInt32BE(bufList[i].length + 1, pos);</td>
</tr>
<tr class="hit">
    <td class="line">203</td>
    <td class="hits">4</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">204</td>
    <td class="hits">4</td>
    <td class="source"> bufList[i].copy(packet, pos, 0, bufList[i].length);</td>
</tr>
<tr class="hit">
    <td class="line">205</td>
    <td class="hits">4</td>
    <td class="source"> pos += bufList[i].length + 1;</td>
</tr>
<tr>
    <td class="line">206</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">207</td>
    <td class="hits">1</td>
    <td class="source"> return packet;</td>
</tr>
<tr>
    <td class="line">208</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">209</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">210</td>
    <td class="hits">1</td>
    <td class="source">exports.responseMGetPacket = function (data) {</td>
</tr>
<tr class="hit">
    <td class="line">211</td>
    <td class="hits">3</td>
    <td class="source"> if (!data) {</td>
</tr>
<tr class="hit">
    <td class="line">212</td>
    <td class="hits">1</td>
    <td class="source"> return {key: null, value: null};</td>
</tr>
<tr>
    <td class="line">213</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">214</td>
    <td class="hits">2</td>
    <td class="source"> var pos = 16;</td>
</tr>
<tr class="hit">
    <td class="line">215</td>
    <td class="hits">2</td>
    <td class="source"> if (data.length &lt; 19) {</td>
</tr>
<tr class="hit">
    <td class="line">216</td>
    <td class="hits">1</td>
    <td class="source"> return null;</td>
</tr>
<tr>
    <td class="line">217</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">218</td>
    <td class="hits">1</td>
    <td class="source"> var configVer = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">219</td>
    <td class="hits">1</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">220</td>
    <td class="hits">1</td>
    <td class="source"> var result = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">221</td>
    <td class="hits">1</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">222</td>
    <td class="hits">1</td>
    <td class="source"> if (result !== -3983) {</td>
</tr>
<tr class="miss">
    <td class="line">223</td>
    <td class="hits">0</td>
    <td class="source"> return null;</td>
</tr>
<tr>
    <td class="line">224</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">225</td>
    <td class="hits">1</td>
    <td class="source"> var vCount = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">226</td>
    <td class="hits">1</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">227</td>
    <td class="hits">1</td>
    <td class="source"> if (vCount === 0) {</td>
</tr>
<tr class="miss">
    <td class="line">228</td>
    <td class="hits">0</td>
    <td class="source"> return null;</td>
</tr>
<tr>
    <td class="line">229</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">230</td>
    <td class="hits">1</td>
    <td class="source"> var keys = [];</td>
</tr>
<tr class="hit">
    <td class="line">231</td>
    <td class="hits">1</td>
    <td class="source"> var values = [];</td>
</tr>
<tr class="hit">
    <td class="line">232</td>
    <td class="hits">1</td>
    <td class="source"> for (var i = 0; i &lt; vCount; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">233</td>
    <td class="hits">3</td>
    <td class="source"> pos += 36; // we donnot need meta data</td>
</tr>
<tr class="hit">
    <td class="line">234</td>
    <td class="hits">3</td>
    <td class="source"> var kSize = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">235</td>
    <td class="hits">3</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">236</td>
    <td class="hits">3</td>
    <td class="source"> var kBuf = new Buffer(kSize);</td>
</tr>
<tr class="hit">
    <td class="line">237</td>
    <td class="hits">3</td>
    <td class="source"> data.copy(kBuf, 0, pos, pos + kSize);</td>
</tr>
<tr class="hit">
    <td class="line">238</td>
    <td class="hits">3</td>
    <td class="source"> pos += kSize;</td>
</tr>
<tr class="hit">
    <td class="line">239</td>
    <td class="hits">3</td>
    <td class="source"> pos += 36; // we donnot need meta data</td>
</tr>
<tr class="hit">
    <td class="line">240</td>
    <td class="hits">3</td>
    <td class="source"> var vSize = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">241</td>
    <td class="hits">3</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">242</td>
    <td class="hits">3</td>
    <td class="source"> var vBuf = new Buffer(vSize);</td>
</tr>
<tr class="hit">
    <td class="line">243</td>
    <td class="hits">3</td>
    <td class="source"> data.copy(vBuf, 0, pos, pos + vSize);</td>
</tr>
<tr class="hit">
    <td class="line">244</td>
    <td class="hits">3</td>
    <td class="source"> pos += vSize;</td>
</tr>
<tr class="hit">
    <td class="line">245</td>
    <td class="hits">3</td>
    <td class="source"> keys.push(kBuf.toString('utf-8').replace('\u0000', ''));</td>
</tr>
<tr class="hit">
    <td class="line">246</td>
    <td class="hits">3</td>
    <td class="source"> values.push(vBuf.toString('utf-8').replace('\u0000', ''));</td>
</tr>
<tr>
    <td class="line">247</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">248</td>
    <td class="hits">1</td>
    <td class="source"> return {keys: keys, values: values, count: vCount};</td>
</tr>
<tr>
    <td class="line">249</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">250</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">251</td>
    <td class="hits">1</td>
    <td class="source">exports.responseGetPacket = function (data) {</td>
</tr>
<tr class="hit">
    <td class="line">252</td>
    <td class="hits">8</td>
    <td class="source"> if (!data) {</td>
</tr>
<tr class="hit">
    <td class="line">253</td>
    <td class="hits">1</td>
    <td class="source"> return {key: null, value: null};</td>
</tr>
<tr>
    <td class="line">254</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">255</td>
    <td class="hits">7</td>
    <td class="source"> var pos = 16;</td>
</tr>
<tr class="hit">
    <td class="line">256</td>
    <td class="hits">7</td>
    <td class="source"> if (data.length &lt; 19) {</td>
</tr>
<tr class="hit">
    <td class="line">257</td>
    <td class="hits">1</td>
    <td class="source"> return null;</td>
</tr>
<tr>
    <td class="line">258</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">259</td>
    <td class="hits">6</td>
    <td class="source"> var configVer = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">260</td>
    <td class="hits">6</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">261</td>
    <td class="hits">6</td>
    <td class="source"> var result = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">262</td>
    <td class="hits">6</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">263</td>
    <td class="hits">6</td>
    <td class="source"> if (result !== 0) {</td>
</tr>
<tr class="hit">
    <td class="line">264</td>
    <td class="hits">4</td>
    <td class="source"> return null;</td>
</tr>
<tr>
    <td class="line">265</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">266</td>
    <td class="hits">2</td>
    <td class="source"> var vCount = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">267</td>
    <td class="hits">2</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">268</td>
    <td class="hits">2</td>
    <td class="source"> if (vCount &gt; 1) {</td>
</tr>
<tr class="miss">
    <td class="line">269</td>
    <td class="hits">0</td>
    <td class="source"> console.log('Tair: warn: this method cannot support multi get, use mget
        instead.');
    </td>
</tr>
<tr>
    <td class="line">270</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">271</td>
    <td class="hits">2</td>
    <td class="source"> if (vCount === 0) {</td>
</tr>
<tr class="miss">
    <td class="line">272</td>
    <td class="hits">0</td>
    <td class="source"> return null;</td>
</tr>
<tr>
    <td class="line">273</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">274</td>
    <td class="hits">2</td>
    <td class="source"> pos += 36; // we donnot need meta data</td>
</tr>
<tr class="hit">
    <td class="line">275</td>
    <td class="hits">2</td>
    <td class="source"> var kSize = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">276</td>
    <td class="hits">2</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">277</td>
    <td class="hits">2</td>
    <td class="source"> var kBuf = new Buffer(kSize);</td>
</tr>
<tr class="hit">
    <td class="line">278</td>
    <td class="hits">2</td>
    <td class="source"> data.copy(kBuf, 0, pos, pos + kSize);</td>
</tr>
<tr class="hit">
    <td class="line">279</td>
    <td class="hits">2</td>
    <td class="source"> pos += kSize;</td>
</tr>
<tr class="hit">
    <td class="line">280</td>
    <td class="hits">2</td>
    <td class="source"> pos += 36; // we donnot need meta data</td>
</tr>
<tr class="hit">
    <td class="line">281</td>
    <td class="hits">2</td>
    <td class="source"> var vSize = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">282</td>
    <td class="hits">2</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">283</td>
    <td class="hits">2</td>
    <td class="source"> var vBuf = new Buffer(vSize);</td>
</tr>
<tr class="hit">
    <td class="line">284</td>
    <td class="hits">2</td>
    <td class="source"> data.copy(vBuf, 0, pos, pos + vSize);</td>
</tr>
<tr class="hit">
    <td class="line">285</td>
    <td class="hits">2</td>
    <td class="source"> pos += vSize;</td>
</tr>
<tr>
    <td class="line">286</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">287</td>
    <td class="hits">2</td>
    <td class="source"> return {key: kBuf.toString('utf-8').replace('\u0000', ''), value:
        vBuf.toString('utf-8').replace('\u0000', '')};
    </td>
</tr>
<tr>
    <td class="line">288</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">289</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">290</td>
    <td class="hits">1</td>
    <td class="source">exports.requestIncDecPacket = function (namespace, key, count, initValue, expire)
        {
    </td>
</tr>
<tr class="hit">
    <td class="line">291</td>
    <td class="hits">3</td>
    <td class="source"> var keyBuffer = transcoder.encode(key);</td>
</tr>
<tr>
    <td class="line">292</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">293</td>
    <td class="hits">3</td>
    <td class="source"> var ret = exports.writePacketBegin(consts.TAIR_REQ_INCDEC_PACKET, 56 +
        keyBuffer.length);
    </td>
</tr>
<tr>
    <td class="line">294</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">295</td>
    <td class="hits">3</td>
    <td class="source"> var pos = ret[1], packet = ret[0];</td>
</tr>
<tr>
    <td class="line">296</td>
    <td class="hits"></td>
    <td class="source"> //packet body begin</td>
</tr>
<tr class="hit">
    <td class="line">297</td>
    <td class="hits">3</td>
    <td class="source"> packet[pos] = 0;</td>
</tr>
<tr class="hit">
    <td class="line">298</td>
    <td class="hits">3</td>
    <td class="source"> pos++;</td>
</tr>
<tr class="hit">
    <td class="line">299</td>
    <td class="hits">3</td>
    <td class="source"> packet.writeInt16BE(namespace, pos);</td>
</tr>
<tr class="hit">
    <td class="line">300</td>
    <td class="hits">3</td>
    <td class="source"> pos += 2;</td>
</tr>
<tr class="hit">
    <td class="line">301</td>
    <td class="hits">3</td>
    <td class="source"> packet.writeInt32BE(count || 0, pos);</td>
</tr>
<tr class="hit">
    <td class="line">302</td>
    <td class="hits">3</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">303</td>
    <td class="hits">3</td>
    <td class="source"> packet.writeInt32BE(initValue || 0, pos);</td>
</tr>
<tr class="hit">
    <td class="line">304</td>
    <td class="hits">3</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">305</td>
    <td class="hits">3</td>
    <td class="source"> packet.writeInt32BE(expire || 0, pos);</td>
</tr>
<tr class="hit">
    <td class="line">306</td>
    <td class="hits">3</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr>
    <td class="line">307</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">308</td>
    <td class="hits"></td>
    <td class="source"> //key</td>
</tr>
<tr class="hit">
    <td class="line">309</td>
    <td class="hits">3</td>
    <td class="source"> pos += fillMeta(packet, pos);</td>
</tr>
<tr class="hit">
    <td class="line">310</td>
    <td class="hits">3</td>
    <td class="source"> pos += encodeMeta(packet, pos, 0);</td>
</tr>
<tr class="hit">
    <td class="line">311</td>
    <td class="hits">3</td>
    <td class="source"> packet.writeInt32BE(keyBuffer.length + 1, pos);</td>
</tr>
<tr class="hit">
    <td class="line">312</td>
    <td class="hits">3</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">313</td>
    <td class="hits">3</td>
    <td class="source"> keyBuffer.copy(packet, pos, 0, keyBuffer.length);</td>
</tr>
<tr class="hit">
    <td class="line">314</td>
    <td class="hits">3</td>
    <td class="source"> pos += keyBuffer.length + 1;</td>
</tr>
<tr>
    <td class="line">315</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">316</td>
    <td class="hits">3</td>
    <td class="source"> return packet;</td>
</tr>
<tr>
    <td class="line">317</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">318</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">319</td>
    <td class="hits">1</td>
    <td class="source">exports.returnPacket = function (data) {</td>
</tr>
<tr class="hit">
    <td class="line">320</td>
    <td class="hits">15</td>
    <td class="source"> var pos = 16;</td>
</tr>
<tr class="hit">
    <td class="line">321</td>
    <td class="hits">15</td>
    <td class="source"> if (!data) return {configVersion: 0, code: -1001};</td>
</tr>
<tr class="hit">
    <td class="line">322</td>
    <td class="hits">15</td>
    <td class="source"> if (data.length &lt; 19) {</td>
</tr>
<tr class="miss">
    <td class="line">323</td>
    <td class="hits">0</td>
    <td class="source"> return {configVersion: 0, code: -1000};</td>
</tr>
<tr>
    <td class="line">324</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">325</td>
    <td class="hits">15</td>
    <td class="source"> var configVer = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">326</td>
    <td class="hits">15</td>
    <td class="source"> pos += 4;</td>
</tr>
<tr class="hit">
    <td class="line">327</td>
    <td class="hits">15</td>
    <td class="source"> var result = data.readInt32BE(pos);</td>
</tr>
<tr class="hit">
    <td class="line">328</td>
    <td class="hits">15</td>
    <td class="source"> return {configVersion: configVer, code: result};</td>
</tr>
<tr>
    <td class="line">329</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">330</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">331</td>
    <td class="hits">1</td>
    <td class="source">function readLong (buffer, pos) {</td>
</tr>
<tr class="hit">
    <td class="line">332</td>
    <td class="hits">10</td>
    <td class="source"> var _buf = new Buffer(8);</td>
</tr>
<tr class="hit">
    <td class="line">333</td>
    <td class="hits">10</td>
    <td class="source"> buffer.copy(_buf, 0, pos, pos + 8);</td>
</tr>
<tr class="hit">
    <td class="line">334</td>
    <td class="hits">10</td>
    <td class="source"> return utils.decodeLong(_buf);</td>
</tr>
<tr>
    <td class="line">335</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">336</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">337</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">338</td>
    <td class="hits">1</td>
    <td class="source">var writeString = exports.writeString = function (byteBuffer, pos, str) {</td>
</tr>
<tr class="hit">
    <td class="line">339</td>
    <td class="hits">9</td>
    <td class="source"> var written = 0;</td>
</tr>
<tr class="hit">
    <td class="line">340</td>
    <td class="hits">9</td>
    <td class="source"> if (str == null) {</td>
</tr>
<tr class="miss">
    <td class="line">341</td>
    <td class="hits">0</td>
    <td class="source"> byteBuffer.writeInt32BE(0, pos);</td>
</tr>
<tr class="miss">
    <td class="line">342</td>
    <td class="hits">0</td>
    <td class="source"> written += 4;</td>
</tr>
<tr>
    <td class="line">343</td>
    <td class="hits"></td>
    <td class="source"> } else {</td>
</tr>
<tr class="hit">
    <td class="line">344</td>
    <td class="hits">9</td>
    <td class="source"> var _buf = new Buffer(str, 'utf-8');</td>
</tr>
<tr class="hit">
    <td class="line">345</td>
    <td class="hits">9</td>
    <td class="source"> byteBuffer.writeInt32BE(_buf.length + 1, pos);</td>
</tr>
<tr class="hit">
    <td class="line">346</td>
    <td class="hits">9</td>
    <td class="source"> written += 4;</td>
</tr>
<tr class="hit">
    <td class="line">347</td>
    <td class="hits">9</td>
    <td class="source"> written += byteBuffer.write(str, pos + written, 'utf-8');</td>
</tr>
<tr class="hit">
    <td class="line">348</td>
    <td class="hits">9</td>
    <td class="source"> byteBuffer.writeInt8(0, pos + written);</td>
</tr>
<tr class="hit">
    <td class="line">349</td>
    <td class="hits">9</td>
    <td class="source"> written += 4;</td>
</tr>
<tr>
    <td class="line">350</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">351</td>
    <td class="hits">9</td>
    <td class="source"> return written;</td>
</tr>
<tr>
    <td class="line">352</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">353</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">354</td>
    <td class="hits">1</td>
    <td class="source">var readString = exports.readString = function (byteBuffer, pos) {</td>
</tr>
<tr class="hit">
    <td class="line">355</td>
    <td class="hits">11</td>
    <td class="source"> var len = parseInt(byteBuffer.readInt32BE(pos));</td>
</tr>
<tr class="hit">
    <td class="line">356</td>
    <td class="hits">11</td>
    <td class="source"> if (len &lt;= 1) {</td>
</tr>
<tr class="miss">
    <td class="line">357</td>
    <td class="hits">0</td>
    <td class="source"> return &quot;&quot;;</td>
</tr>
<tr>
    <td class="line">358</td>
    <td class="hits"></td>
    <td class="source"> } else {</td>
</tr>
<tr class="hit">
    <td class="line">359</td>
    <td class="hits">11</td>
    <td class="source"> var b = new Buffer(len);</td>
</tr>
<tr class="hit">
    <td class="line">360</td>
    <td class="hits">11</td>
    <td class="source"> byteBuffer.copy(b, 0, pos + 4, pos + 4 + len);</td>
</tr>
<tr class="hit">
    <td class="line">361</td>
    <td class="hits">11</td>
    <td class="source"> return [b.toString('utf-8').replace('\u0000', ''), 4 + len];</td>
</tr>
<tr>
    <td class="line">362</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">363</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">364</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">365</td>
    <td class="hits">1</td>
    <td class="source">function encodeMeta (buffer, pos, flag) {</td>
</tr>
<tr class="hit">
    <td class="line">366</td>
    <td class="hits">34</td>
    <td class="source"> for (var i = pos; i &lt; pos + 29; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">367</td>
    <td class="hits">986</td>
    <td class="source"> buffer[i] = 0;</td>
</tr>
<tr>
    <td class="line">368</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">369</td>
    <td class="hits">34</td>
    <td class="source"> if (flag !== 0) {</td>
</tr>
<tr class="miss">
    <td class="line">370</td>
    <td class="hits">0</td>
    <td class="source"> buffer.writeInt32BE(flag, pos + 13);</td>
</tr>
<tr>
    <td class="line">371</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">372</td>
    <td class="hits">34</td>
    <td class="source"> return 29;</td>
</tr>
<tr>
    <td class="line">373</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr class="hit">
    <td class="line">374</td>
    <td class="hits">1</td>
    <td class="source">function fillMeta (buffer, pos) {</td>
</tr>
<tr class="hit">
    <td class="line">375</td>
    <td class="hits">34</td>
    <td class="source"> for (var i = pos; i &lt; pos + 7; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">376</td>
    <td class="hits">238</td>
    <td class="source"> buffer[i] = 0;</td>
</tr>
<tr>
    <td class="line">377</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">378</td>
    <td class="hits">34</td>
    <td class="source"> return 7;</td>
</tr>
<tr>
    <td class="line">379</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
</tbody>
</table>
</div>
<div class="file"><h2 id="const.js">const.js</h2>

<div id="stats" class="high">
    <div class="percentage">100%</div>
    <div class="sloc">1</div>
    <div class="hits">1</div>
    <div class="misses">0</div>
</div>
<table id="source">
<thead>
<tr>
    <th>Line</th>
    <th>Hits</th>
    <th>Source</th>
</tr>
</thead>
<tbody>
<tr>
    <td class="line">1</td>
    <td class="hits"></td>
    <td class="source">/*!</td>
</tr>
<tr>
    <td class="line">2</td>
    <td class="hits"></td>
    <td class="source"> * tair - lib/const.js</td>
</tr>
<tr>
    <td class="line">3</td>
    <td class="hits"></td>
    <td class="source"> * Copyright(c) 2012 Taobao.com</td>
</tr>
<tr>
    <td class="line">4</td>
    <td class="hits"></td>
    <td class="source"> * Author: kate.sf &lt;kate.sf@taobao.com&gt;</td>
</tr>
<tr>
    <td class="line">5</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">6</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">7</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">8</td>
    <td class="hits"></td>
    <td class="source"> * const variables for this module</td>
</tr>
<tr>
    <td class="line">9</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr class="hit">
    <td class="line">10</td>
    <td class="hits">1</td>
    <td class="source">module.exports = {</td>
</tr>
<tr>
    <td class="line">11</td>
    <td class="hits"></td>
    <td class="source"> // packet flag</td>
</tr>
<tr>
    <td class="line">12</td>
    <td class="hits"></td>
    <td class="source"> TAIR_PACKET_FLAG: 0x6d426454,</td>
</tr>
<tr>
    <td class="line">13</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">14</td>
    <td class="hits"></td>
    <td class="source">// packet code</td>
</tr>
<tr>
    <td class="line">15</td>
    <td class="hits"></td>
    <td class="source">// request</td>
</tr>
<tr>
    <td class="line">16</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_PUT_PACKET: 1,</td>
</tr>
<tr>
    <td class="line">17</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_GET_PACKET: 2,</td>
</tr>
<tr>
    <td class="line">18</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_REMOVE_PACKET: 3,</td>
</tr>
<tr>
    <td class="line">19</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_INVALID_PACKET: 12,</td>
</tr>
<tr>
    <td class="line">20</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_INCDEC_PACKET: 11,</td>
</tr>
<tr>
    <td class="line">21</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_LOCK_PACKET: 14,</td>
</tr>
<tr>
    <td class="line">22</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">23</td>
    <td class="hits"></td>
    <td class="source">// response</td>
</tr>
<tr>
    <td class="line">24</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_RETURN_PACKET: 101,</td>
</tr>
<tr>
    <td class="line">25</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_GET_PACKET: 102,</td>
</tr>
<tr>
    <td class="line">26</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_INCDEC_PACKET: 105,</td>
</tr>
<tr>
    <td class="line">27</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">28</td>
    <td class="hits"></td>
    <td class="source">// config server</td>
</tr>
<tr>
    <td class="line">29</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_GET_GROUP_NEW_PACKET: 1002,</td>
</tr>
<tr>
    <td class="line">30</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_GET_GROUP_NEW_PACKET: 1102,</td>
</tr>
<tr>
    <td class="line">31</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_QUERY_INFO_PACKET: 1009,</td>
</tr>
<tr>
    <td class="line">32</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_QUERY_INFO_PACKET: 1106,</td>
</tr>
<tr>
    <td class="line">33</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">34</td>
    <td class="hits"></td>
    <td class="source">// items</td>
</tr>
<tr>
    <td class="line">35</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ADDITEMS_PACKET: 1400,</td>
</tr>
<tr>
    <td class="line">36</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_GETITEMS_PACKET: 1401,</td>
</tr>
<tr>
    <td class="line">37</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_REMOVEITEMS_PACKET: 1402,</td>
</tr>
<tr>
    <td class="line">38</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_GETANDREMOVEITEMS_PACKET: 1403,</td>
</tr>
<tr>
    <td class="line">39</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_GETITEMSCOUNT_PACKET: 1404,</td>
</tr>
<tr>
    <td class="line">40</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_GETITEMS_PACKET: 1405,</td>
</tr>
<tr>
    <td class="line">41</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">42</td>
    <td class="hits"></td>
    <td class="source"> /*</td>
</tr>
<tr>
    <td class="line">43</td>
    <td class="hits"></td>
    <td class="source"> * extend for redis 2[12]xx,</td>
</tr>
<tr>
    <td class="line">44</td>
    <td class="hits"></td>
    <td class="source"> * first number 2 means extend packet,</td>
</tr>
<tr>
    <td class="line">45</td>
    <td class="hits"></td>
    <td class="source"> * second number 1 means request, 2 means response</td>
</tr>
<tr>
    <td class="line">46</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">47</td>
    <td class="hits"></td>
    <td class="source">//list</td>
</tr>
<tr>
    <td class="line">48</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_LPOP_PACKET: 2100,</td>
</tr>
<tr>
    <td class="line">49</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_LPOP_PACKET: 2200,</td>
</tr>
<tr>
    <td class="line">50</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">51</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_LPUSH_PACKET: 2101,</td>
</tr>
<tr>
    <td class="line">52</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_LPUSH_PACKET: 2201,</td>
</tr>
<tr>
    <td class="line">53</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">54</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_RPOP_PACKET: 2102,</td>
</tr>
<tr>
    <td class="line">55</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_RPOP_PACKET: 2202,</td>
</tr>
<tr>
    <td class="line">56</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">57</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_RPUSH_PACKET: 2103,</td>
</tr>
<tr>
    <td class="line">58</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_RPUSH_PACKET: 2203,</td>
</tr>
<tr>
    <td class="line">59</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">60</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_LPUSHX_PACKET: 2104,</td>
</tr>
<tr>
    <td class="line">61</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_LPUSHX_PACKET: 2204,</td>
</tr>
<tr>
    <td class="line">62</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">63</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_RPUSHX_PACKET: 2105,</td>
</tr>
<tr>
    <td class="line">64</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_RPUSHX_PACKET: 2205,</td>
</tr>
<tr>
    <td class="line">65</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">66</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_LINDEX_PACKET: 2106,</td>
</tr>
<tr>
    <td class="line">67</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_LINDEX_PACKET: 2206,</td>
</tr>
<tr>
    <td class="line">68</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">69</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_LTRIM_PACKET: 2128,</td>
</tr>
<tr>
    <td class="line">70</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_LTRIM_PACKET: 2228,</td>
</tr>
<tr>
    <td class="line">71</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">72</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_LREM_PACKET: 2129,</td>
</tr>
<tr>
    <td class="line">73</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_LREM_PACKET: 2229,</td>
</tr>
<tr>
    <td class="line">74</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">75</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_LRANGE_PACKET: 2130,</td>
</tr>
<tr>
    <td class="line">76</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_LRANGE_PACKET: 2230,</td>
</tr>
<tr>
    <td class="line">77</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">78</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_LLEN_PACKET: 2133,</td>
</tr>
<tr>
    <td class="line">79</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_LLEN_PACKET: 2233,</td>
</tr>
<tr>
    <td class="line">80</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">81</td>
    <td class="hits"></td>
    <td class="source">//hset</td>
</tr>
<tr>
    <td class="line">82</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_HGETALL_PACKET: 2107,</td>
</tr>
<tr>
    <td class="line">83</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_HGETALL_PACKET: 2207,</td>
</tr>
<tr>
    <td class="line">84</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">85</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_HINCRBY_PACKET: 2108,</td>
</tr>
<tr>
    <td class="line">86</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_HINCRBY_PACKET: 2208,</td>
</tr>
<tr>
    <td class="line">87</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">88</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_HMSET_PACKET: 2109,</td>
</tr>
<tr>
    <td class="line">89</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_HMSET_PACKET: 2209,</td>
</tr>
<tr>
    <td class="line">90</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">91</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_HSET_PACKET: 2110,</td>
</tr>
<tr>
    <td class="line">92</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_HSET_PACKET: 2210,</td>
</tr>
<tr>
    <td class="line">93</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">94</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_HSETNX_PACKET: 2111,</td>
</tr>
<tr>
    <td class="line">95</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_HSETNX_PACKET: 2211,</td>
</tr>
<tr>
    <td class="line">96</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">97</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_HGET_PACKET: 2112,</td>
</tr>
<tr>
    <td class="line">98</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_HGET_PACKET: 2212,</td>
</tr>
<tr>
    <td class="line">99</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">100</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_HMGET_PACKET: 2113,</td>
</tr>
<tr>
    <td class="line">101</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_HMGET_PACKET: 2213,</td>
</tr>
<tr>
    <td class="line">102</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">103</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_HVALS_PACKET: 2114,</td>
</tr>
<tr>
    <td class="line">104</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_HVALS_PACKET: 2214,</td>
</tr>
<tr>
    <td class="line">105</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">106</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_HDEL_PACKET: 2115,</td>
</tr>
<tr>
    <td class="line">107</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_HDEL_PACKET: 2215,</td>
</tr>
<tr>
    <td class="line">108</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">109</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_HLEN_PACKET: 2136,</td>
</tr>
<tr>
    <td class="line">110</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_HLEN_PACKET: 2236,</td>
</tr>
<tr>
    <td class="line">111</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">112</td>
    <td class="hits"></td>
    <td class="source">//set</td>
</tr>
<tr>
    <td class="line">113</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_SCARD_PACKET: 2116,</td>
</tr>
<tr>
    <td class="line">114</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_SCARD_PACKET: 2216,</td>
</tr>
<tr>
    <td class="line">115</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">116</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_SMEMBERS_PACKET: 2117,</td>
</tr>
<tr>
    <td class="line">117</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_SMEMBERS_PACKET: 2217,</td>
</tr>
<tr>
    <td class="line">118</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">119</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_SADD_PACKET: 2118,</td>
</tr>
<tr>
    <td class="line">120</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_SADD_PACKET: 2218,</td>
</tr>
<tr>
    <td class="line">121</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">122</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_SPOP_PACKET: 2119,</td>
</tr>
<tr>
    <td class="line">123</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_SPOP_PACKET: 2219,</td>
</tr>
<tr>
    <td class="line">124</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">125</td>
    <td class="hits"></td>
    <td class="source">//zset</td>
</tr>
<tr>
    <td class="line">126</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZRANGE_PACKET: 2120,</td>
</tr>
<tr>
    <td class="line">127</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZRANGE_PACKET: 2220,</td>
</tr>
<tr>
    <td class="line">128</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">129</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZREVRANGE_PACKET: 2121,</td>
</tr>
<tr>
    <td class="line">130</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZREVRANGE_PACKET: 2221,</td>
</tr>
<tr>
    <td class="line">131</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">132</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZSCORE_PACKET: 2122,</td>
</tr>
<tr>
    <td class="line">133</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZSCORE_PACKET: 2222,</td>
</tr>
<tr>
    <td class="line">134</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">135</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZRANGEBYSCORE_PACKET: 2123,</td>
</tr>
<tr>
    <td class="line">136</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZRANGEBYSCORE_PACKET: 2223,</td>
</tr>
<tr>
    <td class="line">137</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">138</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZADD_PACKET: 2124,</td>
</tr>
<tr>
    <td class="line">139</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZADD_PACKET: 2224,</td>
</tr>
<tr>
    <td class="line">140</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">141</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZRANK_PACKET: 2125,</td>
</tr>
<tr>
    <td class="line">142</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZRANK_PACKET: 2225,</td>
</tr>
<tr>
    <td class="line">143</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">144</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZCARD_PACKET: 2126,</td>
</tr>
<tr>
    <td class="line">145</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZCARD_PACKET: 2226,</td>
</tr>
<tr>
    <td class="line">146</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">147</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZREM_PACKET: 2137,</td>
</tr>
<tr>
    <td class="line">148</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZREM_PACKET: 2237,</td>
</tr>
<tr>
    <td class="line">149</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">150</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZREMRANGEBYRANK_PACKET: 2138,</td>
</tr>
<tr>
    <td class="line">151</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZREMRANGEBYRANK_PACKET: 2238,</td>
</tr>
<tr>
    <td class="line">152</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">153</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZREMRANGEBYSCORE_PACKET: 2139,</td>
</tr>
<tr>
    <td class="line">154</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZREMRANGEBYSCORE_PACKET: 2239,</td>
</tr>
<tr>
    <td class="line">155</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">156</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZREVRANK_PACKET: 2140,</td>
</tr>
<tr>
    <td class="line">157</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZREVRANK_PACKET: 2240,</td>
</tr>
<tr>
    <td class="line">158</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">159</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZCOUNT_PACKET: 2141,</td>
</tr>
<tr>
    <td class="line">160</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZCOUNT_PACKET: 2241,</td>
</tr>
<tr>
    <td class="line">161</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">162</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_ZINCRBY_PACKET: 2142,</td>
</tr>
<tr>
    <td class="line">163</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_ZINCRBY_PACKET: 2242,</td>
</tr>
<tr>
    <td class="line">164</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">165</td>
    <td class="hits"></td>
    <td class="source">//common</td>
</tr>
<tr>
    <td class="line">166</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_EXPIRE_PACKET: 2127,</td>
</tr>
<tr>
    <td class="line">167</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_EXPIRE_PACKET: 2227,</td>
</tr>
<tr>
    <td class="line">168</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">169</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_EXPIREAT_PACKET: 2131,</td>
</tr>
<tr>
    <td class="line">170</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_EXPIREAT_PACKET: 2231,</td>
</tr>
<tr>
    <td class="line">171</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">172</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_PERSIST_PACKET: 2132,</td>
</tr>
<tr>
    <td class="line">173</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_PERSIST_PACKET: 2232,</td>
</tr>
<tr>
    <td class="line">174</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">175</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_TTL_PACKET: 2134,</td>
</tr>
<tr>
    <td class="line">176</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_TTL_PACKET: 2234,</td>
</tr>
<tr>
    <td class="line">177</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">178</td>
    <td class="hits"></td>
    <td class="source"> TAIR_REQ_TYPE_PACKET: 2135,</td>
</tr>
<tr>
    <td class="line">179</td>
    <td class="hits"></td>
    <td class="source"> TAIR_RESP_TYPE_PACKET: 2235,</td>
</tr>
<tr>
    <td class="line">180</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">181</td>
    <td class="hits"></td>
    <td class="source">// serialize type</td>
</tr>
<tr>
    <td class="line">182</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_INT: 1,</td>
</tr>
<tr>
    <td class="line">183</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_STRING: 2,</td>
</tr>
<tr>
    <td class="line">184</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_BOOL: 3,</td>
</tr>
<tr>
    <td class="line">185</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_LONG: 4,</td>
</tr>
<tr>
    <td class="line">186</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_DATE: 5,</td>
</tr>
<tr>
    <td class="line">187</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_BYTE: 6,</td>
</tr>
<tr>
    <td class="line">188</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_FLOAT: 7,</td>
</tr>
<tr>
    <td class="line">189</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_DOUBLE: 8,</td>
</tr>
<tr>
    <td class="line">190</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_BYTEARRAY: 9,</td>
</tr>
<tr>
    <td class="line">191</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_SERIALIZE: 10,</td>
</tr>
<tr>
    <td class="line">192</td>
    <td class="hits"></td>
    <td class="source"> TAIR_STYPE_INCDATA: 11,</td>
</tr>
<tr>
    <td class="line">193</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">194</td>
    <td class="hits"></td>
    <td class="source"> TAIR_PACKET_HEADER_SIZE: 16,</td>
</tr>
<tr>
    <td class="line">195</td>
    <td class="hits"></td>
    <td class="source"> TAIR_PACKET_HEADER_BLPOS: 12,</td>
</tr>
<tr>
    <td class="line">196</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">197</td>
    <td class="hits"></td>
    <td class="source">// buffer size</td>
</tr>
<tr>
    <td class="line">198</td>
    <td class="hits"></td>
    <td class="source"> INOUT_BUFFER_SIZE: 8192,</td>
</tr>
<tr>
    <td class="line">199</td>
    <td class="hits"></td>
    <td class="source"> DEFAULT_TIMEOUT: 2000,</td>
</tr>
<tr>
    <td class="line">200</td>
    <td class="hits"></td>
    <td class="source"> DEFAULT_CS_CONN_TIMEOUT: 1000,</td>
</tr>
<tr>
    <td class="line">201</td>
    <td class="hits"></td>
    <td class="source"> DEFAULT_CS_TIMEOUT: 500,</td>
</tr>
<tr>
    <td class="line">202</td>
    <td class="hits"></td>
    <td class="source"> DEFAULT_WAIT_THREAD: 100,</td>
</tr>
<tr>
    <td class="line">203</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">204</td>
    <td class="hits"></td>
    <td class="source">// etc</td>
</tr>
<tr>
    <td class="line">205</td>
    <td class="hits"></td>
    <td class="source"> TAIR_DEFAULT_COMPRESSION_THRESHOLD: 8192,</td>
</tr>
<tr>
    <td class="line">206</td>
    <td class="hits"></td>
    <td class="source"> DEFAULT_CHARSET: &quot;UTF-8&quot;,</td>
</tr>
<tr>
    <td class="line">207</td>
    <td class="hits"></td>
    <td class="source"> TAIR_KEY_MAX_LENTH: 1024, // 1KB</td>
</tr>
<tr>
    <td class="line">208</td>
    <td class="hits"></td>
    <td class="source"> TAIR_VALUE_MAX_LENGTH: 1000000,</td>
</tr>
<tr>
    <td class="line">209</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">210</td>
    <td class="hits"></td>
    <td class="source"> TAIR_MAX_COUNT: 1024,</td>
</tr>
<tr>
    <td class="line">211</td>
    <td class="hits"></td>
    <td class="source"> TAIR_MALLOC_MAX: 1024 * 1024, // 1MB</td>
</tr>
<tr>
    <td class="line">212</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">213</td>
    <td class="hits"></td>
    <td class="source"> NAMESPACE_MAX: 1023,</td>
</tr>
<tr>
    <td class="line">214</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">215</td>
    <td class="hits"></td>
    <td class="source"> ITEM_ALL: 65537,</td>
</tr>
<tr>
    <td class="line">216</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">217</td>
    <td class="hits"></td>
    <td class="source"> INVALUD_SERVERLIST_KEY: &quot;invalidate_server&quot;,</td>
</tr>
<tr>
    <td class="line">218</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">219</td>
    <td class="hits"></td>
    <td class="source"> Q_AREA_CAPACITY: 1,</td>
</tr>
<tr>
    <td class="line">220</td>
    <td class="hits"></td>
    <td class="source"> Q_MIG_INFO: 2,</td>
</tr>
<tr>
    <td class="line">221</td>
    <td class="hits"></td>
    <td class="source"> Q_DATA_SEVER_INFO: 3,</td>
</tr>
<tr>
    <td class="line">222</td>
    <td class="hits"></td>
    <td class="source"> Q_GROUP_INFO: 4,</td>
</tr>
<tr>
    <td class="line">223</td>
    <td class="hits"></td>
    <td class="source"> Q_STAT_INFO: 5,</td>
</tr>
<tr>
    <td class="line">224</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">225</td>
    <td class="hits"></td>
    <td class="source"> NOT_CARE_VERSION: 0,</td>
</tr>
<tr>
    <td class="line">226</td>
    <td class="hits"></td>
    <td class="source"> NOT_CARE_EXPIRE: -1,</td>
</tr>
<tr>
    <td class="line">227</td>
    <td class="hits"></td>
    <td class="source"> CANCEL_EXPIRE: 0,</td>
</tr>
<tr>
    <td class="line">228</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">229</td>
    <td class="hits"></td>
    <td class="source">///////////////////constant//////////////////</td>
</tr>
<tr>
    <td class="line">230</td>
    <td class="hits"></td>
    <td class="source"> REQUEST_ENCODE_OK: 0,</td>
</tr>
<tr>
    <td class="line">231</td>
    <td class="hits"></td>
    <td class="source"> KEYTOLARGE: 1,</td>
</tr>
<tr>
    <td class="line">232</td>
    <td class="hits"></td>
    <td class="source"> VALUETOLARGE: 2,</td>
</tr>
<tr>
    <td class="line">233</td>
    <td class="hits"></td>
    <td class="source"> SERIALIZEERROR: 3,</td>
</tr>
<tr>
    <td class="line">234</td>
    <td class="hits"></td>
    <td class="source"> DATALENTOOLONG: 4,</td>
</tr>
<tr>
    <td class="line">235</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">236</td>
    <td class="hits"></td>
    <td class="source"> DATA_ENTRY_MAX_SIZE: 1024 * 1024,</td>
</tr>
<tr>
    <td class="line">237</td>
    <td class="hits"></td>
    <td class="source"> LIST_MAX_LEN: 8192</td>
</tr>
<tr>
    <td class="line">238</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
</tbody>
</table>
</div>
<div class="file"><h2 id="utils.js">utils.js</h2>

<div id="stats" class="high">
    <div class="percentage">100%</div>
    <div class="sloc">42</div>
    <div class="hits">42</div>
    <div class="misses">0</div>
</div>
<table id="source">
<thead>
<tr>
    <th>Line</th>
    <th>Hits</th>
    <th>Source</th>
</tr>
</thead>
<tbody>
<tr>
    <td class="line">1</td>
    <td class="hits"></td>
    <td class="source">/*!</td>
</tr>
<tr>
    <td class="line">2</td>
    <td class="hits"></td>
    <td class="source"> * tair - lib/transcoder.js</td>
</tr>
<tr>
    <td class="line">3</td>
    <td class="hits"></td>
    <td class="source"> * Copyright(c) 2012 Taobao.com</td>
</tr>
<tr>
    <td class="line">4</td>
    <td class="hits"></td>
    <td class="source"> * Author: kate.sf &lt;kate.sf@taobao.com&gt;</td>
</tr>
<tr>
    <td class="line">5</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">6</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">7</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">8</td>
    <td class="hits"></td>
    <td class="source"> * utility module</td>
</tr>
<tr>
    <td class="line">9</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">10</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">11</td>
    <td class="hits">1</td>
    <td class="source">exports.encodeLong = function (number) {</td>
</tr>
<tr class="hit">
    <td class="line">12</td>
    <td class="hits">1</td>
    <td class="source"> var rt = new Buffer(8);</td>
</tr>
<tr>
    <td class="line">13</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">14</td>
    <td class="hits">1</td>
    <td class="source"> rt[7] = (number &amp; 0xFF);</td>
</tr>
<tr class="hit">
    <td class="line">15</td>
    <td class="hits">1</td>
    <td class="source"> rt[6] = ((number &gt;&gt; 8) &amp; 0xFF);</td>
</tr>
<tr class="hit">
    <td class="line">16</td>
    <td class="hits">1</td>
    <td class="source"> rt[5] = ((number &gt;&gt; 16) &amp; 0xFF);</td>
</tr>
<tr class="hit">
    <td class="line">17</td>
    <td class="hits">1</td>
    <td class="source"> rt[4] = ((number &gt;&gt; 24) &amp; 0xFF);</td>
</tr>
<tr class="hit">
    <td class="line">18</td>
    <td class="hits">1</td>
    <td class="source"> rt[3] = ((number &gt;&gt; 32) &amp; 0xFF);</td>
</tr>
<tr class="hit">
    <td class="line">19</td>
    <td class="hits">1</td>
    <td class="source"> rt[2] = ((number &gt;&gt; 40) &amp; 0xFF);</td>
</tr>
<tr class="hit">
    <td class="line">20</td>
    <td class="hits">1</td>
    <td class="source"> rt[1] = ((number &gt;&gt; 48) &amp; 0xFF);</td>
</tr>
<tr class="hit">
    <td class="line">21</td>
    <td class="hits">1</td>
    <td class="source"> rt[0] = ((number &gt;&gt; 56) &amp; 0xFF);</td>
</tr>
<tr class="hit">
    <td class="line">22</td>
    <td class="hits">1</td>
    <td class="source"> return rt;</td>
</tr>
<tr>
    <td class="line">23</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">24</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">25</td>
    <td class="hits">1</td>
    <td class="source">exports.decodeLong = function (data) {</td>
</tr>
<tr class="hit">
    <td class="line">26</td>
    <td class="hits">12</td>
    <td class="source"> var rv = 0;</td>
</tr>
<tr class="hit">
    <td class="line">27</td>
    <td class="hits">12</td>
    <td class="source"> for (var i = 0; i &lt; data.length; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">28</td>
    <td class="hits">92</td>
    <td class="source"> rv = (rv &lt;&lt; 8) | ((data[i] &lt; 0) ? (256 + data[i]) : data[i]);</td>
</tr>
<tr>
    <td class="line">29</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">30</td>
    <td class="hits">12</td>
    <td class="source"> return rv &gt;&gt;&gt; 0;</td>
</tr>
<tr>
    <td class="line">31</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">32</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">33</td>
    <td class="hits">1</td>
    <td class="source">exports.encodeInt = function (number) {</td>
</tr>
<tr class="hit">
    <td class="line">34</td>
    <td class="hits">2</td>
    <td class="source"> var fg = new Buffer(4);</td>
</tr>
<tr class="hit">
    <td class="line">35</td>
    <td class="hits">2</td>
    <td class="source"> fg.writeInt32BE(number, 0);</td>
</tr>
<tr class="hit">
    <td class="line">36</td>
    <td class="hits">2</td>
    <td class="source"> return fg;</td>
</tr>
<tr>
    <td class="line">37</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">38</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">39</td>
    <td class="hits">1</td>
    <td class="source">exports.decodeInt = function (data) {</td>
</tr>
<tr class="hit">
    <td class="line">40</td>
    <td class="hits">1</td>
    <td class="source"> return data.readInt32BE(0);</td>
</tr>
<tr>
    <td class="line">41</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">42</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">43</td>
    <td class="hits">1</td>
    <td class="source">exports.getInt = function (data, offset) {</td>
</tr>
<tr class="hit">
    <td class="line">44</td>
    <td class="hits">1</td>
    <td class="source"> return data.readInt32BE(offset);</td>
</tr>
<tr>
    <td class="line">45</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">46</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">47</td>
    <td class="hits">1</td>
    <td class="source">exports.encodeBoolean = function (b) {</td>
</tr>
<tr class="hit">
    <td class="line">48</td>
    <td class="hits">2</td>
    <td class="source"> var rv = new Buffer(1);</td>
</tr>
<tr class="hit">
    <td class="line">49</td>
    <td class="hits">2</td>
    <td class="source"> rv[0] = (b ? '1' : '0');</td>
</tr>
<tr class="hit">
    <td class="line">50</td>
    <td class="hits">2</td>
    <td class="source"> return rv;</td>
</tr>
<tr>
    <td class="line">51</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">52</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">53</td>
    <td class="hits">1</td>
    <td class="source">exports.encodeFloat = function (float) {</td>
</tr>
<tr class="hit">
    <td class="line">54</td>
    <td class="hits">1</td>
    <td class="source"> var rf = new Buffer(8);</td>
</tr>
<tr class="hit">
    <td class="line">55</td>
    <td class="hits">1</td>
    <td class="source"> rf.writeDoubleBE(float, 0);</td>
</tr>
<tr class="hit">
    <td class="line">56</td>
    <td class="hits">1</td>
    <td class="source"> return rf;</td>
</tr>
<tr>
    <td class="line">57</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">58</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">59</td>
    <td class="hits">1</td>
    <td class="source">exports.decodeBoolean = function (input) {</td>
</tr>
<tr class="hit">
    <td class="line">60</td>
    <td class="hits">1</td>
    <td class="source"> return (input[0] == '1');</td>
</tr>
<tr>
    <td class="line">61</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">62</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">63</td>
    <td class="hits">1</td>
    <td class="source">exports.longToIP = function (id) {</td>
</tr>
<tr class="hit">
    <td class="line">64</td>
    <td class="hits">26</td>
    <td class="source"> var host = '';</td>
</tr>
<tr class="hit">
    <td class="line">65</td>
    <td class="hits">26</td>
    <td class="source"> host += ((id &amp; 0xff)).toString() + '.';</td>
</tr>
<tr class="hit">
    <td class="line">66</td>
    <td class="hits">26</td>
    <td class="source"> host += (((id &gt;&gt; 8) &amp; 0xff)).toString() + '.';</td>
</tr>
<tr class="hit">
    <td class="line">67</td>
    <td class="hits">26</td>
    <td class="source"> host += (((id &gt;&gt; 16) &amp; 0xff)).toString() + '.';</td>
</tr>
<tr class="hit">
    <td class="line">68</td>
    <td class="hits">26</td>
    <td class="source"> host += (((id &gt;&gt; 24) &amp; 0xff)).toString();</td>
</tr>
<tr>
    <td class="line">69</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">70</td>
    <td class="hits">26</td>
    <td class="source"> var port = ((id &gt;&gt; 32) &amp; 0xffff);</td>
</tr>
<tr class="hit">
    <td class="line">71</td>
    <td class="hits">26</td>
    <td class="source"> return host;</td>
</tr>
<tr>
    <td class="line">72</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
</tbody>
</table>
</div>
<div class="file"><h2 id="transcoder.js">transcoder.js</h2>

<div id="stats" class="high">
    <div class="percentage">81%</div>
    <div class="sloc">82</div>
    <div class="hits">67</div>
    <div class="misses">15</div>
</div>
<table id="source">
<thead>
<tr>
    <th>Line</th>
    <th>Hits</th>
    <th>Source</th>
</tr>
</thead>
<tbody>
<tr>
    <td class="line">1</td>
    <td class="hits"></td>
    <td class="source">/*!</td>
</tr>
<tr>
    <td class="line">2</td>
    <td class="hits"></td>
    <td class="source"> * tair - lib/transcoder.js</td>
</tr>
<tr>
    <td class="line">3</td>
    <td class="hits"></td>
    <td class="source"> * Copyright(c) 2012 Taobao.com</td>
</tr>
<tr>
    <td class="line">4</td>
    <td class="hits"></td>
    <td class="source"> * Author: kate.sf &lt;kate.sf@taobao.com&gt;</td>
</tr>
<tr>
    <td class="line">5</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">6</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">7</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">8</td>
    <td class="hits"></td>
    <td class="source"> * Encode and decode module</td>
</tr>
<tr>
    <td class="line">9</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">10</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">11</td>
    <td class="hits">1</td>
    <td class="source">var consts = require('./const');</td>
</tr>
<tr class="hit">
    <td class="line">12</td>
    <td class="hits">1</td>
    <td class="source">var utils = require('./utils');</td>
</tr>
<tr>
    <td class="line">13</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">14</td>
    <td class="hits">1</td>
    <td class="source">exports.encode = function (object, charset, isFlag) {</td>
</tr>
<tr class="hit">
    <td class="line">15</td>
    <td class="hits">66</td>
    <td class="source"> if (!object) {</td>
</tr>
<tr class="hit">
    <td class="line">16</td>
    <td class="hits">1</td>
    <td class="source"> return null;</td>
</tr>
<tr>
    <td class="line">17</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">18</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">19</td>
    <td class="hits">65</td>
    <td class="source"> charset = charset || 'utf-8';</td>
</tr>
<tr class="hit">
    <td class="line">20</td>
    <td class="hits">65</td>
    <td class="source"> var buf = null;</td>
</tr>
<tr class="hit">
    <td class="line">21</td>
    <td class="hits">65</td>
    <td class="source"> var flag = 0;</td>
</tr>
<tr>
    <td class="line">22</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">23</td>
    <td class="hits">65</td>
    <td class="source"> if (typeof object === 'string') {</td>
</tr>
<tr class="hit">
    <td class="line">24</td>
    <td class="hits">61</td>
    <td class="source"> buf = new Buffer(object, charset);</td>
</tr>
<tr class="hit">
    <td class="line">25</td>
    <td class="hits">61</td>
    <td class="source"> flag = consts.TAIR_STYPE_STRING;</td>
</tr>
<tr class="hit">
    <td class="line">26</td>
    <td class="hits">4</td>
    <td class="source"> } else if (typeof object === 'number' &amp;&amp; Math.floor(object) === object)
        {
    </td>
</tr>
<tr class="hit">
    <td class="line">27</td>
    <td class="hits">1</td>
    <td class="source"> buf = utils.encodeInt(object);</td>
</tr>
<tr class="hit">
    <td class="line">28</td>
    <td class="hits">1</td>
    <td class="source"> flag = consts.TAIR_STYPE_LONG;</td>
</tr>
<tr class="hit">
    <td class="line">29</td>
    <td class="hits">3</td>
    <td class="source"> } else if (typeof object === 'boolean') {</td>
</tr>
<tr class="hit">
    <td class="line">30</td>
    <td class="hits">1</td>
    <td class="source"> buf = utils.encodeBoolean(object);</td>
</tr>
<tr class="hit">
    <td class="line">31</td>
    <td class="hits">1</td>
    <td class="source"> flag = consts.TAIR_STYPE_BOOL;</td>
</tr>
<tr class="hit">
    <td class="line">32</td>
    <td class="hits">2</td>
    <td class="source"> } else if (typeof object.getTime === 'function') {</td>
</tr>
<tr class="hit">
    <td class="line">33</td>
    <td class="hits">1</td>
    <td class="source"> buf = new Buffer(4);</td>
</tr>
<tr class="hit">
    <td class="line">34</td>
    <td class="hits">1</td>
    <td class="source"> buf.writeUInt32BE(Math.floor(object.getTime() / 1000), 0);</td>
</tr>
<tr class="hit">
    <td class="line">35</td>
    <td class="hits">1</td>
    <td class="source"> flag = consts.TAIR_STYPE_DATE;</td>
</tr>
<tr class="hit">
    <td class="line">36</td>
    <td class="hits">1</td>
    <td class="source"> } else if (typeof object === 'number' &amp;&amp; Math.floor(object) !== object)
        {
    </td>
</tr>
<tr class="hit">
    <td class="line">37</td>
    <td class="hits">1</td>
    <td class="source"> buf = utils.encodeFloat(object);</td>
</tr>
<tr class="hit">
    <td class="line">38</td>
    <td class="hits">1</td>
    <td class="source"> flag = consts.TAIR_STYPE_FLOAT;</td>
</tr>
<tr class="miss">
    <td class="line">39</td>
    <td class="hits">0</td>
    <td class="source"> } else if (Buffer.isBuffer(object)) {</td>
</tr>
<tr class="miss">
    <td class="line">40</td>
    <td class="hits">0</td>
    <td class="source"> buf = object;</td>
</tr>
<tr class="miss">
    <td class="line">41</td>
    <td class="hits">0</td>
    <td class="source"> flag = consts.TAIR_STYPE_BYTEARRAY;</td>
</tr>
<tr>
    <td class="line">42</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">43</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">44</td>
    <td class="hits">65</td>
    <td class="source"> flag &lt;&lt;= 1;</td>
</tr>
<tr>
    <td class="line">45</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">46</td>
    <td class="hits">65</td>
    <td class="source"> var result = new Buffer(buf.length + 2);</td>
</tr>
<tr class="hit">
    <td class="line">47</td>
    <td class="hits">65</td>
    <td class="source"> var fg = new Buffer(2);</td>
</tr>
<tr>
    <td class="line">48</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">49</td>
    <td class="hits">65</td>
    <td class="source"> fg[1] = (flag &amp; 0xFF);</td>
</tr>
<tr class="hit">
    <td class="line">50</td>
    <td class="hits">65</td>
    <td class="source"> fg[0] = ((flag &gt;&gt; 8) &amp; 0xFF);</td>
</tr>
<tr>
    <td class="line">51</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">52</td>
    <td class="hits">65</td>
    <td class="source"> for (var i = 0; i &lt; 2; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">53</td>
    <td class="hits">130</td>
    <td class="source"> result[i] = fg[i];</td>
</tr>
<tr>
    <td class="line">54</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">55</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">56</td>
    <td class="hits">65</td>
    <td class="source"> for (var i = 0, l = buf.length; i &lt; l; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">57</td>
    <td class="hits">229105</td>
    <td class="source"> result[i + 2] = buf[i];</td>
</tr>
<tr>
    <td class="line">58</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">59</td>
    <td class="hits">70</td>
    <td class="source"> if (isFlag) return result;</td>
</tr>
<tr class="hit">
    <td class="line">60</td>
    <td class="hits">60</td>
    <td class="source"> return buf;</td>
</tr>
<tr>
    <td class="line">61</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">62</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">63</td>
    <td class="hits">1</td>
    <td class="source">exports.decode = function (data, offset, size) {</td>
</tr>
<tr class="hit">
    <td class="line">64</td>
    <td class="hits">5</td>
    <td class="source"> if (!Buffer.isBuffer(data)) {</td>
</tr>
<tr class="miss">
    <td class="line">65</td>
    <td class="hits">0</td>
    <td class="source"> return null;</td>
</tr>
<tr>
    <td class="line">66</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">67</td>
    <td class="hits">5</td>
    <td class="source"> offset = offset || 0;</td>
</tr>
<tr class="hit">
    <td class="line">68</td>
    <td class="hits">5</td>
    <td class="source"> size = size || data.length;</td>
</tr>
<tr class="hit">
    <td class="line">69</td>
    <td class="hits">5</td>
    <td class="source"> var index = 0;</td>
</tr>
<tr class="hit">
    <td class="line">70</td>
    <td class="hits">5</td>
    <td class="source"> for (index = 0; index &lt; size &amp;&amp; (index + offset &lt; data.length);
        index++) {
    </td>
</tr>
<tr class="hit">
    <td class="line">71</td>
    <td class="hits">14</td>
    <td class="source"> if (data[index + offset] == '+' || data[index + offset] == '-') {</td>
</tr>
<tr class="miss">
    <td class="line">72</td>
    <td class="hits">0</td>
    <td class="source"> continue;</td>
</tr>
<tr>
    <td class="line">73</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">74</td>
    <td class="hits">14</td>
    <td class="source"> if (data[index + offset] &lt; '0' || data[index + offset] &gt; '9') {</td>
</tr>
<tr class="hit">
    <td class="line">75</td>
    <td class="hits">4</td>
    <td class="source"> break;</td>
</tr>
<tr>
    <td class="line">76</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">77</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">78</td>
    <td class="hits">5</td>
    <td class="source"> if (index == size) {</td>
</tr>
<tr class="hit">
    <td class="line">79</td>
    <td class="hits">1</td>
    <td class="source"> var tmpstr = data.toString('utf-8', offset, size);</td>
</tr>
<tr class="hit">
    <td class="line">80</td>
    <td class="hits">1</td>
    <td class="source"> try {</td>
</tr>
<tr class="hit">
    <td class="line">81</td>
    <td class="hits">1</td>
    <td class="source"> var tmp = Number.valueOf(tmpstr);</td>
</tr>
<tr class="hit">
    <td class="line">82</td>
    <td class="hits">1</td>
    <td class="source"> return tmp;</td>
</tr>
<tr>
    <td class="line">83</td>
    <td class="hits"></td>
    <td class="source"> } catch (err) {</td>
</tr>
<tr class="miss">
    <td class="line">84</td>
    <td class="hits">0</td>
    <td class="source"> ;</td>
</tr>
<tr>
    <td class="line">85</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">86</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">87</td>
    <td class="hits"></td>
    <td class="source"> ///////////////////////////////////////////////////////////</td>
</tr>
<tr>
    <td class="line">88</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">89</td>
    <td class="hits">4</td>
    <td class="source"> var vb = new Buffer(size - 2);</td>
</tr>
<tr>
    <td class="line">90</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">91</td>
    <td class="hits">4</td>
    <td class="source"> data.copy(vb, offset + 2, 0, size - 2);</td>
</tr>
<tr>
    <td class="line">92</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">93</td>
    <td class="hits">4</td>
    <td class="source"> var obj = null;</td>
</tr>
<tr>
    <td class="line">94</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">95</td>
    <td class="hits">4</td>
    <td class="source"> var flags = 0;</td>
</tr>
<tr>
    <td class="line">96</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">97</td>
    <td class="hits">4</td>
    <td class="source"> for (var i = 0; i &lt; 2; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">98</td>
    <td class="hits">8</td>
    <td class="source"> var b = data[offset + i];</td>
</tr>
<tr class="hit">
    <td class="line">99</td>
    <td class="hits">8</td>
    <td class="source"> flags = (flags &lt;&lt; 8) | ((b &lt; 0) ? (256 + b) : b);</td>
</tr>
<tr>
    <td class="line">100</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">101</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">102</td>
    <td class="hits"></td>
    <td class="source">// if ((flags &amp; 1) == 1) {</td>
</tr>
<tr>
    <td class="line">103</td>
    <td class="hits"></td>
    <td class="source">// vb = utils.decompress(vb);</td>
</tr>
<tr>
    <td class="line">104</td>
    <td class="hits"></td>
    <td class="source">// }</td>
</tr>
<tr>
    <td class="line">105</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">106</td>
    <td class="hits">4</td>
    <td class="source"> var type = (flags &gt;&gt; 1) &amp; 0xF;</td>
</tr>
<tr>
    <td class="line">107</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">108</td>
    <td class="hits">4</td>
    <td class="source"> switch (type) {</td>
</tr>
<tr>
    <td class="line">109</td>
    <td class="hits"></td>
    <td class="source"> case consts.TAIR_STYPE_INT:</td>
</tr>
<tr class="miss">
    <td class="line">110</td>
    <td class="hits">0</td>
    <td class="source"> obj = utils.decodeInt(vb);</td>
</tr>
<tr class="miss">
    <td class="line">111</td>
    <td class="hits">0</td>
    <td class="source"> break;</td>
</tr>
<tr>
    <td class="line">112</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">113</td>
    <td class="hits"></td>
    <td class="source"> case consts.TAIR_STYPE_STRING:</td>
</tr>
<tr class="hit">
    <td class="line">114</td>
    <td class="hits">1</td>
    <td class="source"> obj = vb.toString('utf-8');</td>
</tr>
<tr class="hit">
    <td class="line">115</td>
    <td class="hits">1</td>
    <td class="source"> break;</td>
</tr>
<tr>
    <td class="line">116</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">117</td>
    <td class="hits"></td>
    <td class="source"> case consts.TAIR_STYPE_BOOL:</td>
</tr>
<tr class="miss">
    <td class="line">118</td>
    <td class="hits">0</td>
    <td class="source"> obj = utils.decodeBoolean(vb);</td>
</tr>
<tr class="miss">
    <td class="line">119</td>
    <td class="hits">0</td>
    <td class="source"> break;</td>
</tr>
<tr>
    <td class="line">120</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">121</td>
    <td class="hits"></td>
    <td class="source"> case consts.TAIR_STYPE_LONG:</td>
</tr>
<tr class="hit">
    <td class="line">122</td>
    <td class="hits">1</td>
    <td class="source"> obj = utils.decodeLong(vb);</td>
</tr>
<tr class="hit">
    <td class="line">123</td>
    <td class="hits">1</td>
    <td class="source"> break;</td>
</tr>
<tr>
    <td class="line">124</td>
    <td class="hits"></td>
    <td class="source"> case consts.TAIR_STYPE_DATE:</td>
</tr>
<tr class="hit">
    <td class="line">125</td>
    <td class="hits">1</td>
    <td class="source"> obj = new Date(vb.readUInt32BE(0) * 1000);</td>
</tr>
<tr class="hit">
    <td class="line">126</td>
    <td class="hits">1</td>
    <td class="source"> break;</td>
</tr>
<tr>
    <td class="line">127</td>
    <td class="hits"></td>
    <td class="source"> case consts.TAIR_STYPE_BYTE:</td>
</tr>
<tr class="miss">
    <td class="line">128</td>
    <td class="hits">0</td>
    <td class="source"> obj = vb;</td>
</tr>
<tr class="miss">
    <td class="line">129</td>
    <td class="hits">0</td>
    <td class="source"> break;</td>
</tr>
<tr>
    <td class="line">130</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">131</td>
    <td class="hits"></td>
    <td class="source"> case consts.TAIR_STYPE_FLOAT:</td>
</tr>
<tr class="hit">
    <td class="line">132</td>
    <td class="hits">1</td>
    <td class="source"> obj = vb.readFloatBE(0);</td>
</tr>
<tr class="hit">
    <td class="line">133</td>
    <td class="hits">1</td>
    <td class="source"> break;</td>
</tr>
<tr>
    <td class="line">134</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">135</td>
    <td class="hits"></td>
    <td class="source"> case consts.TAIR_STYPE_BYTEARRAY:</td>
</tr>
<tr class="miss">
    <td class="line">136</td>
    <td class="hits">0</td>
    <td class="source"> obj = vb;</td>
</tr>
<tr class="miss">
    <td class="line">137</td>
    <td class="hits">0</td>
    <td class="source"> break;</td>
</tr>
<tr>
    <td class="line">138</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">139</td>
    <td class="hits"></td>
    <td class="source"> default:</td>
</tr>
<tr class="miss">
    <td class="line">140</td>
    <td class="hits">0</td>
    <td class="source"> return null</td>
</tr>
<tr>
    <td class="line">141</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">142</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">143</td>
    <td class="hits">4</td>
    <td class="source"> return obj;</td>
</tr>
<tr>
    <td class="line">144</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
</tbody>
</table>
</div>
<div class="file"><h2 id="comm.js">comm.js</h2>

<div id="stats" class="high">
    <div class="percentage">93%</div>
    <div class="sloc">130</div>
    <div class="hits">122</div>
    <div class="misses">8</div>
</div>
<table id="source">
<thead>
<tr>
    <th>Line</th>
    <th>Hits</th>
    <th>Source</th>
</tr>
</thead>
<tbody>
<tr>
    <td class="line">1</td>
    <td class="hits"></td>
    <td class="source">/*!</td>
</tr>
<tr>
    <td class="line">2</td>
    <td class="hits"></td>
    <td class="source"> * tair - lib/packet.js</td>
</tr>
<tr>
    <td class="line">3</td>
    <td class="hits"></td>
    <td class="source"> * Copyright(c) 2012 Taobao.com</td>
</tr>
<tr>
    <td class="line">4</td>
    <td class="hits"></td>
    <td class="source"> * Author: kate.sf &lt;kate.sf@taobao.com&gt;</td>
</tr>
<tr>
    <td class="line">5</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">6</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">7</td>
    <td class="hits"></td>
    <td class="source">/**</td>
</tr>
<tr>
    <td class="line">8</td>
    <td class="hits"></td>
    <td class="source"> * network communication module</td>
</tr>
<tr>
    <td class="line">9</td>
    <td class="hits"></td>
    <td class="source"> */</td>
</tr>
<tr>
    <td class="line">10</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">11</td>
    <td class="hits">1</td>
    <td class="source">var net = require('net');</td>
</tr>
<tr class="hit">
    <td class="line">12</td>
    <td class="hits">1</td>
    <td class="source">var consts = require('./const');</td>
</tr>
<tr>
    <td class="line">13</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">14</td>
    <td class="hits">1</td>
    <td class="source">var connectionPool = [];</td>
</tr>
<tr class="hit">
    <td class="line">15</td>
    <td class="hits">1</td>
    <td class="source">var packetQueue = [];</td>
</tr>
<tr class="hit">
    <td class="line">16</td>
    <td class="hits">1</td>
    <td class="source">var sending = false;</td>
</tr>
<tr class="hit">
    <td class="line">17</td>
    <td class="hits">1</td>
    <td class="source">var buffer_start_size = 128 * 1024;</td>
</tr>
<tr>
    <td class="line">18</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">19</td>
    <td class="hits">1</td>
    <td class="source">var chunk;</td>
</tr>
<tr class="hit">
    <td class="line">20</td>
    <td class="hits">1</td>
    <td class="source">var _pos;</td>
</tr>
<tr class="hit">
    <td class="line">21</td>
    <td class="hits">1</td>
    <td class="source">var len;</td>
</tr>
<tr class="hit">
    <td class="line">22</td>
    <td class="hits">1</td>
    <td class="source">var callbacks = {};</td>
</tr>
<tr class="hit">
    <td class="line">23</td>
    <td class="hits">1</td>
    <td class="source">var callbackTimeout = null;</td>
</tr>
<tr class="hit">
    <td class="line">24</td>
    <td class="hits">1</td>
    <td class="source">var addr;</td>
</tr>
<tr class="hit">
    <td class="line">25</td>
    <td class="hits">1</td>
    <td class="source">var addrKey;</td>
</tr>
<tr class="hit">
    <td class="line">26</td>
    <td class="hits">1</td>
    <td class="source">var client;</td>
</tr>
<tr class="hit">
    <td class="line">27</td>
    <td class="hits">1</td>
    <td class="source">var timeCounter = null;</td>
</tr>
<tr>
    <td class="line">28</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">29</td>
    <td class="hits">1</td>
    <td class="source">exports.getData = function (addr, buf, callback) {</td>
</tr>
<tr class="hit">
    <td class="line">30</td>
    <td class="hits">31</td>
    <td class="source"> var packetID = Math.floor((Math.random() * (new Date().getTime())) / 10000);
    </td>
</tr>
<tr class="hit">
    <td class="line">31</td>
    <td class="hits">31</td>
    <td class="source"> if (buf.length &gt;= 16)</td>
</tr>
<tr class="hit">
    <td class="line">32</td>
    <td class="hits">29</td>
    <td class="source"> buf.writeInt32BE(packetID, 4);</td>
</tr>
<tr class="hit">
    <td class="line">33</td>
    <td class="hits">31</td>
    <td class="source"> packetQueue.push([addr, buf, callback, packetID]);</td>
</tr>
<tr class="hit">
    <td class="line">34</td>
    <td class="hits">31</td>
    <td class="source"> if (!sending) {</td>
</tr>
<tr class="hit">
    <td class="line">35</td>
    <td class="hits">7</td>
    <td class="source"> return getDataReal();</td>
</tr>
<tr>
    <td class="line">36</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">37</td>
    <td class="hits"></td>
    <td class="source">};</td>
</tr>
<tr>
    <td class="line">38</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">39</td>
    <td class="hits">1</td>
    <td class="source">function getDataReal () {</td>
</tr>
<tr class="hit">
    <td class="line">40</td>
    <td class="hits">73</td>
    <td class="source"> if (sending) {</td>
</tr>
<tr class="hit">
    <td class="line">41</td>
    <td class="hits">6</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">42</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">43</td>
    <td class="hits">67</td>
    <td class="source"> var _packet = packetQueue.pop();</td>
</tr>
<tr class="hit">
    <td class="line">44</td>
    <td class="hits">67</td>
    <td class="source"> if (!_packet) {</td>
</tr>
<tr class="miss">
    <td class="line">45</td>
    <td class="hits">0</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">46</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">47</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">48</td>
    <td class="hits">67</td>
    <td class="source"> sending = true;</td>
</tr>
<tr>
    <td class="line">49</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">50</td>
    <td class="hits">67</td>
    <td class="source"> var buf = _packet[1];</td>
</tr>
<tr class="hit">
    <td class="line">51</td>
    <td class="hits">67</td>
    <td class="source"> callbacks[_packet[3]] = _packet[2];</td>
</tr>
<tr class="hit">
    <td class="line">52</td>
    <td class="hits">67</td>
    <td class="source"> callbackTimeout = _packet[2];</td>
</tr>
<tr class="hit">
    <td class="line">53</td>
    <td class="hits">67</td>
    <td class="source"> callbackTimeout.key = _packet[3];</td>
</tr>
<tr class="hit">
    <td class="line">54</td>
    <td class="hits">67</td>
    <td class="source"> chunk = new Buffer(buffer_start_size);</td>
</tr>
<tr class="hit">
    <td class="line">55</td>
    <td class="hits">67</td>
    <td class="source"> _pos = 0;</td>
</tr>
<tr class="hit">
    <td class="line">56</td>
    <td class="hits">67</td>
    <td class="source"> len = 0;</td>
</tr>
<tr>
    <td class="line">57</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">58</td>
    <td class="hits">67</td>
    <td class="source"> addr = _packet[0];</td>
</tr>
<tr class="hit">
    <td class="line">59</td>
    <td class="hits">67</td>
    <td class="source"> addrKey = (addr.host + addr.port).toString();</td>
</tr>
<tr>
    <td class="line">60</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">61</td>
    <td class="hits">67</td>
    <td class="source"> client = findClient(addrKey);</td>
</tr>
<tr>
    <td class="line">62</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">63</td>
    <td class="hits"></td>
    <td class="source"> //&#233;&#148;&#129;&#231;&#154;&#132;&#232;&#182;&#133;&#230;&#151;&#182;&#232;&#174;&#190;&#231;&#189;&#174;&#239;&#188;&#140;&#233;&#152;&#178;&#230;&#173;&#162;&#230;&#173;&#187;&#233;&#148;&#129;</td>
</tr>
<tr class="hit">
    <td class="line">64</td>
    <td class="hits">67</td>
    <td class="source"> timeCounter = setTimeout(function () {</td>
</tr>
<tr class="hit">
    <td class="line">65</td>
    <td class="hits">2</td>
    <td class="source"> if (sending) {</td>
</tr>
<tr class="hit">
    <td class="line">66</td>
    <td class="hits">2</td>
    <td class="source"> sending = false;</td>
</tr>
<tr class="hit">
    <td class="line">67</td>
    <td class="hits">2</td>
    <td class="source"> if (!callbackTimeout._hadcalled) {</td>
</tr>
<tr class="miss">
    <td class="line">68</td>
    <td class="hits">0</td>
    <td class="source"> callbackTimeout._hadcalled = true;</td>
</tr>
<tr class="miss">
    <td class="line">69</td>
    <td class="hits">0</td>
    <td class="source"> callbackTimeout(new Error('Tair: Server ' + addr.host + addr.port + '
        Timeout'));
    </td>
</tr>
<tr>
    <td class="line">70</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">71</td>
    <td class="hits">2</td>
    <td class="source"> deleteClient(client.addrKey);</td>
</tr>
<tr class="hit">
    <td class="line">72</td>
    <td class="hits">2</td>
    <td class="source"> return getDataReal();</td>
</tr>
<tr>
    <td class="line">73</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">74</td>
    <td class="hits"></td>
    <td class="source"> }, 5000);</td>
</tr>
<tr class="hit">
    <td class="line">75</td>
    <td class="hits">67</td>
    <td class="source"> if (client) {</td>
</tr>
<tr class="hit">
    <td class="line">76</td>
    <td class="hits">28</td>
    <td class="source"> client.write(buf);</td>
</tr>
<tr>
    <td class="line">77</td>
    <td class="hits"></td>
    <td class="source"> } else {</td>
</tr>
<tr class="hit">
    <td class="line">78</td>
    <td class="hits">39</td>
    <td class="source"> client = new net.Socket();</td>
</tr>
<tr class="hit">
    <td class="line">79</td>
    <td class="hits">39</td>
    <td class="source"> client.setTimeout(4000);</td>
</tr>
<tr class="hit">
    <td class="line">80</td>
    <td class="hits">39</td>
    <td class="source"> client.addrKey = addrKey;</td>
</tr>
<tr class="hit">
    <td class="line">81</td>
    <td class="hits">39</td>
    <td class="source"> packetQueue.push(_packet);</td>
</tr>
<tr class="hit">
    <td class="line">82</td>
    <td class="hits">39</td>
    <td class="source"> client.connect(addr.port, addr.host, function () {</td>
</tr>
<tr class="hit">
    <td class="line">83</td>
    <td class="hits">9</td>
    <td class="source"> sending = false;</td>
</tr>
<tr class="hit">
    <td class="line">84</td>
    <td class="hits">9</td>
    <td class="source"> clearTimeout(timeCounter);</td>
</tr>
<tr class="hit">
    <td class="line">85</td>
    <td class="hits">9</td>
    <td class="source"> connectionPool.push({key: addrKey, client: client});</td>
</tr>
<tr class="hit">
    <td class="line">86</td>
    <td class="hits">9</td>
    <td class="source"> return getDataReal();</td>
</tr>
<tr>
    <td class="line">87</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr class="hit">
    <td class="line">88</td>
    <td class="hits">39</td>
    <td class="source"> client.on('timeout', function () {</td>
</tr>
<tr class="hit">
    <td class="line">89</td>
    <td class="hits">4</td>
    <td class="source"> sending = false;</td>
</tr>
<tr class="hit">
    <td class="line">90</td>
    <td class="hits">4</td>
    <td class="source"> clearTimeout(timeCounter);</td>
</tr>
<tr class="hit">
    <td class="line">91</td>
    <td class="hits">4</td>
    <td class="source"> if (!callbackTimeout._hadcalled) {</td>
</tr>
<tr class="hit">
    <td class="line">92</td>
    <td class="hits">2</td>
    <td class="source"> callbackTimeout._hadcalled = true;</td>
</tr>
<tr class="hit">
    <td class="line">93</td>
    <td class="hits">2</td>
    <td class="source"> callbackTimeout(new Error('Tair: Server ' + addr.host + addr.port + '
        Timeout'));
    </td>
</tr>
<tr>
    <td class="line">94</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">95</td>
    <td class="hits">4</td>
    <td class="source"> return getDataReal();</td>
</tr>
<tr>
    <td class="line">96</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr class="hit">
    <td class="line">97</td>
    <td class="hits">39</td>
    <td class="source"> client.on('error', function (err) {</td>
</tr>
<tr class="hit">
    <td class="line">98</td>
    <td class="hits">22</td>
    <td class="source"> clearTimeout(timeCounter);</td>
</tr>
<tr class="hit">
    <td class="line">99</td>
    <td class="hits">22</td>
    <td class="source"> deleteClient(client.addrKey);</td>
</tr>
<tr class="hit">
    <td class="line">100</td>
    <td class="hits">22</td>
    <td class="source"> if (!callbackTimeout._hadcalled) {</td>
</tr>
<tr class="hit">
    <td class="line">101</td>
    <td class="hits">4</td>
    <td class="source"> callbackTimeout._hadcalled = true;</td>
</tr>
<tr class="hit">
    <td class="line">102</td>
    <td class="hits">4</td>
    <td class="source"> callbackTimeout(err || new Error('Tair: Server ' + addr.host + addr.port + '
        Error.'));
    </td>
</tr>
<tr>
    <td class="line">103</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">104</td>
    <td class="hits">22</td>
    <td class="source"> sending = false;</td>
</tr>
<tr class="hit">
    <td class="line">105</td>
    <td class="hits">22</td>
    <td class="source"> return getDataReal();</td>
</tr>
<tr>
    <td class="line">106</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr class="hit">
    <td class="line">107</td>
    <td class="hits">39</td>
    <td class="source"> client.on('data', function (data) {</td>
</tr>
<tr>
    <td class="line">108</td>
    <td class="hits"></td>
    <td class="source"> //read header from packet</td>
</tr>
<tr class="hit">
    <td class="line">109</td>
    <td class="hits">145</td>
    <td class="source"> if (_pos === 0 &amp;&amp; data.length &gt;= 16) {</td>
</tr>
<tr class="hit">
    <td class="line">110</td>
    <td class="hits">28</td>
    <td class="source"> if (data.readInt32BE(0) !== consts.TAIR_PACKET_FLAG) {</td>
</tr>
<tr class="hit">
    <td class="line">111</td>
    <td class="hits">1</td>
    <td class="source"> deleteClient(client.addrKey);</td>
</tr>
<tr class="hit">
    <td class="line">112</td>
    <td class="hits">1</td>
    <td class="source"> if (!callbackTimeout._hadcalled) {</td>
</tr>
<tr class="miss">
    <td class="line">113</td>
    <td class="hits">0</td>
    <td class="source"> callbackTimeout._hadcalled = true;</td>
</tr>
<tr class="miss">
    <td class="line">114</td>
    <td class="hits">0</td>
    <td class="source"> callbackTimeout(new Error('Tair: Server ' + addr.host + addr.port + ' Reply
        Error'));
    </td>
</tr>
<tr>
    <td class="line">115</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">116</td>
    <td class="hits">1</td>
    <td class="source"> clearTimeout(timeCounter);</td>
</tr>
<tr class="hit">
    <td class="line">117</td>
    <td class="hits">1</td>
    <td class="source"> sending = false;</td>
</tr>
<tr class="hit">
    <td class="line">118</td>
    <td class="hits">1</td>
    <td class="source"> getDataReal();</td>
</tr>
<tr class="hit">
    <td class="line">119</td>
    <td class="hits">1</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">120</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">121</td>
    <td class="hits">27</td>
    <td class="source"> len = data.readInt32BE(12) + 16;</td>
</tr>
<tr class="hit">
    <td class="line">122</td>
    <td class="hits">27</td>
    <td class="source"> if (len &gt;= buffer_start_size) {</td>
</tr>
<tr class="hit">
    <td class="line">123</td>
    <td class="hits">1</td>
    <td class="source"> chunk = exploitBuffer(chunk, len);</td>
</tr>
<tr>
    <td class="line">124</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">125</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">126</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">127</td>
    <td class="hits">144</td>
    <td class="source"> data.copy(chunk, _pos);</td>
</tr>
<tr class="hit">
    <td class="line">128</td>
    <td class="hits">144</td>
    <td class="source"> _pos += data.length;</td>
</tr>
<tr class="hit">
    <td class="line">129</td>
    <td class="hits">144</td>
    <td class="source"> if (_pos &gt;= len) {</td>
</tr>
<tr class="hit">
    <td class="line">130</td>
    <td class="hits">27</td>
    <td class="source"> sending = false;</td>
</tr>
<tr class="hit">
    <td class="line">131</td>
    <td class="hits">27</td>
    <td class="source"> var packetID = chunk.readInt32BE(4);</td>
</tr>
<tr class="hit">
    <td class="line">132</td>
    <td class="hits">27</td>
    <td class="source"> var callback = callbacks[packetID];</td>
</tr>
<tr class="hit">
    <td class="line">133</td>
    <td class="hits">27</td>
    <td class="source"> if (callback) {</td>
</tr>
<tr class="hit">
    <td class="line">134</td>
    <td class="hits">27</td>
    <td class="source"> packetID = chunk.readInt32BE(4);</td>
</tr>
<tr class="hit">
    <td class="line">135</td>
    <td class="hits">27</td>
    <td class="source"> callback(null, chunk, len);</td>
</tr>
<tr class="hit">
    <td class="line">136</td>
    <td class="hits">27</td>
    <td class="source"> clearTimeout(timeCounter);</td>
</tr>
<tr class="hit">
    <td class="line">137</td>
    <td class="hits">27</td>
    <td class="source"> callbacks[packetID]._hadcalled = true;</td>
</tr>
<tr class="hit">
    <td class="line">138</td>
    <td class="hits">27</td>
    <td class="source"> delete callbacks[packetID];</td>
</tr>
<tr>
    <td class="line">139</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">140</td>
    <td class="hits">27</td>
    <td class="source"> return getDataReal();</td>
</tr>
<tr>
    <td class="line">141</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">142</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr class="hit">
    <td class="line">143</td>
    <td class="hits">39</td>
    <td class="source"> client.on('end', function () {</td>
</tr>
<tr class="hit">
    <td class="line">144</td>
    <td class="hits">1</td>
    <td class="source"> sending = false;</td>
</tr>
<tr class="hit">
    <td class="line">145</td>
    <td class="hits">1</td>
    <td class="source"> clearTimeout(timeCounter);</td>
</tr>
<tr class="hit">
    <td class="line">146</td>
    <td class="hits">1</td>
    <td class="source"> var packetID = chunk.readInt32BE(4);</td>
</tr>
<tr class="hit">
    <td class="line">147</td>
    <td class="hits">1</td>
    <td class="source"> var callback = callbacks[packetID];</td>
</tr>
<tr class="hit">
    <td class="line">148</td>
    <td class="hits">1</td>
    <td class="source"> deleteClient(client.addrKey);</td>
</tr>
<tr class="hit">
    <td class="line">149</td>
    <td class="hits">1</td>
    <td class="source"> if (callback) {</td>
</tr>
<tr class="miss">
    <td class="line">150</td>
    <td class="hits">0</td>
    <td class="source"> callback(null, chunk, len);</td>
</tr>
<tr class="miss">
    <td class="line">151</td>
    <td class="hits">0</td>
    <td class="source"> callbacks[packetID]._hadcalled = true;</td>
</tr>
<tr class="miss">
    <td class="line">152</td>
    <td class="hits">0</td>
    <td class="source"> delete callbacks[packetID];</td>
</tr>
<tr>
    <td class="line">153</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">154</td>
    <td class="hits">1</td>
    <td class="source"> return getDataReal();</td>
</tr>
<tr>
    <td class="line">155</td>
    <td class="hits"></td>
    <td class="source"> });</td>
</tr>
<tr class="hit">
    <td class="line">156</td>
    <td class="hits">39</td>
    <td class="source"> return;</td>
</tr>
<tr>
    <td class="line">157</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">158</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">159</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">160</td>
    <td class="hits"></td>
    <td class="source">//</td>
</tr>
<tr>
    <td class="line">161</td>
    <td class="hits"></td>
    <td class="source">//function printBuffer (buf) {</td>
</tr>
<tr>
    <td class="line">162</td>
    <td class="hits"></td>
    <td class="source">// for (var i = 0; i &lt; buf.length; i++) {</td>
</tr>
<tr>
    <td class="line">163</td>
    <td class="hits"></td>
    <td class="source">// if (i % 8 === 0) process.stdout.write(' ');</td>
</tr>
<tr>
    <td class="line">164</td>
    <td class="hits"></td>
    <td class="source">// if (i % 24 === 0) process.stdout.write('\n');</td>
</tr>
<tr>
    <td class="line">165</td>
    <td class="hits"></td>
    <td class="source">// process.stdout.write((buf[i] &lt; 16 ? '0' : '') + buf[i].toString(16) + '
        ');
    </td>
</tr>
<tr>
    <td class="line">166</td>
    <td class="hits"></td>
    <td class="source">// }</td>
</tr>
<tr>
    <td class="line">167</td>
    <td class="hits"></td>
    <td class="source">// process.stdout.write('\n');</td>
</tr>
<tr>
    <td class="line">168</td>
    <td class="hits"></td>
    <td class="source">//</td>
</tr>
<tr>
    <td class="line">169</td>
    <td class="hits"></td>
    <td class="source">//}</td>
</tr>
<tr>
    <td class="line">170</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">171</td>
    <td class="hits">1</td>
    <td class="source">function exploitBuffer (orign, len) {</td>
</tr>
<tr class="hit">
    <td class="line">172</td>
    <td class="hits">1</td>
    <td class="source"> var buf = new Buffer(len);</td>
</tr>
<tr class="hit">
    <td class="line">173</td>
    <td class="hits">1</td>
    <td class="source"> orign.copy(buf);</td>
</tr>
<tr class="hit">
    <td class="line">174</td>
    <td class="hits">1</td>
    <td class="source"> return buf;</td>
</tr>
<tr>
    <td class="line">175</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">176</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">177</td>
    <td class="hits">1</td>
    <td class="source">function findClient (addrKey) {</td>
</tr>
<tr class="hit">
    <td class="line">178</td>
    <td class="hits">67</td>
    <td class="source"> for (var i = 0, l = connectionPool.length; i &lt; l; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">179</td>
    <td class="hits">273</td>
    <td class="source"> var _item = connectionPool[i];</td>
</tr>
<tr class="hit">
    <td class="line">180</td>
    <td class="hits">273</td>
    <td class="source"> if (_item &amp;&amp; addrKey === _item.key) {</td>
</tr>
<tr class="hit">
    <td class="line">181</td>
    <td class="hits">28</td>
    <td class="source"> return _item.client;</td>
</tr>
<tr>
    <td class="line">182</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">183</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">184</td>
    <td class="hits">39</td>
    <td class="source"> return null;</td>
</tr>
<tr>
    <td class="line">185</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">186</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr class="hit">
    <td class="line">187</td>
    <td class="hits">1</td>
    <td class="source">function deleteClient (addrKey) {</td>
</tr>
<tr class="hit">
    <td class="line">188</td>
    <td class="hits">26</td>
    <td class="source"> for (var i = 0, l = connectionPool.length; i &lt; l; i++) {</td>
</tr>
<tr class="hit">
    <td class="line">189</td>
    <td class="hits">107</td>
    <td class="source"> var _item = connectionPool[i];</td>
</tr>
<tr class="hit">
    <td class="line">190</td>
    <td class="hits">107</td>
    <td class="source"> if (_item &amp;&amp; addrKey === _item.key) {</td>
</tr>
<tr class="hit">
    <td class="line">191</td>
    <td class="hits">1</td>
    <td class="source"> delete connectionPool[i];</td>
</tr>
<tr class="hit">
    <td class="line">192</td>
    <td class="hits">1</td>
    <td class="source"> connectionPool[i] = null;</td>
</tr>
<tr class="hit">
    <td class="line">193</td>
    <td class="hits">1</td>
    <td class="source"> return true;</td>
</tr>
<tr>
    <td class="line">194</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr>
    <td class="line">195</td>
    <td class="hits"></td>
    <td class="source"> }</td>
</tr>
<tr class="hit">
    <td class="line">196</td>
    <td class="hits">25</td>
    <td class="source"> return false;</td>
</tr>
<tr>
    <td class="line">197</td>
    <td class="hits"></td>
    <td class="source">}</td>
</tr>
<tr>
    <td class="line">198</td>
    <td class="hits"></td>
    <td class="source"></td>
</tr>
<tr>
    <td class="line">199</td>
    <td class="hits"></td>
    <td class="source">//exports.printBuffer = printBuffer;</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>